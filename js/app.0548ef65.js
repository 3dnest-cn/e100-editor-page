(function(t){function e(e){for(var o,a,s=e[0],l=e[1],c=e[2],u=0,d=[];u<s.length;u++)a=s[u],Object.prototype.hasOwnProperty.call(n,a)&&n[a]&&d.push(n[a][0]),n[a]=0;for(o in l)Object.prototype.hasOwnProperty.call(l,o)&&(t[o]=l[o]);p&&p(e);while(d.length)d.shift()();return r.push.apply(r,c||[]),i()}function i(){for(var t,e=0;e<r.length;e++){for(var i=r[e],o=!0,s=1;s<i.length;s++){var l=i[s];0!==n[l]&&(o=!1)}o&&(r.splice(e--,1),t=a(a.s=i[0]))}return t}var o={},n={app:0},r=[];function a(e){if(o[e])return o[e].exports;var i=o[e]={i:e,l:!1,exports:{}};return t[e].call(i.exports,i,i.exports,a),i.l=!0,i.exports}a.m=t,a.c=o,a.d=function(t,e,i){a.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},a.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(t,e){if(1&e&&(t=a(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(a.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)a.d(i,o,function(e){return t[e]}.bind(null,o));return i},a.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],l=s.push.bind(s);s.push=e,s=s.slice();for(var c=0;c<s.length;c++)e(s[c]);var p=l;r.push([0,"chunk-vendors"]),i()})({0:function(t,e,i){t.exports=i("56d7")},"0085":function(t,e,i){"use strict";i("12fd")},"0db8":function(t){t.exports=JSON.parse('{"floorList":[{"compass":{"rotation":0},"cornerList":[],"wallList":[],"roomList":[],"hollowList":[],"stuffList":[],"labelTextList":[],"labelLineList":[]},{"compass":{"rotation":0},"cornerList":[],"wallList":[],"roomList":[],"hollowList":[],"stuffList":[],"labelTextList":[],"labelLineList":[]},{"compass":{"rotation":0},"cornerList":[],"wallList":[],"roomList":[],"hollowList":[],"stuffList":[],"labelTextList":[],"labelLineList":[]}],"extensionList":[{"bitmap":{"id":"negative2","position":[0,0],"rotation":0},"floorName":"","isFirst":false},{"bitmap":{"id":"negative1","position":[0,0],"rotation":0},"floorName":"","isFirst":true},{"bitmap":{"id":"negative3","position":[0,0],"rotation":0},"floorName":""}]}')},1227:function(t,e,i){},"12fd":function(t,e,i){},"14ac":function(t,e,i){"use strict";i("9018")},"2b1a":function(t,e,i){},"389a":function(t,e,i){},"3a74":function(t,e,i){},"40e4":function(t,e,i){"use strict";i("8899")},"4c00":function(t,e,i){"use strict";i("88d6")},5051:function(t,e,i){},"507d":function(t,e,i){"use strict";i("3a74")},"56d7":function(t,e,i){"use strict";i.r(e);var o={};i.r(o),i.d(o,"SingleDoor",(function(){return li})),i.d(o,"DoubleDoor",(function(){return ci})),i.d(o,"SlidingDoor",(function(){return pi})),i.d(o,"ParentDoor",(function(){return ui})),i.d(o,"Bealock",(function(){return di}));var n={};i.r(n),i.d(n,"BasicWindow",(function(){return hi})),i.d(n,"BoilerWindow",(function(){return mi})),i.d(n,"FloorWindow",(function(){return fi})),i.d(n,"LWindow",(function(){return gi})),i.d(n,"UWindow",(function(){return vi})),i.d(n,"LBoilerWindow",(function(){return bi})),i.d(n,"UBoilerWindow",(function(){return yi}));i("e260"),i("e6cf"),i("cca6"),i("a79d"),i("d3b7"),i("3ca3"),i("ddb0"),i("2b3d"),i("9861"),i("99af"),i("1227");var r,a=i("2b0e"),s=i("c6c5"),l=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"d-flex flex-column position-relative w-100 h-100",attrs:{id:"app"}},[i("div",[i("app-menu")],1),i("div",{staticClass:"d-flex flex-fill w-100"},[i("div",[i("app-tool-bar")],1),i("div",{staticClass:"h-100 w-100 overflow-hidden position-relative"},[i("div",{ref:"drawing",staticClass:"w-100 h-100",staticStyle:{"line-height":"0"},on:{dblclick:t.useTransformerFromSelector}}),i("app-tool-setting"),i("app-property-card")],1),i("div",[i("app-property")],1)]),i("div",{staticClass:"position-absolute",staticStyle:{right:"310px",bottom:"40px"}},[i("app-viewport")],1),i("div",{staticClass:"position-absolute",staticStyle:{left:"340px",bottom:"40px"}},[i("app-visible")],1)])},c=[],p=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"d-flex justify-content-between align-items-center border-bottom",staticStyle:{height:"76px"},attrs:{id:"menu"}},[i("div",{staticClass:"d-flex align-items-center px-3 font-weight-bold",staticStyle:{height:"50px","line-height":"50px"}},[i("b-img",{staticClass:"mr-3",staticStyle:{width:"30px"},attrs:{src:"img/House.svg"}}),i("span",[t._v("模型名称")])],1),i("div",{staticClass:"d-flex align-items-center"},t._l(t.toolListGroup,(function(e,o){return i("div",{key:o,staticClass:"d-flex align-items-center"},[t._l(e,(function(e,o){return i("b-button",{directives:[{name:"show",rawName:"v-show",value:!e.show||!e.show(),expression:"tool.show ? !tool.show() : true"}],key:o,staticClass:"menu-btn",class:{"btn-active":e.id===t.activeTool},attrs:{disabled:!!e.disabled&&e.disabled(),variant:"outline-secondary"},on:{click:e.method}},[i("b-img",{staticStyle:{width:"30px"},attrs:{src:e.id===t.activeTool&&e.active?e.active:e.src}}),i("span",{staticClass:"mt-1"},[t._v(t._s(e.title))])],1)})),o<t.toolListGroup.length-1?i("div",{staticClass:"border-left",staticStyle:{height:"50px"}}):t._e()],2)})),0),i("div",[i("b-button",{staticClass:"menu-btn",attrs:{variant:"outline-secondary"},on:{click:t.showExitModal}},[i("b-img",{staticStyle:{width:"30px"},attrs:{src:"img/Quit.svg"}}),i("span",{staticClass:"mt-1"},[t._v("退出")])],1)],1),i("b-modal",{attrs:{id:"clear-modal",title:"一键清空","hide-footer":"",size:"sm"}},[i("div",{staticClass:"d-block text-center mt-3 mb-4"},[t._v("您确定要清空当前楼层的户型图")]),i("div",{staticClass:"d-flex justify-content-center align-items-center"},[i("b-button",{staticClass:"mt-0 mr-3",attrs:{block:""},on:{click:function(e){return t.$bvModal.hide("clear-modal")}}},[t._v("取消")]),i("b-button",{staticClass:"mt-0",attrs:{block:"",variant:"danger"},on:{click:t.clear}},[t._v("确定")])],1)]),i("b-modal",{attrs:{id:"exit-modal",title:"一键清空","hide-footer":"",size:"sm"}},[i("div",{staticClass:"d-block text-center mt-3 mb-4"},[t._v("您确定要清空当前楼层的户型图")]),i("div",{staticClass:"d-flex justify-content-center align-items-center"},[i("b-button",{staticClass:"mt-0 mr-3",attrs:{block:""},on:{click:function(e){return t.$bvModal.hide("exit-modal")}}},[t._v("取消")]),i("b-button",{staticClass:"mt-0",attrs:{block:"",variant:"danger"},on:{click:t.exit}},[t._v("确定")])],1)])],1)},u=[],d=6e5,h={data:function(){return{activeTool:"selector",toolListGroup:[[{id:"selector",title:"选择",src:"img/Pointer.svg",active:"img/Pointer_Active.svg",method:this.select},{id:"transformer",title:"移动",src:"img/Move.svg",active:"img/Move_Active.svg",method:this.move}],[{title:"保存",src:"img/Save.svg",method:this.save},{title:"清空",src:"img/Clear.svg",method:this.showClearModal},{title:"锁定",src:"img/Lock.svg",method:this.lock,show:this.getLockShow},{title:"解锁",src:"img/Lock.svg",method:this.unlock,show:this.getUnlockShow,disabled:this.getLockDisabled}]],locked:!1,hasWall:!1}},mounted:function(){var t=this;this.init(),setInterval((function(){t.$bvToast.toast("自动保存成功...",{autoHideDelay:2e3,noHoverPause:!0,toastClass:"custom-toast",variant:"default"})}),d)},destroyed:function(){var t=this.$spoke.getEditor("primary");t.tool.off("open",this._openListener),this.$root.$off("floorChange",this._floorChangeListener),t.drawing.structure.off("wall-created",this._wallCreatedListener),t.drawing.off("element-destroy",this._wallDestroyListener)},methods:{init:function(){var t=this,e=this.$spoke.getEditor("primary"),i=e.drawing,o=this.$spoke.getSolution(),n=o.Element;this.$root.$on("floorChange",this._floorChangeListener=function(e){t.locked=e.locked}),e.tool.on("open",this._openListener=function(e){t.activeTool!==e&&(t.activeTool=e)}),i.structure.on("wall-created",this._wallCreatedListener=function(){t.hasWall=!0,t.locked||t.lock(!0)}),i.on("element-destroy",this._wallDestroyListener=function(e){e instanceof n.Wall&&0===i.structure.getAllWallList().length&&(t.hasWall=!1,t.unlock())})},getLockShow:function(){return this.locked},getUnlockShow:function(){return!this.locked},getLockDisabled:function(){return this.hasWall},select:function(){var t=this.$spoke.getEditor("primary");t.tool.openSelector()},move:function(){var t=this.$spoke.getEditor("primary");t.tool.openTransformer()},save:function(){var t=this;this.$spoke.save("primary").then((function(){t.$bvToast.toast("保存成功",{autoHideDelay:2e3,noHoverPause:!0,toastClass:"custom-toast",variant:"default"})}))},retreat:function(){console.log("retreat")},advance:function(){console.log("advance")},showClearModal:function(){this.$bvModal.show("clear-modal")},clear:function(){this.$spoke.clearDrawing("primary"),this.$bvModal.hide("clear-modal"),this.locked&&this.unlock()},lock:function(t){var e=t?"底图已锁定，清空当前层户型图后可解锁":"底图已锁定";this.locked=!0,this.$bvToast.toast(e,{autoHideDelay:2e3,noHoverPause:!0,toastClass:"custom-toast",variant:"default"}),this.$root.$emit("lock")},unlock:function(){this.locked=!1,this.$root.$emit("unlock")},showExitModal:function(){this.$bvModal.show("exit-modal")},exit:function(){this.save(),this.$bvModal.hide("exit-modal"),console.log("exit")}}},m=h,f=(i("bb78"),i("0c7c")),g=Object(f["a"])(m,p,u,!1,null,null,null),v=g.exports,b=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"h-100 border-right d-flex",attrs:{id:"tool-bar-container"}},[i("b-button-toolbar",{staticClass:"flex-column border-right",staticStyle:{width:"68px","font-size":"12px"},attrs:{id:"app-toolgroup"}},t._l(t.toolList,(function(e,o){return i("b-button-group",{key:o,staticClass:"p-1"},[i("b-button",{staticClass:"d-flex flex-column align-items-center p-1 border-0",class:{"btn-active":e.id===t.active},attrs:{variant:"outline-secondary"},on:{click:function(i){return t.changeTool(e.id)}}},[i("b-img",{staticStyle:{width:"30px"},attrs:{src:e.id===t.active?e.active:e.img}}),i("span",{staticClass:"app-text-tiny mt-1"},[t._v(t._s(e.title))])],1)],1)})),1),i("div",{staticClass:"tool-bar-content"},[i("span",{staticClass:"content-button",on:{click:t.toggleConetnt}},[i("b-icon",{attrs:{icon:t.contentVisible?"chevron-left":"chevron-right"}})],1),i(t.activeTool,{tag:"component",staticClass:"content-component",class:{hidden:!t.contentVisible}})],1)],1)},y=[],w=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"d-flex flex-column",attrs:{id:"tool"}},[t._l(t.toolGroup,(function(e,o){return i("div",{key:e.title+o,staticClass:"px-2"},[i("div",{staticClass:"border-bottom px-2",staticStyle:{height:"30px","line-height":"30px"}},[t._v(t._s(e.title))]),i("div",{staticClass:"d-flex flex-wrap pt-2"},t._l(e.toolList,(function(e,o){return i("div",{key:e+o,staticClass:"tool-item",class:{"no-margin-right":(o+1)%3===0,"btn-active":t.toolGroupMap[e].id===t.activeToolGroup},on:{click:function(i){return t.activeTool(e)}}},[i("span",{staticStyle:{width:"40px",height:"40px","line-height":"40px"}},[i("b-img",{staticClass:"w-100 h-100",attrs:{src:t.toolGroupMap[e].id===t.activeToolGroup&&t.toolGroupMap[e].active?t.toolGroupMap[e].active:t.toolGroupMap[e].img}})],1),i("span",{staticClass:"mt-2 app-text-tiny text-center"},[t._v(t._s(t.toolGroupMap[e].title))])])})),0)])})),t._l(t.windoorGroup,(function(e,o){return i("div",{key:e.title+o,staticClass:"px-2"},[i("div",{staticClass:"border-bottom px-2",staticStyle:{height:"30px","line-height":"30px"}},[t._v(t._s(e.title))]),i("div",{staticClass:"d-flex flex-wrap pt-3"},t._l(e.toolList,(function(e,o){return i("div",{key:e+o,staticClass:"tool-item",class:{"no-margin-right":(o+1)%3===0},on:{click:function(i){return t.activeWindoor(e)}}},[i("span",{staticStyle:{width:"40px",height:"40px","line-height":"40px"}},[i("b-img",{staticClass:"w-100 h-100",attrs:{src:t.windoorMap[e].img}})],1),i("span",{staticClass:"mt-1 app-text-tiny text-center"},[t._v(t._s(t.windoorMap[e].title))])])})),0)])}))],2)},k=[],x=i("2fe6"),T="selector",S="transformer",L="builder",C="chamber",_="spliter",$="labeler",F="viewport",O=(r={},Object(x["a"])(r,T,{id:T,title:"选择器",icon:"cursor",click:function(t){t.tool.openSelector()}}),Object(x["a"])(r,S,{id:S,title:"变形器",icon:"arrows-move",click:function(t){t.tool.openTransformer()}}),Object(x["a"])(r,L,{id:L,title:"画墙",img:"img/Wall.svg",active:"img/Wall_Active.svg",click:function(t){t.tool.openWallBuilder()}}),Object(x["a"])(r,C,{id:C,title:"画房间",img:"img/Room.svg",active:"img/Room_Active.svg",click:function(t){t.tool.openChamber()}}),Object(x["a"])(r,_,{id:_,title:"截断器",icon:"input-cursor",click:function(t){t.tool.openSpliter()}}),Object(x["a"])(r,$,{id:$,title:"标注",icon:"tags",click:function(t){t.tool.openLabeler()}}),Object(x["a"])(r,F,{id:F,title:"视口",icon:"search",click:function(t){t.tool.openViewport()}}),r),D={singleDoor:{id:"singleDoor",title:"单开门",img:"img/SingleDoor.svg"},doubleDoor:{id:"doubleDoor",title:"双开门",img:"img/DoubleDoor.svg"},slidingDoor:{id:"slidingDoor",title:"推拉门",img:"img/SlidingDoor.svg"},basicWindow:{id:"basicWindow",title:"普通窗",img:"img/BasicWindow.svg"},boilerWindow:{id:"boilerWindow",title:"一字飘窗",img:"img/BoilerWindow.svg"},bealock:{id:"bealock",title:"垭口",img:"img/Bealock.svg"}},E=[{title:"画墙",toolList:[L,C]}],R=[{title:"门窗",toolList:["singleDoor","doubleDoor","slidingDoor","basicWindow","boilerWindow"]},{title:"其他构件",toolList:["bealock"]}],N={name:"Tool",data:function(){return{activeToolGroup:null,toolGroup:E,windoorGroup:R,toolGroupMap:O,windoorMap:D}},mounted:function(){var t=this,e=this.$spoke.getEditor("primary");this.activeTool(T),e.tool.on("open",this._toolOpenListener=function(e){t.activeToolGroup!==e&&(t.activeToolGroup=e,t.$root.$emit("toolGroupChange",e))})},destroyed:function(){var t=this.$spoke.getEditor("primary");t.tool.off("open",this._toolOpenListener)},methods:{activeTool:function(t){O[t].click(this.$spoke.getEditor("primary")),this.activeToolGroup=t,this.$root.$emit("toolGroupChange",t)},activeWindoor:function(t){var e=this.$spoke.getEditor("primary"),i=e.drawing,o=e.tool;o.openDefault(),i.windoor.createMovingHollow(t)}}},W=N,P=(i("6db6"),Object(f["a"])(W,w,k,!1,null,null,null)),j=P.exports,A=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"tool-bar-material"}},[i("b-tabs",{staticClass:"p-2",attrs:{pills:"","no-fade":"","nav-class":"material-tab-nav"}},t._l(t.materialGroup,(function(e,o){return i("b-tab",{key:o,attrs:{title:e.title,active:e.active}},t._l(e.dataList,(function(e,o){return i("div",{key:o},[i("div",{staticClass:"border-bottom px-2",staticStyle:{height:"30px","line-height":"30px"}},[t._v(t._s(e.title))]),i("div",{staticClass:"d-flex flex-wrap pt-3"},t._l(e.materialList,(function(e,o){return i("div",{key:o,staticClass:"d-flex flex-column align-items-center mb-2",staticStyle:{width:"50px"},on:{click:function(i){return t.create(t.materialMap[e].id)}}},[i("span",{staticStyle:{width:"40px",height:"40px",cursor:"pointer"}},[i("b-img",{staticClass:"h-100 w-100",attrs:{src:t.materialMap[e].img}})],1),i("span",{staticClass:"mt-1 app-text-tiny text-center"},[t._v(t._s(t.materialMap[e].title))])])})),0)])})),0)})),1)],1)},B=[],M={0:{id:0,title:"单人床",img:"img/SingleDoor.png"},1:{id:1,title:"双人床",img:"img/SingleDoor.png"},2:{id:2,title:"组合床",img:"img/SingleDoor.png"},3:{id:3,title:"榻榻米",img:"img/SingleDoor.png"},4:{id:4,title:"单人沙发",img:"img/SingleDoor.png"},5:{id:5,title:"双人沙发",img:"img/SingleDoor.png"},6:{id:6,title:"多人沙发",img:"img/SingleDoor.png"},7:{id:7,title:"组合沙发",img:"img/SingleDoor.png"},8:{id:8,title:"转角沙发",img:"img/SingleDoor.png"},9:{id:9,title:"弧形沙发",img:"img/SingleDoor.png"},10:{id:10,title:"圆形餐桌",img:"img/SingleDoor.png"},11:{id:11,title:"方形餐桌",img:"img/SingleDoor.png"},12:{id:12,title:"长条形餐桌",img:"img/SingleDoor.png"},13:{id:13,title:"书桌",img:"img/SingleDoor.png"},14:{id:14,title:"梳妆台",img:"img/SingleDoor.png"},15:{id:15,title:"一字型橱柜",img:"img/SingleDoor.png"},16:{id:16,title:"L形橱柜",img:"img/SingleDoor.png"},17:{id:17,title:"U形橱柜",img:"img/SingleDoor.png"},18:{id:18,title:"浴缸",img:"img/SingleDoor.png"},19:{id:19,title:"淋浴房",img:"img/SingleDoor.png"},20:{id:20,title:"洗手台",img:"img/SingleDoor.png"},21:{id:21,title:"马桶",img:"img/SingleDoor.png"},22:{id:22,title:"洗衣机",img:"img/SingleDoor.png"},23:{id:23,title:"绿植",img:"img/SingleDoor.png"},24:{id:24,title:"地毯",img:"img/SingleDoor.png"},25:{id:25,title:"长方形楼梯",img:"img/SingleDoor.png"},26:{id:26,title:"L形楼梯",img:"img/SingleDoor.png"},27:{id:27,title:"U形楼梯",img:"img/SingleDoor.png"},28:{id:28,title:"圆形楼梯",img:"img/SingleDoor.png"},29:{id:29,title:"地板",img:"img/SingleDoor.png"},30:{id:30,title:"瓷砖",img:"img/SingleDoor.png"},31:{id:31,title:"地毯",img:"img/SingleDoor.png"}},z=[{title:"家具",dataList:[{title:"床",materialList:[0,1,2,3]},{title:"沙发",materialList:[4,5,6,7,8,9]},{title:"桌几",materialList:[10,11,12,13,14]}]},{title:"厨卫",dataList:[{title:"厨房",materialList:[15,16,17]},{title:"卫浴",materialList:[18,19,20,21,22]}]},{title:"家饰",dataList:[{title:"家饰",materialList:[23,24]}]},{title:"建筑",dataList:[{title:"楼梯",materialList:[25,26,27,28]},{title:"地板设计",materialList:[29,30,31]}]}],I={name:"Material",data:function(){return{materialMap:M,materialGroup:z}},mounted:function(){console.log("material")},methods:{create:function(t){console.log(t)}}},G=I,V=(i("9342"),Object(f["a"])(G,A,B,!1,null,null,null)),U=V.exports,K={tool:j,material:U},H={name:"ToolBarContainer",data:function(){return{toolList:[{id:"tool",title:"绘制工具",img:"img/DrawTool.svg",active:"img/DrawTool_Active.svg"}],active:"tool",activeTool:j,contentVisible:!0}},methods:{changeTool:function(t){this.active=t,this.activeTool=K[t],this.contentVisible||this.toggleConetnt()},toggleConetnt:function(){this.contentVisible=!this.contentVisible,this.$root.$emit("drawing-resize")}}},J=H,q=(i("0085"),Object(f["a"])(J,b,y,!1,null,null,null)),Q=q.exports,X=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"position-absolute d-flex justify-content-center w-100",staticStyle:{top:"0",height:"0"}},[i(t.current,{tag:"component",staticClass:"border mt-1 position-absolute",staticStyle:{"background-color":"#FFF"}})],1)},Y=[],Z=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"d-flex",attrs:{id:"builder-setting"}},[i("b-form-radio-group",{staticClass:"d-flex align-items-center pr-1 pl-3",attrs:{options:t.alignOptions},on:{change:t.setWallAlignment},model:{value:t.align,callback:function(e){t.align=e},expression:"align"}}),i("div",{staticClass:"position-relative"},[i("b-form-group",{staticClass:"my-1 px-2 border-left border-right",staticStyle:{width:"12em"},attrs:{"label-cols-sm":"3","content-cols-sm":"9",label:"墙厚","label-for":"wall-thinkness"}},[i("b-input-group",{attrs:{append:"mm"}},[i("b-form-input",{attrs:{id:"wall-thinkness",type:"number",autocomplete:"off"},on:{change:t.setWallThinkness,focus:function(){return t.thinknessDropdownShow=!0},blur:function(){return t.thinknessDropdownShow=!1}},model:{value:t.thinkness,callback:function(e){t.thinkness=t._n(e)},expression:"thinkness"}})],1)],1),i("b-list-group",{directives:[{name:"show",rawName:"v-show",value:t.thinknessDropdownShow,expression:"thinknessDropdownShow"}],staticClass:"input-dropdown"},t._l(t.thinknessList,(function(e,o){return i("b-list-group-item",{key:o,attrs:{button:""},on:{mousedown:function(i){return t.setWallThinkness(e)}}},[t._v(t._s(e))])})),1)],1),i("b-form-checkbox",{staticClass:"d-flex align-items-center mx-3",on:{change:t.setSnapState},model:{value:t.snapState,callback:function(e){t.snapState=e},expression:"snapState"}},[t._v("吸附")])],1)},tt=[],et=(i("a9e3"),10),it=1e3,ot={name:"BuilderSetting",data:function(){return{thinkness:240,thinknessList:[100,120,180,200,240],thinknessDropdownShow:!1,align:"center",alignOptions:[{value:"center",text:"墙中线绘制"},{value:"right",text:"墙内线绘制"}],snapState:!0}},mounted:function(){this.setWallThinkness(this.thinkness),this.setWallAlignment(this.align),this.snapState=this.$spoke.getState().snap},methods:{test:function(){console.log(123123)},setWallThinkness:function(t){var e=this.$spoke.getEditor("primary"),i=e.drawing,o=Number(t);this.thinkness=o<et?10:o>it?1e3:Number(t),i.bricklayer.Builder.setThickness(this.thinkness)},setWallAlignment:function(t){var e=this.$spoke.getEditor("primary"),i=e.drawing;i.bricklayer.Builder.setAlignment(t)},setSnapState:function(t){this.$spoke.setSnapState("primary",t)}}},nt=ot,rt=(i("7b33"),Object(f["a"])(nt,Z,tt,!1,null,null,null)),at=rt.exports,st=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"d-flex",attrs:{id:"chamber-setting"}},[i("div",[i("b-form-group",{staticClass:"my-1 pr-2 pl-3 border-right",staticStyle:{width:"12em"},attrs:{"label-cols-sm":"3","content-cols-sm":"9",label:"墙厚","label-for":"wall-thinkness"}},[i("b-input-group",{attrs:{append:"mm"}},[i("b-form-input",{attrs:{id:"wall-thinkness",type:"number",autocomplete:"off"},on:{change:t.setWallThinkness,focus:function(){return t.thinknessDropdownShow=!0},blur:function(){return t.thinknessDropdownShow=!1}},model:{value:t.thinkness,callback:function(e){t.thinkness=t._n(e)},expression:"thinkness"}})],1)],1),i("b-list-group",{directives:[{name:"show",rawName:"v-show",value:t.thinknessDropdownShow,expression:"thinknessDropdownShow"}],staticClass:"input-dropdown"},t._l(t.thinknessList,(function(e,o){return i("b-list-group-item",{key:o,attrs:{button:""},on:{mousedown:function(i){return t.setWallThinkness(e)}}},[t._v(t._s(e))])})),1)],1),i("b-form-checkbox",{staticClass:"d-flex align-items-center mx-3",on:{change:t.setSnapState},model:{value:t.snapState,callback:function(e){t.snapState=e},expression:"snapState"}},[t._v("吸附")])],1)},lt=[],ct=10,pt=1e3,ut={name:"ChamberSetting",data:function(){return{thinkness:200,thinknessList:[100,120,180,200,240],thinknessDropdownShow:!1,snapState:!0}},mounted:function(){this.setWallThinkness(this.thinkness),this.snapState=this.$spoke.getState().snap},methods:{setWallThinkness:function(t){var e=this.$spoke.getEditor("primary"),i=e.drawing,o=Number(t);this.thinkness=o<ct?10:o>pt?1e3:Number(t),i.bricklayer.Chamber.setThickness(this.thinkness)},setSnapState:function(t){this.$spoke.setSnapState("primary",t)}}},dt=ut,ht=(i("698f"),Object(f["a"])(dt,st,lt,!1,null,null,null)),mt=ht.exports,ft={builder:at,chamber:mt},gt={name:"ToolSetting",data:function(){return{current:null}},mounted:function(){var t=this;this.$root.$on("toolGroupChange",(function(e){t.current=ft[e]}))}},vt=gt,bt=Object(f["a"])(vt,X,Y,!1,null,null,null),yt=bt.exports,wt=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"border-left",attrs:{id:"property-container"}},[i("span",{staticClass:"property-button",on:{click:t.toggleConetnt}},[i("b-icon",{attrs:{icon:t.contentVisible?"chevron-right":"chevron-left"}})],1),i("div",{staticClass:"property-content",class:{hidden:!t.contentVisible}},[i("floor",{staticClass:"mb-3"}),i(t.activeTool,{tag:"component"})],1)])},kt=[],xt=(i("4ec9"),function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"property-floor"}},[i("div",{staticClass:"border-bottom px-3",staticStyle:{height:"45px","line-height":"45px"}},[t._v("户型属性")]),i("div",{staticClass:"d-flex flex-column app-text-tiny px-3"},[i("div",{staticClass:"property-item"},[i("span",[t._v("底图旋转：")]),i("div",{staticClass:"position-relative"},[i("b-form-input",{staticClass:"spin-input spin-button-hidden",staticStyle:{width:"39px",left:"36px"},attrs:{type:"number",readonly:t.bitmapLocked},on:{change:t.bitmapRotate},model:{value:t.property.bitmapRotation,callback:function(e){t.$set(t.property,"bitmapRotation",e)},expression:"property.bitmapRotation"}}),i("b-form-spinbutton",{staticClass:"mr-2",attrs:{inline:"",wrap:"",min:"0",max:"359",readonly:t.bitmapLocked},on:{change:function(e){return t.rotationUpdate("bitmap",e)}},model:{value:t.spinNumber.bitmapRotation,callback:function(e){t.$set(t.spinNumber,"bitmapRotation",e)},expression:"spinNumber.bitmapRotation"}}),i("b-icon",{staticStyle:{cursor:"pointer"},attrs:{icon:"arrow-repeat","font-scale":"1.5"},on:{click:function(e){return t.bitmapRotate(0)}}})],1)]),i("div",{staticClass:"property-item"},[i("span",[t._v("指北针：")]),i("div",{staticClass:"position-relative"},[i("b-form-input",{staticClass:"position-absolute rounded-0 border-left-0 border-right-0 text-center spin-button-hidden",staticStyle:{width:"39px",left:"36px"},attrs:{type:"number"},on:{change:t.compassRotate},model:{value:t.property.compassRotation,callback:function(e){t.$set(t.property,"compassRotation",e)},expression:"property.compassRotation"}}),i("b-form-spinbutton",{staticClass:"mr-2",attrs:{inline:"",wrap:"",min:"0",max:"359"},on:{change:function(e){return t.rotationUpdate("compass",e)}},model:{value:t.spinNumber.compassRotation,callback:function(e){t.$set(t.spinNumber,"compassRotation",e)},expression:"spinNumber.compassRotation"}}),i("b-icon",{staticStyle:{cursor:"pointer"},attrs:{icon:"arrow-repeat","font-scale":"1.5"},on:{click:function(e){return t.compassRotate(0)}}})],1)]),i("div",{staticClass:"property-item"},[i("span",[t._v("楼层数量：")]),i("b-form-input",{staticStyle:{width:"137px"},attrs:{readonly:""},model:{value:t.floor.floorList.length,callback:function(e){t.$set(t.floor.floorList,"length",e)},expression:"floor.floorList.length"}})],1),i("div",{staticClass:"property-item"},[i("span",[t._v("楼层选择：")]),i("b-form-select",{staticStyle:{width:"137px"},attrs:{options:t.floorOptions},on:{change:t.changeFloor},model:{value:t.selectedFloor,callback:function(e){t.selectedFloor=e},expression:"selectedFloor"}})],1),i("div",{staticClass:"property-item"},[i("span",[t._v("名称修改：")]),i("b-form-input",{staticStyle:{width:"137px"},attrs:{state:t.floorNameChangeState},on:{change:t.changeFloorName},model:{value:t.property.floorName,callback:function(e){t.$set(t.property,"floorName",e)},expression:"property.floorName"}})],1),i("div",{staticClass:"property-item"},[i("span",[t._v("户型面积（单层）：")]),i("div",{staticClass:"d-flex align-items-center"},[i("b-form-input",{staticClass:"mr-1",staticStyle:{width:"118px"},attrs:{readonly:""},model:{value:t.layerArea,callback:function(e){t.layerArea=e},expression:"layerArea"}}),i("span",[t._v("m²")])],1)])])])}),Tt=[],St=(i("b680"),i("caad"),i("2532"),i("a434"),i("fb6a"),i("c740"),i("d81d"),function(t){return(t/1e6).toFixed(2)}),Lt=function(t){return t/Math.PI/2*360},Ct=function(t){return t/360*2*Math.PI},_t={name:"FloorProperty",components:{},data:function(){var t=this.$spoke.getFloor("primary"),e=this.$spoke.getState();return{floor:t,state:e,floorOptions:[],property:{floorName:t.extensionList[t.currentFloor].floorName,bitmapRotation:0,compassRotation:0},spinNumber:{bitmapRotation:0,compassRotation:0},selectedFloor:t.currentFloor,allLayerArea:0,floorNameChangeState:null,lockedFloor:[]}},computed:{layerArea:function(){return St(this.state.layerArea)},bitmapLocked:function(){return this.lockedFloor.includes(this.selectedFloor)}},watch:{"floor.floorList":{handler:function(){this.updateFloorOptions(),this.updateProperty()}}},mounted:function(){var t=this,e=this.$spoke.getEditor("primary"),i=e.drawing;i.compass.element.on("change",this._compassListener=function(e){t.spinNumber.compassRotation=t.property.compassRotation=Number(Lt(e.rotation).toFixed())}),i.negative.on("bitmap-created",this._bitmapListener=function(){return t.updateProperty()}),this.$root.$on("lock",(function(){t.bitmapLocked||t.lockedFloor.push(t.selectedFloor)})),this.$root.$on("unlock",(function(){t.bitmapLocked&&t.lockedFloor.splice(t.lockedFloor.indexOf(t.selectedFloor),1)})),this.updateProperty(),this.updateFloorOptions()},destroyed:function(){var t=this.$spoke.getEditor("primary"),e=t.drawing;e.compass.element.off("change",this._compassListener),e.negative.off("bitmap-created",this._bitmapListener)},methods:{compassRotate:function(t){var e=this.$spoke.getEditor("primary"),i=e.drawing;this.property.compassRotation=t<0?0:t>359?359:Number(t),i.compass.setRotation(Ct(this.property.compassRotation))},bitmapRotate:function(t){if(!this.bitmapLocked){var e=this.$spoke.getEditor("primary"),i=e.drawing,o=i.negative.getAllBitmapList();this.property.bitmapRotation=t<0?0:t>359?359:Number(t),this.spinNumber.bitmapRotation=Number(this.property.bitmapRotation),o[0]&&o[0].setRotation(Ct(this.property.bitmapRotation))}},rotationUpdate:function(t,e){this.property["".concat(t,"Rotation")]=e,this["".concat(t,"Rotate")](e)},addFloor:function(t){var e=this.$spoke.getEditor("primary"),i=this.floor,o=i.floorList,n=i.extensionList,r=i.currentFloor,a=t?o.length-1:0;e.tool.openDefault();var s=r===a?e.serializer.execute(n[r]):o[a],l=r===a?n[r]:n[a],c={cornerList:s.cornerList,wallList:s.wallList,hollowList:s.hollowList},p={floorName:"",isFirst:!1,wallList:l.wallList.slice(0)};o[r]=e.serializer.execute(n[r]),t?(o.push(c),n.push(p),this.changeFloor(o.length-1)):(o.unshift(c),n.unshift(p),this.changeFloor(0))},changeFloor:function(t){this.$spoke.changeFloor("primary",t),this.updateProperty(),this.changeActiveFloor(t),this.$root.$emit("floorChange",{locked:this.bitmapLocked})},changeFloorName:function(){var t=this.floor,e=t.extensionList,i=t.currentFloor,o=e[i];this.property.floorName?o.floorName=this.property.floorName:(o.floorName="",this.property.floorName=""),this.$set(e,i,o),this.floorNameChangeState=!0,o.floorName?this.floorOptions[i].text=o.floorName:this.updateFloorOptions()},updateProperty:function(){var t=this.$spoke.getEditor("primary"),e=t.drawing,i=this.floor,o=i.extensionList,n=i.currentFloor,r=e.negative.getAllBitmapList();this.property.floorName=o[n].floorName,this.property.bitmapRotation=r[0]?Lt(r[0].rotation):0,this.property.compassRotation=Lt(e.compass.rotation),this.selectedFloor=n,this.floorNameChangeState=null},updateFloorOptions:function(){var t=this.floor,e=t.floorList,i=t.extensionList,o=i.findIndex((function(t){return t.isFirst}));this.floorOptions=e.map((function(t,e){var n=i[e].floorName,r=e>o?"负".concat(e-o,"层"):"".concat(o-e+1,"层");return{text:n||r,value:e}}))},changeActiveFloor:function(t){this.selectedFloor=this.floor.currentFloor=t}}},$t=_t,Ft=(i("4c00"),Object(f["a"])($t,xt,Tt,!1,null,null,null)),Ot=Ft.exports,Dt=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"property-room"}},[i("div",{staticClass:"border-bottom px-3",staticStyle:{height:"45px","line-height":"45px"}},[t._v("功能间信息")]),i("div",{staticClass:"app-text-tiny px-3"},[i("div",{staticClass:"property-item"},[i("span",[t._v("房间类型：")]),i("b-form-select",{staticStyle:{width:"137px"},attrs:{options:t.options},on:{change:t.changeRoomType},model:{value:t.property.type,callback:function(e){t.$set(t.property,"type",e)},expression:"property.type"}})],1),i("div",{staticClass:"property-item"},[i("span",[t._v("房间名称：")]),i("b-form-input",{staticStyle:{width:"137px"},on:{change:t.changeRoomName},model:{value:t.property.name,callback:function(e){t.$set(t.property,"name",e)},expression:"property.name"}})],1)])])},Et=[],Rt=(i("b0c0"),["客厅","餐厅","客餐厅","厨房","主卧","次卧","卧室","老人房","儿童房","过道","阳台","卫生间","玄关","地下室"]),Nt={name:"PropertyRoom",data:function(){return{room:null,property:{type:"",name:""}}},computed:{options:function(){var t=Rt.map((function(t){return{value:t,text:t}}));return t.unshift({value:"自定义",text:"自定义"}),t}},mounted:function(){this.init()},destroyed:function(){var t=this.$spoke.getEditor("primary"),e=t.drawing;e.common.off("selector-add",this._addlistener),this.$root.$off("room-property-change",this._changeListener)},methods:{init:function(){var t=this,e=this.$spoke.getEditor("primary"),i=e.drawing;this.room=i.common.getSelectedList()[0],this.updateProperty(this.room),i.common.on("selector-add",this._addlistener=function(e){var i=e[0];i!==t.room&&i.constructor===t.room.constructor&&(t.room=i,t.updateProperty(i))}),this.$root.$on("room-property-change",this._changeListener=function(){return t.updateProperty(t.room)})},updateProperty:function(t){var e=this.$spoke.getProperty("primary",t),i=e.type,o=e.name;Object.assign(this.property,{type:i||"自定义",name:o||""})},changeRoomType:function(){this.property.name=this.property.type,this.$spoke.setProperty("primary",this.room,"type",this.property.type),this.$spoke.setRoomName("primary",this.room,this.property.type),this.$root.$emit("room-property-change")},changeRoomName:function(){this.$spoke.setRoomName("primary",this.room,this.property.name||"未命名"),this.$root.$emit("room-property-change")}}},Wt=Nt,Pt=(i("783f"),Object(f["a"])(Wt,Dt,Et,!1,null,null,null)),jt=Pt.exports,At=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"property-wall"}},[i("div",{staticClass:"border-bottom px-3",staticStyle:{height:"45px","line-height":"45px"}},[t._v("基础参数（墙体）")]),i("div",{staticClass:"app-text-small px-3"},[i("div",[i("div",{staticStyle:{height:"40px","line-height":"40px"}},[t._v("墙体类型：")]),i("b-form-radio-group",{staticClass:"wall-type-radio",attrs:{options:t.wallTypeOptions,buttons:"","button-variant":"outline-secondary"},on:{change:t.setType},model:{value:t.property.type,callback:function(e){t.$set(t.property,"type",e)},expression:"property.type"}})],1),i("div",[i("div",{staticStyle:{height:"40px","line-height":"40px"}},[t._v("墙体参数：")]),i("div",{staticClass:"d-flex align-items-center"},[i("div",{staticClass:"app-text-tiny",staticStyle:{width:"50px"}},[t._v("厚度")]),i("b-form-input",{staticClass:"mx-2",attrs:{min:"10",max:"1000",type:"range"},on:{update:t.setThickness},model:{value:t.property.thickness,callback:function(e){t.$set(t.property,"thickness",e)},expression:"property.thickness"}}),i("b-form-input",{staticClass:"mr-1",staticStyle:{width:"60px"},attrs:{min:"10",max:"1000"},on:{change:t.setThickness},model:{value:t.property.thickness,callback:function(e){t.$set(t.property,"thickness",e)},expression:"property.thickness"}}),i("span",[t._v("mm")])],1)])])])},Bt=[],Mt={name:"PropertyWall",data:function(){return{wall:null,property:{thickness:0}}},computed:{wallTypeOptions:function(){return this.$spoke.getWallType().data}},mounted:function(){this.init()},destroyed:function(){var t=this.$spoke.getEditor("primary"),e=t.drawing;e.common.off("selector-add",this._addlistener),this.wall.destroyed||this.wall.off("change",this._changelistener)},methods:{init:function(){var t=this,e=this.$spoke.getEditor("primary"),i=e.drawing;this.wall=i.common.getSelectedList()[0],this._changelistener=function(e){return t.updateProperty(e)},this.updateProperty(this.wall),this.wall.on("change",this._changelistener),i.common.on("selector-add",this._addlistener=function(e){var i=e[0];i!==t.wall&&i.constructor===t.wall.constructor&&(t.wall.off("change",t._changelistener),i.on("change",t._changelistener),t.wall=i,t.updateProperty(i))})},updateProperty:function(t){var e=t.thickness,i=this.$spoke.getProperty("primary",t),o=i.type;Object.assign(this.property,{thickness:e.toFixed(),type:o||"common"})},setType:function(t){var e=this.$spoke.getWallType(),i=e.color;this.wall.color=i[t]||null,this.$spoke.setProperty("primary",this.wall,"type",t)},setThickness:function(t){isNaN(Number(t))?this.property.thickness=100:this.wall.thickness=Number(t)}}},zt=Mt,It=(i("687c"),Object(f["a"])(zt,At,Bt,!1,null,null,null)),Gt=It.exports,Vt=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"property-hollow"}},[i("div",{staticClass:"border-bottom px-3",staticStyle:{height:"45px","line-height":"45px"}},[t._v(t._s("基础参数（"+t.typeName+"）"))]),i("div",{staticClass:"app-text-small px-3"},[i("div",{directives:[{name:"show",rawName:"v-show",value:t.hollowTypeOptions.length,expression:"hollowTypeOptions.length"}]},[i("div",{staticStyle:{height:"40px","line-height":"40px"}},[t._v(t._s(t.typeName+"类型："))]),i("b-form-radio-group",{staticClass:"type-radio",attrs:{options:t.hollowTypeOptions,buttons:"","button-variant":"outline-secondary"},on:{change:t.setType},model:{value:t.property.type,callback:function(e){t.$set(t.property,"type",e)},expression:"property.type"}})],1),i("div",[i("div",{staticStyle:{height:"40px","line-height":"40px"}},[t._v(t._s(t.typeName+"参数："))]),i("div",{staticClass:"d-flex align-items-center"},[i("div",{staticClass:"app-text-tiny",staticStyle:{width:"50px"}},[t._v("长度")]),i("b-form-input",{staticClass:"mx-2",attrs:{min:"100",max:t.maxWidth,type:"range"},on:{update:t.setWidth},model:{value:t.property.width,callback:function(e){t.$set(t.property,"width",e)},expression:"property.width"}}),i("b-form-input",{staticClass:"mr-1",staticStyle:{width:"60px"},attrs:{min:"100",max:"3000"},on:{change:t.setWidth},model:{value:t.property.width,callback:function(e){t.$set(t.property,"width",e)},expression:"property.width"}}),i("span",[t._v("mm")])],1)]),i("div",{staticClass:"py-3 d-flex flex-row-reverse"},[i("b-button",{attrs:{variant:"primary"},on:{click:t.setDefault}},[t._v("恢复默认")])],1)])])},Ut=[],Kt=i("0bd7"),Ht=(i("4de4"),i("159b"),function(t,e,i,o){var n=t-i,r=e-o;return Math.pow(n*n+r*r,.5)}),Jt={door:["singleDoor","doubleDoor","slidingDoor"],window:["basicWindow","boilerWindow"],bealock:["bealock"]},qt={door:[{value:"singleDoor",text:"单开门"},{value:"doubleDoor",text:"双开门"},{value:"slidingDoor",text:"推拉门"}],window:[{value:"basicWindow",text:"普通窗"},{value:"boilerWindow",text:"一字飘窗"}],bealock:[]},Qt={door:"门",window:"窗",bealock:"垭口"},Xt={name:"PropertyHollow",data:function(){return{hollow:null,property:{type:"",width:0},hollowTypeOptions:[],typeName:"",maxWidth:0,aheadTrap:null,behindTrap:null}},mounted:function(){this.init()},destroyed:function(){var t=this.$spoke.getEditor("primary"),e=t.drawing;e.common.off("selector-add",this._addlistener),this.hollow.destroyed||this.hollow.off("change",this._changelistener)},methods:{init:function(){var t=this,e=this.$spoke.getEditor("primary"),i=e.drawing;this.hollow=i.common.getSelectedList()[0],this._changelistener=function(e){return t.updateProperty(e)},this.updateProperty(this.hollow),this.hollow.on("change",this._changelistener),i.common.on("selector-add",this._addlistener=function(e){var i=e[0];i!==t.hollow&&i.constructor===t.hollow.constructor&&(t.hollow.off("change",t._changelistener),i.on("change",t._changelistener),t.hollow=i,t.updateProperty(i))})},updateProperty:function(t){var e=t.materialName,i=t.width;for(var o in Object.assign(this.property,{width:i.toFixed(),type:e}),Jt)Jt[o].includes(e)&&(this.hollowTypeOptions=qt[o],this.typeName=Qt[o]);this.updateTrap(t)},updateTrap:function(t){var e=t.surface,i=t.offset;if("virtual"!==e.name){var o=this.$spoke.getEditor("primary"),n=o.drawing,r=e.back,a=n.windoor.getAllHollowList(),s=a.filter((function(i){return i!==t&&i!==t.$proxy&&i.surface===e})),l=a.filter((function(e){return e!==t&&e!==t.$proxy&&e.surface===r})),c=[],p=Ht.apply(void 0,Object(Kt["a"])(e.origin).concat(Object(Kt["a"])(r.origin)));s.forEach((function(t){var e=t.width,i=t.offset;c.push([i-e/2,i+e/2])})),l.forEach((function(t){var e=t.width,i=t.offset;c.push([p-(i+e/2),p-(i-e/2)])})),c.push([0,r.wall===r.next.wall?0:r.next.wall.thickness/2]),c.push([e.wall===e.next.wall?p:p-e.next.wall.thickness/2,p]);var u=null,d=null;c.forEach((function(t){t[0]>i&&(null===d||t[1]<d[0])&&(d=t),t[1]<i&&(null===u||t[0]>u[1])&&(u=t)})),this.maxWidth=(d[0]-u[1]).toFixed(),this.aheadTrap=u,this.behindTrap=d}else this.maxWidth=1e4},setType:function(t){this.hollow.setMaterial(t)},setWidth:function(t){var e=this.hollow,i=e.offset,o=e.surface;if(isNaN(Number(t)))return this.property.width=100,void this.hollow.setWidth(100);if("virtual"!==o.name){if(Number(t)>this.maxWidth)return this.property.width=this.maxWidth,void this.hollow.setWidth(Number(this.maxWidth));var n=i-Number(t)/2,r=i+Number(t)/2;this.hollow.setWidth(Number(t)),n<this.aheadTrap[1]&&this.hollow.setOffset(i+(this.aheadTrap[1]-n)),r>this.behindTrap[0]&&this.hollow.setOffset(i-(r-this.behindTrap[0]))}else this.hollow.setWidth(Number(t))},setDefault:function(){this.hollow.setWidth(this.hollow.defaultWidth)}}},Yt=Xt,Zt=(i("14ac"),Object(f["a"])(Yt,Vt,Ut,!1,null,null,null)),te=Zt.exports,ee={name:"Property",components:{Floor:Ot},data:function(){return{activeTool:null,contentVisible:!0}},mounted:function(){this.init()},destroyed:function(){var t=this.$spoke.getEditor("primary"),e=t.drawing;e.common.off("selector-add",this._addlistener),e.common.off("selector-clear",this._clearlistener)},methods:{init:function(){var t=this,e=this.$spoke.getEditor("primary"),i=e.drawing,o=this.$spoke.getSolution(),n=o.Element,r=new Map([[n.Room,jt],[n.Wall,Gt],[n.Hollow,te]]);i.common.on("selector-add",this._addlistener=function(e){t.activeTool=r.get(e[0].constructor)}),i.common.on("selector-clear",this._clearlistener=function(){t.activeTool=null})},toggleConetnt:function(){this.contentVisible=!this.contentVisible,this.$root.$emit("drawing-resize")}}},ie=ee,oe=(i("f709"),Object(f["a"])(ie,wt,kt,!1,null,null,null)),ne=oe.exports,re=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"property-card"}},[i(t.activeCard,{tag:"component",staticClass:"card-component app-text-tiny"})],1)},ae=[],se=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("span",{staticClass:"mr-2",staticStyle:{width:"25px"}},[t._v("类型")]),i("b-form-select",{staticClass:"mr-2",staticStyle:{width:"100px"},attrs:{options:t.options},on:{change:t.changeRoomType},model:{value:t.property.type,callback:function(e){t.$set(t.property,"type",e)},expression:"property.type"}}),i("b-form-input",{staticStyle:{width:"100px"},attrs:{placeholder:"房间名称"},on:{change:t.changeRoomName},model:{value:t.property.name,callback:function(e){t.$set(t.property,"name",e)},expression:"property.name"}})],1)},le=[],ce=["客厅","餐厅","客餐厅","厨房","主卧","次卧","卧室","老人房","儿童房","过道","阳台","卫生间","玄关","地下室"],pe={name:"PropertyCardRoom",data:function(){return{room:null,property:{type:"",name:""}}},computed:{options:function(){var t=ce.map((function(t){return{value:t,text:t}}));return t.unshift({value:"自定义",text:"自定义"}),t}},mounted:function(){this.init()},destroyed:function(){var t=this.$spoke.getEditor("primary"),e=t.drawing;e.common.off("selector-add",this._addListener),this.$root.$off("room-property-change",this._changeListener)},methods:{init:function(){var t=this,e=this.$spoke.getEditor("primary"),i=e.drawing;this.room=i.common.getSelectedList()[0],this.updateProperty(this.room),i.common.on("selector-add",this._addListener=function(e){var i=e[0];i!==t.room&&i.constructor===t.room.constructor&&(t.room=i,t.updateProperty(i))}),this.$root.$on("room-property-change",this._changeListener=function(){return t.updateProperty(t.room)})},updateProperty:function(t){var e=this.$spoke.getProperty("primary",t),i=e.type,o=e.name;Object.assign(this.property,{type:i||"自定义",name:o||""})},changeRoomType:function(){this.property.name=this.property.type,this.$spoke.setProperty("primary",this.room,"type",this.property.type),this.$spoke.setRoomName("primary",this.room,this.property.type),this.$root.$emit("room-property-change")},changeRoomName:function(){this.$spoke.setRoomName("primary",this.room,this.property.name||"未命名"),this.$root.$emit("room-property-change")}}},ue=pe,de=Object(f["a"])(ue,se,le,!1,null,null,null),he=de.exports,me=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",t._l(t.toolList,(function(t,e){return i("b-button",{key:e,attrs:{variant:"outline-secondary",title:t.title},on:{click:t.method}},[i("span",{staticStyle:{height:"25px","line-height":"25px"}},[i("b-img",{staticClass:"w-100",attrs:{src:t.img}})],1)])})),1)},fe=[],ge=(i("ac1f"),i("1276"),{name:"PropertyCardWall",data:function(){return{wall:null,toolList:[{title:"截断",img:"img/Split.svg",method:this.split},{title:"删除",img:"img/Delete.svg",method:this.delete}]}},mounted:function(){this.init()},destroyed:function(){var t=this.$spoke.getEditor("primary"),e=t.drawing;e.common.off("selector-add",this._addlistener)},methods:{init:function(){var t=this,e=this.$spoke.getEditor("primary"),i=e.drawing;this.wall=i.common.getSelectedList()[0],i.common.on("selector-add",this._addlistener=function(e){var i=e[0];i!==t.wall&&i.constructor===t.wall.constructor&&(t.wall=i)})},split:function(){var t=this.$spoke.getEditor("primary"),e=t.drawing,i=this.wall,o=i.thisCorner,n=i.thatCorner,r=e.structure.createCorner((o.x+n.x)/2,(o.y+n.y)/2);e.common.remove(),e.structure.createWall(o,r),e.structure.createWall(r,n)},delete:function(){var t=this.$spoke.getEditor("primary"),e=t.drawing;e.common.remove()}}}),ve=ge,be=Object(f["a"])(ve,me,fe,!1,null,null,null),ye=be.exports,we=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",t._l(t.toolList,(function(t,e){return i("b-button",{directives:[{name:"show",rawName:"v-show",value:!t.show||t.show(),expression:"tool.show ? tool.show() : true"}],key:e,attrs:{variant:"outline-secondary",title:t.title},on:{click:t.method}},[i("span",{staticStyle:{height:"25px","line-height":"25px"}},[i("b-img",{staticClass:"w-100",attrs:{src:t.img}})],1)])})),1)},ke=[],xe=(i("7db0"),["singleDoor","doubleDoor","slidingDoor"]),Te=function(t,e){var i=t.x-e.x,o=t.y-e.y;return Math.pow(i*i+o*o,.5)},Se={name:"PropertyCardWall",data:function(){return{hollow:null,toolList:[{title:"入户门",img:"img/Entrance.svg",method:this.setEntrance,show:this.getEntranceShow},{title:"墙侧翻转",img:"img/FlipWall.svg",method:this.changeSurface},{title:"翻转",img:"img/Flip.svg",method:this.flip},{title:"删除",img:"img/Delete.svg",method:this.delete}],entranceShow:!0}},mounted:function(){this.init()},destroyed:function(){var t=this.$spoke.getEditor("primary"),e=t.drawing;e.common.off("selector-add",this._addlistener)},methods:{init:function(){var t=this,e=this.$spoke.getEditor("primary"),i=e.drawing;this.hollow=i.common.getSelectedList()[0],this.updateToolList(this.hollow),i.common.on("selector-add",this._addlistener=function(e){var i=e[0];i!==t.hollow&&i.constructor===t.hollow.constructor&&(t.hollow=i,t.updateToolList(i))})},getEntranceShow:function(){return this.entranceShow},updateToolList:function(t){this.entranceShow=xe.includes(t.materialName)},setEntrance:function(){var t=this,e=this.$spoke.getEditor("primary"),i=e.drawing,o=i.entrance.getAllArrowList(),n=o.find((function(e){return e.hollow===t.hollow}));if(n)n.remove();else{var r=this.hollow.surface.room,a=this.hollow.surface.back.room;o.forEach((function(t){var e=t.hollow.surface.room,i=t.hollow.surface.back.room;(!r||r!==e&&r!==i)&&(!a||a!==e&&a!==i)||t.remove()})),i.entrance.createArrow(this.hollow)}},changeSurface:function(){var t=this.hollow.surface,e=t.back,i=Te(t.corner,e.corner)-this.hollow.offset;this.hollow.setSurface(e),this.hollow.setOffset(i)},flip:function(){this.hollow.flip()},delete:function(){var t=this,e=this.$spoke.getEditor("primary"),i=e.drawing,o=i.entrance.getAllArrowList(),n=o.find((function(e){return e.hollow===t.hollow}));n&&n.remove(),i.common.remove()}}},Le=Se,Ce=Object(f["a"])(Le,we,ke,!1,null,null,null),_e=Ce.exports,$e={name:"PropertyCard",data:function(){return{activeCard:null,position:[0,0]}},mounted:function(){this.init()},destroyed:function(){var t=this.$spoke.getEditor("primary"),e=t.drawing;e.common.off("selector-add",this._addListener),e.common.off("selector-clear",this._clearListener),document.removeEventListener("mousemove",this._moveListener)},methods:{init:function(){var t=this,e=this.$spoke.getEditor("primary"),i=e.drawing,o=this.$spoke.getSolution(),n=o.Element,r=document.getElementById("property-card"),a=new Map([[n.Room,he],[n.Wall,ye],[n.Hollow,_e]]);i.common.on("selector-add",this._addListener=function(e){t.activeCard=a.get(e[0].constructor),r.style.left="".concat(t.position[0]+30,"px"),r.style.top="".concat(t.position[1]-70,"px")}),i.common.on("selector-clear",this._clearListener=function(){t.activeCard=null}),document.addEventListener("mousemove",this._moveListener=function(e){t.position[0]=e.layerX,t.position[1]=e.layerY})}}},Fe=$e,Oe=(i("507d"),Object(f["a"])(Fe,re,ae,!1,null,null,null)),De=Oe.exports,Ee=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"px-4",attrs:{id:"viewport"}},[i("div",{staticClass:"mr-4",staticStyle:{width:"40px",cursor:"pointer"},on:{click:t.bitmapBackToCenter}},[i("b-img",{staticClass:"h-100 w-100",attrs:{src:"img/ViewReset.svg"}})],1),i("span",{staticStyle:{width:"25px",height:"30px","line-height":"25px",cursor:"pointer"},on:{click:t.zoomOut}},[i("b-img",{staticClass:"w-100 h-100",attrs:{src:"img/Dash.svg"}})],1),i("b-form-input",{staticClass:"mx-2",attrs:{type:"range",min:"1",max:"100"},on:{update:t.changeScale},model:{value:t.inputScale,callback:function(e){t.inputScale=e},expression:"inputScale"}}),i("span",{staticStyle:{width:"25px",height:"30px","line-height":"25px",cursor:"pointer"},on:{click:t.zoomIn}},[i("b-img",{staticClass:"w-100 h-100",attrs:{src:"img/Plus.svg"}})],1)],1)},Re=[],Ne=1,We=200,Pe={name:"Viewport",data:function(){return{inputScale:0,inputScaleClone:0}},computed:{scale:function(){return 100-this.inputScale}},mounted:function(){var t=this,e=this.$spoke.getEditor("primary"),i=e.drawing;this.inputScale=100-i.scale,this._interval=setInterval((function(){t.inputScaleClone=100-i.scale,t.inputScaleClone!==t.inputScale&&(t.inputScale=t.inputScaleClone)}),We)},destroyed:function(){clearInterval(this._interval)},methods:{bitmapBackToCenter:function(){var t=this.$spoke.getEditor("primary"),e=t.drawing,i=e.width,o=e.height,n=e.negative.getAllBitmapList();if(n[0]){var r=n[0],a=r.width,s=r.height;e.viewport.ViewAdjuster.backToCenter(-a/2,s/2,a/2,-s/2)}else e.setOrigin(i/2,o/2),e.setScale(25)},changeScale:function(){var t=this.$spoke.getEditor("primary"),e=t.drawing;e.setScale(this.scale)},zoomOut:function(){if(1!=this.inputScale){var t=this.$spoke.getEditor("primary"),e=t.drawing;this.inputScale=Number(this.inputScale)-Ne,e.setScale(this.scale)}},zoomIn:function(){if(100!=this.inputScale){var t=this.$spoke.getEditor("primary"),e=t.drawing;this.inputScale=Number(this.inputScale)+Ne,e.setScale(this.scale)}}}},je=Pe,Ae=(i("95f6"),Object(f["a"])(je,Ee,Re,!1,null,null,null)),Be=Ae.exports,Me=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{attrs:{id:"visible"}},[i("b-dropdown",{attrs:{"no-caret":"",dropup:"",size:"sm",variant:"link"},scopedSlots:t._u([{key:"button-content",fn:function(){return[i("b-img",{attrs:{src:"img/Eye.svg"}})]},proxy:!0}])},[i("b-dropdown-group",{attrs:{header:"勾选隐藏项","header-classes":"visible-dropdown-header"}},[i("b-dropdown-form",{staticClass:"visible-dropdown-form"},[i("b-form-checkbox",{on:{change:t.changeRoomNameVisible},model:{value:t.visible.roomName,callback:function(e){t.$set(t.visible,"roomName",e)},expression:"visible.roomName"}},[t._v("房间名")]),i("b-form-checkbox",{on:{change:t.changeRoomAreaVisible},model:{value:t.visible.roomArea,callback:function(e){t.$set(t.visible,"roomArea",e)},expression:"visible.roomArea"}},[t._v("面积")]),i("b-form-checkbox",{on:{change:t.changeSizeVisible},model:{value:t.visible.size,callback:function(e){t.$set(t.visible,"size",e)},expression:"visible.size"}},[t._v("尺寸标注")])],1)],1)],1)],1)},ze=[],Ie={name:"Visible",data:function(){return{visible:{roomName:!1,roomArea:!1,size:!1}}},mounted:function(){this.$spoke.setRoomAreaShow("primary",!0)},methods:{changeRoomNameVisible:function(t){this.$spoke.setRoomNameShow("primary",!t)},changeRoomAreaVisible:function(t){this.$spoke.setRoomAreaShow("primary",!t)},changeSizeVisible:function(t){this.$spoke.setDimensionShow("primary",!t)}}},Ge=Ie,Ve=(i("40e4"),Object(f["a"])(Ge,Me,ze,!1,null,null,null)),Ue=Ve.exports,Ke={name:"",components:{AppMenu:v,AppToolBar:Q,AppToolSetting:yt,AppProperty:ne,AppPropertyCard:De,appViewport:Be,appVisible:Ue},mounted:function(){var t=this.$spoke.getEditor("primary"),e=t.drawing;e.mount(this.$refs.drawing),this.originBackToCenter(),e.options.style.backgroundColor=16711422,e.structure.options.corner.style.hover.color=4235007,e.structure.options.wall.style.color=8355711,e.structure.options.wall.midline.show=!1,e.grid.options.rectangular.style.lineWidth=.5,e.compass.element.setNorthPointColor(4235007),e.compass.element.setSouthPointColor(14540253),this.$root.$on("drawing-resize",(function(){e.resize()}))},methods:{originBackToCenter:function(){var t=this.$spoke.getEditor("primary"),e=t.drawing,i=e.width,o=e.height;e.setOrigin(i/2,o/2),e.setScale(25)},useTransformerFromSelector:function(){var t=this.$spoke.getEditor("primary"),e=t.tool;e.activated===e.symbol.SELECTOR&&e.openTransformer()}}},He=Ke,Je=Object(f["a"])(He,l,c,!1,null,null,null),qe=Je.exports,Qe=i("5f5b"),Xe=i("b1e0"),Ye=i("8f9c"),Ze=i("0402"),ti=(i("dca8"),i("d9e2"),i("d198")),ei=i("7580"),ii=(i("cb29"),Math.PI),oi=60,ni=15,ri=10,ai={stateless:{line:0,arcLine:14145753,fill:16777215,windowFill:13421772},hover:{line:8053503,arcLine:15464441,fill:16777215,windowFill:13421772},select:{line:4096759,arcLine:15068665,fill:16777215,windowFill:13421772},virtual:{line:16711680,arcLine:16711680,fill:16777215,windowFill:16777215}},si=function(t){var e=t.hover,i=t.focus,o=t.select,n=t.virtual;return o||i?ai.select:e?ai.hover:n?ai.virtual:ai.stateless},li={width:800,render:function(t,e){var i=e.width,o=e.height,n=e.fliped,r=e.scale,a=n?1:0,s=ni/r,l=oi/r,c=si(e);return t.lineStyle(s,c.arcLine).beginFill(c.fill,.1).arc(i*a,o/2,i,-ii/2*a-ii/2,-ii*a/2).lineTo(i*a,o/2).lineTo(0,o/2-i+a*i).endFill().beginFill(c.fill).lineStyle(s,c.fill).drawRect(0,0,i,o).lineStyle(s,c.line).moveTo(0,0).lineTo(0,o).moveTo(i,0).lineTo(i,o).lineStyle(s,c.line).drawRect((i-l)*a,o/2,l,-i),t.pivot.x=i/2,t.pivot.y=o/2,t}},ci={width:800,render:function(t,e){var i=e.width,o=e.height,n=e.scale,r=ni/n,a=oi/n,s=si(e);return t.lineStyle(r,s.arcLine).beginFill(s.fill,.1).arc(0,o/2,i/2,-ii/2,0).lineTo(0,o/2).lineTo(0,(o-i)/2).endFill().beginFill(s.fill,.1).lineStyle(r,s.arcLine).arc(i,o/2,i/2,ii,-ii/2).lineTo(i,o/2).lineTo(i/2,o/2).endFill().beginFill(s.fill).lineStyle(r,s.fill).drawRect(0,0,i,o).lineStyle(r,s.line).moveTo(0,0).lineTo(0,o).moveTo(i,0).lineTo(i,o).drawRect(0,o/2,a,-i/2).drawRect(i,o/2,-a,-i/2),t.pivot.x=i/2,t.pivot.y=o/2,t}},pi={width:800,render:function(t,e){var i=e.width,o=e.height,n=e.scale,r=e.fliped,a=r?-1:1,s=ni/n,l=ri/n,c=si(e);return t.lineStyle(s,c.line).beginFill(c.fill).drawRect(0,0,i,o).drawRect(0+s+l,o/2,2*i/3,o/4*a).drawRect(i-s-l,o/2,-2*i/3,-o/4*a),t.pivot.x=i/2,t.pivot.y=o/2,t}},ui={width:1450,render:function(t,e){var i=e.width,o=e.height,n=e.fliped,r=e.scale,a=n?1:0,s=ni/r,l=si(e);return t.lineStyle(s,l.line).beginFill(l.fill).drawRect(0,0,i,o).moveTo(0,o/3).lineTo(i,o/3).moveTo(0,2*o/3).lineTo(i,2*o/3).moveTo(i/4+a*i/2,o/3).lineTo(i/4+a*i/2,2*o/3).endFill(),t.pivot.x=i/2,t.pivot.y=o/2,t}},di={width:2e3,render:function(t,e){var i=e.width,o=e.height,n=e.scale,r=ni/n,a=si(e);return t.lineStyle(r,a.fill).beginFill(a.fill).drawRect(0,0,i,o).endFill().lineStyle(r,a.line).drawRect(0,0,i,o/3).drawRect(0,2*o/3,i,o/3),t.pivot.x=i/2,t.pivot.y=o/2,t}},hi={width:800,render:function(t,e){var i=e.width,o=e.height,n=e.scale,r=ni/n,a=si(e);return t.lineStyle(r,a.line).beginFill(a.fill).drawRect(0,0,i,o).moveTo(0,o/2).lineTo(i,o/2).endFill(),t.pivot.x=i/2,t.pivot.y=o/2,t}},mi={width:1500,render:function(t,e){var i=e.width,o=e.scale,n=e.sillThickness,r=void 0===n?500/o:n,a=e.height,s=ni/o,l=a,c=si(e);return t.lineStyle(s,c.line).beginFill(c.windowFill).drawRect(0,-r,i,r).endFill().beginFill(c.fill).moveTo(0,-a).lineTo(0,-r).lineTo(i,-r).lineTo(i,-a).lineTo(i+l,-a).lineTo(i+l,-(r+l)).lineTo(-l,-(r+l)).lineTo(-l,-a).lineTo(0,-a).endFill().moveTo(-l/2,-a).lineTo(-l/2,-(r+l/2)).lineTo(i+l/2,-(r+l/2)).lineTo(i+l/2,-a),t.pivot.x=i/2,t.pivot.y=-a/2,t}},fi={width:1500,render:function(t,e){var i=e.width,o=e.height,n=e.scale,r=ni/n,a=si(e);return t.lineStyle(r,a.line).beginFill(a.fill).drawRect(0,0,i,o).endFill().moveTo(0,o/2).lineTo(i,o/2).moveTo(0,o/3).lineTo(i,o/3).moveTo(0,2*o/3).lineTo(i,2*o/3).moveTo(i/2,o/3).lineTo(i/2,2*o/3),t.pivot.x=i/2,t.pivot.y=o/2,t}},gi={render:function(t,e){var i=e.leftWidth,o=e.rightWidth,n=e.leftWallThickness,r=e.rightWallThickness,a=e.scale,s=ni/a,l=si(e);return t.lineStyle(s,l.line).beginFill(l.fill).moveTo(0,0).lineTo(o,0).lineTo(o,r).lineTo(n,r).lineTo(n,i).lineTo(0,i).lineTo(0,0).endFill().moveTo(n/2,i).lineTo(n/2,r/2).lineTo(o,r/2),t.pivot.x=o/2,t.pivot.y=r/2,t}},vi={render:function(t,e){var i=e.leftWidth,o=e.centerWidtn,n=e.rightWidth,r=e.leftWallThickness,a=e.centerWallThickness,s=e.rightWallThickness,l=e.scale,c=ni/l,p=si(e);return t.lineStyle(c,p.line).beginFill(p.fill).moveTo(0,0).lineTo(o,0).lineTo(o,n).lineTo(o-s,n).lineTo(o-s,a).lineTo(r,a).lineTo(r,i).lineTo(0,i).lineTo(0,0).endFill().moveTo(r/2,i).lineTo(r/2,a/2).lineTo(o-s/2,a/2).lineTo(o-s/2,n),t.pivot.x=o/2,t.pivot.y=a/2,t}},bi={render:function(t,e){var i=e.leftWidth,o=e.rightWidth,n=e.leftWindowThickness,r=e.rightWindowThickness,a=e.leftWallThickness,s=e.rightWallThickness,l=e.scale,c=ni/l,p=si(e);return t.lineStyle(c,p.line).beginFill(p.windowFill).moveTo(a,s).lineTo(o,s).lineTo(o,s-r).lineTo(a-n,s-r).lineTo(a-n,i).lineTo(a,i).lineTo(a,s).endFill().beginFill(p.fill).moveTo(a-n,s-r).lineTo(o,s-r).lineTo(o,0).lineTo(o+s,0).lineTo(o+s,-r).lineTo(-n,-r).lineTo(-n,i+a).lineTo(0,i+a).lineTo(0,i).lineTo(a-n,i).lineTo(a-n,s-r).endFill().moveTo(0,i+a/2).lineTo(a/2-n,i+a/2).lineTo(a/2-n,s/2-r).lineTo(o+s/2,s/2-r).lineTo(o+s/2,0),t.pivot.x=o/2,t.pivot.y=s/2,t}},yi={render:function(t,e){var i=e.leftWidth,o=e.centerWidtn,n=e.rightWidth,r=e.leftWindowThinkness,a=e.centerWindowThinkness,s=e.rightWindowThinkness,l=e.leftWallThickness,c=e.centerWallThickness,p=e.rightWallThickness,u=e.scale,d=ni/u,h=si(e);return t.lineStyle(d,h.line).beginFill(h.windowFill).moveTo(l,c).lineTo(o-p,c).lineTo(o-p,n).lineTo(o-p+s,n).lineTo(o-p+s,c-a).lineTo(l-r,c-a).lineTo(l-r,i).lineTo(l,i).lineTo(l,c).endFill().beginFill(h.fill).moveTo(l-r,c-a).lineTo(o+s-p,c-a).lineTo(o+s-p,n).lineTo(o,n).lineTo(o,n+p).lineTo(o+s,n+p).lineTo(o+s,-a).lineTo(-r,-a).lineTo(-r,i+l).lineTo(0,i+l).lineTo(0,i).lineTo(l-r,i).lineTo(l-r,c-a).endFill().moveTo(0,i+l/2).lineTo(l/2-r,i+l/2).lineTo(l/2-r,c/2-a).lineTo(o+s-p/2,c/2-a).lineTo(o+s-p/2,n+p/2).lineTo(o,n+p/2),t.pivot.x=o/2,t.pivot.y=c/2,t}},wi=(i("e9c4"),function(){return fetch("")}),ki=function(){return fetch("")},xi=function(){return fetch("")},Ti=function(){return fetch("")},Si=i("0db8"),Li=function(){return wi().then((function(){return""}))},Ci=function(){return xi().then((function(){return[{id:"negative1",url:"https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fpic.to8to.com%2Fcase%2F2006%2F23%2F20200623_6a750511c8d76b01310a6wvonv822qh0.jpg&refer=http%3A%2F%2Fpic.to8to.com&app=2002&size=f9999,10000&q=a80&n=0&g=0n&fmt=jpeg?sec=1645100826&t=0437dfdfef1405d8c159efd7c130d5ec",scale:.05},{id:"negative2",url:"https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fimages.081616.cn%2Farticle%2Fmaifang%2Fkanhuxing%2F232.jpg&refer=http%3A%2F%2Fimages.081616.cn&app=2002&size=f9999,10000&q=a80&n=0&g=0n&fmt=auto?sec=1659786598&t=a3bdc6951b31bdb0f5151e2b2903bcbb",scale:.05},{id:"negative3",url:"https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fimgs.soufun.com%2Fnews%2F2014_07%2F24%2Fnews%2F1406194190774_000.jpg&refer=http%3A%2F%2Fimgs.soufun.com&app=2002&size=f9999,10000&q=a80&n=0&g=0n&fmt=auto?sec=1660013137&t=5443dd7d6e3a51f168c74bb27e1b3554",scale:.05}]}))},_i=function(){var t=[ki(),xi(),Ti()];return Promise.all(t).then((function(){return Si}))},$i=function(t){return console.log(t),new Promise((function(t){return t(!0)}))},Fi=[{id:"singleDoor",material:o.SingleDoor},{id:"doubleDoor",material:o.DoubleDoor},{id:"slidingDoor",material:o.SlidingDoor},{id:"bealock",material:o.Bealock},{id:"basicWindow",material:n.BasicWindow},{id:"boilerWindow",material:n.BoilerWindow}],Oi=[{text:"普通墙",value:"common"},{text:"承重墙",value:"bearing"},{text:"矮墙",value:"short"}],Di={bearing:3355443,short:16777215},Ei=function(){var t=Object(ei["a"])(Object(ti["a"])().mark((function t(e){var i,o;return Object(ti["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Ci();case 2:return i=t.sent,o=[e.Resource.windoorListRegister(Fi),e.Resource.negativeListRegister(i)],t.abrupt("return",Promise.all(o));case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),Ri=(i("6062"),{locked:new Set,roomNameShow:!0,roomAreaShow:!0,entryDoorShow:!0,layerArea:0,allLayerArea:0,snap:!0}),Ni=function(t){return(t/1e6).toFixed(2)},Wi=function(t,e,i,o,n,r){return((i-t)*(r-e)-(n-t)*(o-e))/2},Pi=function(t){if(!(t.length<3)){for(var e=t[0],i=0,o=0,n=0,r=t[1],a=2;a<t.length;a++){var s=t[a],l=Wi.apply(void 0,Object(Kt["a"])(e).concat(Object(Kt["a"])(r),Object(Kt["a"])(s)));n+=l,i+=(e[0]+r[0]+s[0])*l,o+=(e[1]+r[1]+s[1])*l,r=s}return[i/n/3,o/n/3]}},ji=function(t,e,i){var o="";Ri.roomNameShow&&(o+=e),Ri.roomAreaShow&&(o+="".concat(o.length>0?"\n":"","约").concat(Ni(i),"m²")),t.setText(o)},Ai=function(t,e,i){var o,n,r,a,s,l,c=i.Element,p=i.Tool,u=t.drawing,d=t.tool,h=u.bricklayer.Builder,m=u.label.TextLabeler,f=u.label.LineLabeler,g=u.label.ImageLabeler,v=u.bricklayer.Chamber,b=!1,y=(o={},Object(x["a"])(o,p.Bricklayer.Builder.PICKUP_FROM,(function(t){0===t&&h.pick()})),Object(x["a"])(o,p.Bricklayer.Builder.PICKUP_TO,(function(t){0===t&&h.build().pick().pick()})),o),w=(n={},Object(x["a"])(n,p.Bricklayer.Chamber.PICKUP_FROM,(function(t){0===t&&v.pick()})),Object(x["a"])(n,p.Bricklayer.Chamber.PICKUP_TO,(function(t){0===t&&v.build().pick()})),n),k=(r={},Object(x["a"])(r,p.Label.TextLabeler.PICK,(function(t){0===t&&m.pick().open()})),Object(x["a"])(r,p.Label.LineLabeler.PICK_ORIGIN,(function(t){0===t&&f.pick()})),Object(x["a"])(r,p.Label.LineLabeler.PICK_TARGET,(function(t){0===t&&f.pick().open()})),Object(x["a"])(r,p.Label.ImageLabeler.PICK,(function(t){0===t&&g.pick().open()})),r);u.on("pointerdown",(function(t){if(2===t.button){var e=function(){return b=!0},i=function t(){u.off("pointermove",e),window.removeEventListener("mouseup",t)};b=!1,u.on("pointermove",e),window.addEventListener("mouseup",i)}h.$state!==p.Ready&&y[h.$state](t.button),v.$state!==p.Ready&&w[v.$state](t.button),m.$state!==p.Ready&&k[m.$state](t.button),f.$state!==p.Ready&&k[f.$state](t.button),g.$state!==p.Ready&&k[g.$state](t.button)}));var T=function(t){0===t&&u.common.selectorAction(u.focusing)},S=function(t){if(2!==t||b||d.openDefault(),0===t){var e=u.focusing;u.common.transformerAction(e),e instanceof c.Hollow?u.hammer.adjuster.pick():u.hammer.adjuster.drop(),e instanceof c.LabelText||e instanceof c.LabelLine||e instanceof c.LabelImage?u.label.LabelTransformer.pick():u.label.LabelTransformer.drop()}},L=(a={},Object(x["a"])(a,p.Bricklayer.Builder.PICKUP_FROM,(function(t){2!==t||b||d.openDefault()})),Object(x["a"])(a,p.Bricklayer.Builder.PICKUP_TO,(function(t){2!==t||b||h.drop()})),a),C=(s={},Object(x["a"])(s,p.Bricklayer.Chamber.PICKUP_FROM,(function(t){2!==t||b||d.openDefault()})),Object(x["a"])(s,p.Bricklayer.Chamber.PICKUP_TO,(function(t){2!==t||b||v.drop()})),s),_=(l={},Object(x["a"])(l,p.Label.TextLabeler.PICK,(function(t){2!==t||b||d.openDefault()})),Object(x["a"])(l,p.Label.LineLabeler.PICK_ORIGIN,(function(t){0!==t||b||d.openDefault()})),Object(x["a"])(l,p.Label.LineLabeler.PICK_TARGET,(function(t){2!==t||b||f.close().open()})),Object(x["a"])(l,p.Label.ImageLabeler.PICK,(function(t){2!==t||b||d.openDefault()})),l);u.on("pointerup",(function(t){d.activated===d.symbol.SELECTOR&&T(t.button),d.activated===d.symbol.TRANSFORMER&&S(t.button),v.$state!==p.Ready&&C[v.$state](t.button),h.$state!==p.Ready&&L[h.$state](t.button),m.$state!==p.Ready&&_[m.$state](t.button),f.$state!==p.Ready&&_[f.$state](t.button),g.$state!==p.Ready&&_[g.$state](t.button)}));var $=function(){Ri.layerArea=u.structure.getAllRoomList().map((function(t){return t.area})).reduce((function(t,e){return t+e}))};u.structure.on("room-created",(function(t){setTimeout((function(){var i,o=t.getOuterSurfaceList().map((function(t){return[t.corner.x,t.corner.y]})),n=e.get(t).name="未命名",r=(i=u.label).createLabelText.apply(i,Object(Kt["a"])(Pi(o)));r.setRoom(t),e.get(t).position=[r.x,r.y],ji(r,n,t.area),$();var a=t.area;t.on("dirty",(function(){if(t.area!==a){var i=t.getOuterSurfaceList().map((function(t){return[t.corner.x,t.corner.y]})),o=e.get(t).name;r.setPosition.apply(r,Object(Kt["a"])(Pi(i))),e.get(t).position=[r.x,r.y],ji(r,o,t.area),$(),a=t.area}})),t.on("destroy",(function(){r.remove()})),h.$state===p.Bricklayer.Builder.PICKUP_TO&&1!==h.from.size&&h.drop()}))})),u.label.on("labeltext-created",(function(t){t.on("change",(function(){t.room&&(e.get(t.room).position=[t.x,t.y])}))}));var F=function(t){t.on("pointerdown",(function(){t.flip()}))};u.on("element-create",(function(t){t instanceof c.Arrow&&F(t)})),window.addEventListener("keydown",(function(e){if("Escape"===e.key){if(d.activated===t.tool.symbol.WALL_BUILDER&&h.$state===p.Bricklayer.Builder.PICKUP_TO)return void h.drop();d.openDefault()}else"Delete"===e.key&&u.common.remove()}))},Bi=function(t,e){t.serializer||(t.serializer={}),Object.assign(t.serializer,{begin:function(t,e){var i=e.negative.getAllBitmapList();i[0]&&(t.bitmap={id:i[0].fill,position:[i[0].x,i[0].y],rotation:i[0].rotation})},walls:function(t){t.wallList=[]},wall:function(t,i){t.wallList.push(e.get(i))},rooms:function(t){t.roomList=[]},room:function(t,i){t.roomList.push(e.get(i))},hollows:function(t){t.hollowList=[]},hollow:function(t,e,i){var o=i.entrance.getAllArrowList().find((function(t){return t.hollow===e}));o?t.hollowList.push({entrance:{fliped:o.fliped}}):t.hollowList.push({})}}),t.deserializer||(t.deserializer={}),Object.assign(t.deserializer,{end:function(t,e){if(t.bitmap){var i=t.bitmap,o=i.id,n=i.position,r=i.rotation,a=e.negative.createBitmap(o);a.setPosition.apply(a,Object(Kt["a"])(n)),a.setRotation(r)}},wall:function(t,i,o){var n=t.wallList[o];e.has(i)?Object.assign(e.get(i),n):e.set(i,n),n.type&&(i.color=Di[n.type])},room:function(t,i,o,n){var r=t.roomList[o],a=n.label.getAllLabelTextList().find((function(t){return t.room===i}));e.has(i)?Object.assign(e.get(i),r):e.set(i,r),r.name&&a&&ji(a,r.name,i.area),r.position&&a&&a.setPosition.apply(a,Object(Kt["a"])(r.position))},hollow:function(t,e,i,o){var n=t.hollowList[i];if(n.entrance){var r=o.entrance.createArrow(e);r.fliped!==n.entrance.fliped&&r.flip()}}})},Mi=function(t,e,i){e.on(i,(function(e){t.has(e)||t.set(e,{}),e.on("destroy",(function(){return t.delete(e)}))}))},zi=function(t,e){var i=t.drawing;Mi(e,i.structure,"corner-created"),Mi(e,i.structure,"wall-created"),Mi(e,i.structure,"room-created"),Mi(e,i.windoor,"hollow-created"),Mi(e,i.furniture,"stuff-created"),Mi(e,i.label,"labeltext-created"),Mi(e,i.label,"labelline-created"),Mi(e,i.label,"labelimage-created"),Mi(e,i.negative,"bitmap-created")},Ii={},Gi=function(t,e){Ii[t]=setInterval((function(){var i=e.floorSerialize(t);localStorage.setItem("".concat(t,"Data"),JSON.stringify({error:!1,floor:i,date:Date.now()}))}),5e3),window.addEventListener("error",(function(){clearInterval(Ii[t]);var e=JSON.parse(localStorage.getItem("".concat(t,"Data")));e.error=!0,localStorage.setItem("".concat(t,"Data"),JSON.stringify(e))}))},Vi=function(t,e){var i=JSON.parse(localStorage.getItem("".concat(t,"Data")));i&&i.error&&setTimeout((function(){var o=i.floor,n=o.floorList,r=o.extensionList,a=o.currentFloor;e.floorDeserialize(t,n,r,a)}))},Ui={},Ki={},Hi={},Ji=function(t){var e=Object.freeze({getEditor:function(t){var e=Ki[t];if(!e)throw new Error("id ".concat(t," is not existed"));return e},createEditor:function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=Ki[e];if(o)throw new Error("Duplicated id '".concat(e,"'"));Ui[e]={floorList:[{}],extensionList:[{isFirst:!0,floorName:""}],currentFloor:0},Hi[e]=new Map,Bi(i,Hi[e]);var n=window.e=new t(i);return n.drawing.hammer.setMinWidth(100),Ki[e]=n,Ai(n,Hi[e],t),zi(n,Hi[e]),Gi(e,this),n},getSolution:function(){return t},setProperty:function(t,e,i,o){var n=Hi[t];if(!n)throw new Error("id ".concat(t," is not existed"));n.get(e)[i]=o},getProperty:function(t,e){var i=Hi[t];if(!i)throw new Error("id ".concat(t," is not existed"));return i.get(e)},getFloor:function(t){return Ui[t]},floorSerialize:function(t){var e=Ki[t],i=Ui[t],o=i.floorList,n=i.extensionList,r=i.currentFloor;n[r]||(n[r]={});var a=n[r],s=e.serializer.execute(a);return o[r]=s,o.forEach((function(t){t.compass?t.compass.rotation=s.compass.rotation:t.compass={rotation:s.compass.rotation}})),Ui[t]},floorDeserialize:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],o=arguments.length>3?arguments[3]:void 0,n=Ki[t],r=void 0===o?i.findIndex((function(t){return t.isFirst})):o;return Ui[t].floorList=e,Ui[t].extensionList=i,Ui[t].currentFloor=r,n.deserializer.execute(e[r],i[r]),Ui},changeFloor:function(t,e){var i=Ui[t],o=i.floorList,n=i.extensionList;this.floorSerialize(t),this.clearDrawing(t,!0),this.floorDeserialize(t,o,n,e)},getState:function(){return Ri},getWallType:function(){return{data:Oi,color:Di}},lock:function(t){Ri.locked.add(t)},unlock:function(t){Ri.locked.delete(t)},setRoomName:function(t,e,i){var o=Ki[t].drawing,n=o.label.getAllLabelTextList().find((function(t){return t.room===e}));this.setProperty(t,e,"name",i),ji(n,i,e.area)},setRoomNameShow:function(t,e){var i=Ki[t].drawing,o=Hi[t],n=i.label.getAllLabelTextList().filter((function(t){return t.room}));Ri.roomNameShow=e,n.forEach((function(t){ji(t,o.get(t.room).name,t.room.area)}))},setRoomAreaShow:function(t,e){var i=Ki[t].drawing,o=Hi[t],n=i.label.getAllLabelTextList().filter((function(t){return t.room}));Ri.roomAreaShow=e,n.forEach((function(t){ji(t,o.get(t.room).name,t.room.area)}))},setDimensionShow:function(t,e){var i,o=Ki[t].drawing,n=Object(Ze["a"])(o.measure.dimensions());try{for(n.s();!(i=n.n()).done;){var r=i.value;e?r.show():r.hide()}}catch(a){n.e(a)}finally{n.f()}},setSnapState:function(t,e){var i=Ki[t].drawing;i.grid.options.rectangular.snap.enabled=e,i.structure.options.snap.corner.active=e,Ri.snap=e},clearDrawing:function(t,e){var i=Ki[t].drawing,o=i.windoor.getAllHollowList(),n=i.furniture.getAllStuffList(),r=i.structure.getAllCornerList(),a=i.negative.getAllBitmapList(),s=i.label.getAllLabelTextList(),l=i.label.getAllLabelLineList(),c=i.entrance.getAllArrowList();o.forEach((function(t){return t.remove()})),n.forEach((function(t){return t.remove()})),r.forEach((function(t){return t.remove()})),s.filter((function(t){return!t.room})).forEach((function(t){return t.remove()})),l.forEach((function(t){return t.remove()})),c.forEach((function(t){return t.remove()})),e&&a.forEach((function(t){return t.remove()}))},save:function(t){var e=this.floorSerialize(t);return $i({floorList:e.floorList,extensionList:e.extensionList})}});return Promise.all([_i(),Ei(t)]).then((function(t){Vi("primary",e),e.floorDeserialize("primary",t[0].floorList,t[0].extensionList)})),e};a["default"].use(Qe["a"],Ye),a["default"].use(Xe["a"]);var qi=new a["default"]({render:function(t){return t(qe)},mounted:function(){}});window.addEventListener("keydown",(function(t){t.altKey&&t.preventDefault()})),window.addEventListener("resize",(function(){qi.$emit("drawing-resize")})),Li().then((function(t){var e=new URL(location.href),i=e.searchParams.get("host")||"127.0.0.1",o=e.searchParams.get("port")||"3001";s["a"]({origin:"http://".concat(i,":").concat(o),ticket:t},(function(t,e,i){var o=Ji(t,e,i);o.createEditor("primary"),a["default"].prototype.$spoke=o,qi.$mount("#app")}))}))},"687c":function(t,e,i){"use strict";i("2b1a")},"698f":function(t,e,i){"use strict";i("389a")},"6db6":function(t,e,i){"use strict";i("aeae")},"783f":function(t,e,i){"use strict";i("ddc3")},"7b33":function(t,e,i){"use strict";i("b2ed")},8899:function(t,e,i){},"88d6":function(t,e,i){},"8f9c":function(t){t.exports=JSON.parse('{"breakpoints":["xs","sm","md","lg","xl","xxl"],"formControls":{"size":"sm"},"BLink":{"activeClass":"active"},"BButton":{"variant":"primary","size":"sm"},"BToast":{"toaster":"b-toaster-top-center","autoHideDelay":3000,"variant":"primary","toastClass":null,"headerClass":null,"bodyClass":null},"BModal":{"cancelVariant":"secondary","okVariant":"primary"},"BFormGroup":{"labelSize":"sm"},"BInputGroup":{"size":"sm"},"BNavItem":{"linkClasses":["p-0","px-1"]}}')},9018:function(t,e,i){},9342:function(t,e,i){"use strict";i("f083")},"95f6":function(t,e,i){"use strict";i("cdee")},aeae:function(t,e,i){},b2ed:function(t,e,i){},bb78:function(t,e,i){"use strict";i("5051")},cdee:function(t,e,i){},ddc3:function(t,e,i){},f083:function(t,e,i){},f709:function(t,e,i){"use strict";i("fabd")},fabd:function(t,e,i){}});