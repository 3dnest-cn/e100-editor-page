(function(t){function e(e){for(var o,a,s=e[0],l=e[1],c=e[2],p=0,d=[];p<s.length;p++)a=s[p],Object.prototype.hasOwnProperty.call(i,a)&&i[a]&&d.push(i[a][0]),i[a]=0;for(o in l)Object.prototype.hasOwnProperty.call(l,o)&&(t[o]=l[o]);u&&u(e);while(d.length)d.shift()();return r.push.apply(r,c||[]),n()}function n(){for(var t,e=0;e<r.length;e++){for(var n=r[e],o=!0,s=1;s<n.length;s++){var l=n[s];0!==i[l]&&(o=!1)}o&&(r.splice(e--,1),t=a(a.s=n[0]))}return t}var o={},i={app:0},r=[];function a(e){if(o[e])return o[e].exports;var n=o[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=t,a.c=o,a.d=function(t,e,n){a.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},a.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(t,e){if(1&e&&(t=a(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)a.d(n,o,function(e){return t[e]}.bind(null,o));return n},a.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],l=s.push.bind(s);s.push=e,s=s.slice();for(var c=0;c<s.length;c++)e(s[c]);var u=l;r.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"0085":function(t,e,n){"use strict";n("12fd")},"026c":function(t,e,n){},1227:function(t,e,n){},"12fd":function(t,e,n){},"14ac":function(t,e,n){"use strict";n("9018")},"2b1a":function(t,e,n){},"389a":function(t,e,n){},"3a74":function(t,e,n){},"40e4":function(t,e,n){"use strict";n("8899")},"4c00":function(t,e,n){"use strict";n("88d6")},5051:function(t,e,n){},"507d":function(t,e,n){"use strict";n("3a74")},"56d7":function(t,e,n){"use strict";n.r(e);var o={};n.r(o),n.d(o,"Line",(function(){return ge})),n.d(o,"Vector",(function(){return we})),n.d(o,"Segment",(function(){return ke})),n.d(o,"Point",(function(){return Te}));var i={};n.r(i),n.d(i,"fromBothPoint",(function(){return je})),n.d(i,"fromSegment",(function(){return _e})),n.d(i,"from",(function(){return Ce})),n.d(i,"dot",(function(){return Le})),n.d(i,"multiply",(function(){return $e})),n.d(i,"cross",(function(){return De})),n.d(i,"length",(function(){return We})),n.d(i,"rotate90",(function(){return Ee})),n.d(i,"normalize",(function(){return Ne})),n.d(i,"invert",(function(){return Pe})),n.d(i,"rotate",(function(){return Ae})),n.d(i,"project",(function(){return Fe})),n.d(i,"equal",(function(){return Ue}));var r={};n.r(r),n.d(r,"fromSegment",(function(){return Xe})),n.d(r,"toStandard",(function(){return en})),n.d(r,"intersectLine",(function(){return on}));var a={};n.r(a),n.d(a,"translate",(function(){return Se})),n.d(a,"toLeftOfSegment",(function(){return Ge})),n.d(a,"rotate",(function(){return He})),n.d(a,"project",(function(){return Je})),n.d(a,"distanceToPoint",(function(){return Ye})),n.d(a,"distanceToLine",(function(){return Ke})),n.d(a,"distanceToSegment",(function(){return rn})),n.d(a,"equal",(function(){return an}));var s={};n.r(s),n.d(s,"containsPoint",(function(){return sn})),n.d(s,"area",(function(){return ln}));var l={};n.r(l),n.d(l,"install",(function(){return Jo}));var c={};n.r(c),n.d(c,"install",(function(){return Xo}));var u={};n.r(u),n.d(u,"install",(function(){return qo}));var p={};n.r(p),n.d(p,"install",(function(){return ni}));var d={};n.r(d),n.d(d,"SingleDoor",(function(){return di})),n.d(d,"DoubleDoor",(function(){return fi})),n.d(d,"SlidingDoor",(function(){return hi})),n.d(d,"ParentDoor",(function(){return mi})),n.d(d,"Bealock",(function(){return vi}));var f={};n.r(f),n.d(f,"BasicWindow",(function(){return bi})),n.d(f,"BoilerWindow",(function(){return gi})),n.d(f,"FloorWindow",(function(){return yi})),n.d(f,"LWindow",(function(){return wi})),n.d(f,"UWindow",(function(){return xi})),n.d(f,"LBoilerWindow",(function(){return ki})),n.d(f,"UBoilerWindow",(function(){return Oi}));var h={};n.r(h),n.d(h,"doorResouceId",(function(){return Ti})),n.d(h,"windowResourceId",(function(){return Si})),n.d(h,"install",(function(){return ji}));var m={};n.r(m),n.d(m,"install",(function(){return Ci}));var v={};n.r(v),n.d(v,"install",(function(){return Wi}));var b={};n.r(b),n.d(b,"isHouse",(function(){return Ni})),n.d(b,"isDrawing",(function(){return Pi})),n.d(b,"fromHouse",(function(){return Ai}));var g={};n.r(g),n.d(g,"symbol",(function(){return Xi})),n.d(g,"map",(function(){return qi}));var y={};n.r(y),n.d(y,"symbol",(function(){return Qi})),n.d(y,"typeSymbol",(function(){return Zi})),n.d(y,"toolSymbol",(function(){return tr})),n.d(y,"map",(function(){return er})),n.d(y,"typeMap",(function(){return nr})),n.d(y,"toolMap",(function(){return or}));var w={};n.r(w),n.d(w,"typeSymbol",(function(){return ir})),n.d(w,"toolSymbol",(function(){return rr})),n.d(w,"typeMap",(function(){return ar})),n.d(w,"toolMap",(function(){return sr}));var x={};n.r(x),n.d(x,"typeList",(function(){return lr}));var k,O=n("d198"),T=n("7580"),S=(n("e260"),n("e6cf"),n("cca6"),n("a79d"),n("b0c0"),n("d81d"),n("d9e2"),n("b64b"),n("e9c4"),n("1227"),n("2b0e")),j=n("5f5b"),_=n("b1e0"),C=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"d-flex flex-column position-relative w-100 h-100",attrs:{id:"app"}},[n("div",[n("app-menu")],1),n("div",{staticClass:"d-flex flex-fill w-100"},[n("div",[n("app-tool-bar")],1),n("div",{staticClass:"h-100 w-100 overflow-hidden position-relative"},[n("div",{ref:"drawing",staticClass:"w-100 h-100",staticStyle:{"line-height":"0"},on:{dblclick:t.useTransformerFromSelector}}),n("app-tool-setting"),n("app-property-card"),n("div",{staticClass:"position-absolute",staticStyle:{right:"20px",bottom:"100px"}},[n("app-check")],1),n("div",{staticClass:"position-absolute",staticStyle:{right:"20px",bottom:"40px"}},[n("app-viewport")],1),n("div",{staticClass:"position-absolute",staticStyle:{left:"40px",bottom:"40px"}},[n("app-visible")],1)],1),n("div",[n("app-property")],1)])])},L=[],$=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"d-flex justify-content-between align-items-center border-bottom",staticStyle:{height:"76px"},attrs:{id:"menu"}},[n("div",{staticClass:"d-flex align-items-center px-3 font-weight-bold",staticStyle:{width:"500px",height:"50px","line-height":"50px"}},[n("b-img",{staticClass:"mr-3",staticStyle:{width:"30px"},attrs:{src:"img/House.svg"}}),n("span",[t._v(t._s(t.name))])],1),n("div",{staticClass:"d-flex align-items-center app-custom"},t._l(t.toolGroupList,(function(e,o){return n("div",{key:o,staticClass:"d-flex align-items-center"},[t._l(e,(function(e){return n("b-button",{directives:[{name:"show",rawName:"v-show",value:t.shownMap[e],expression:"shownMap[symbol]"}],key:e,staticClass:"menu-btn",attrs:{disabled:t.disabledMap[e]||t.readonly,pressed:e===t.active,variant:"outline-secondary"},on:{click:t.buttonMethods[e]}},[n("b-img",{staticStyle:{width:"30px"},attrs:{src:t.toolMap[e].image[e===t.active?"active":"base"]}}),n("span",{staticClass:"mt-1"},[t._v(t._s(t.toolMap[e].label))])],1)})),o<t.toolGroupList.length-1?n("div",{staticClass:"border-left",staticStyle:{height:"50px"}}):t._e()],2)})),0),n("div",{staticClass:"d-flex flex-row-reverse",staticStyle:{width:"500px"}},[n("b-button",{staticClass:"menu-btn",attrs:{variant:"outline-secondary"},on:{click:t.showExitModal}},[n("b-img",{staticStyle:{width:"30px"},attrs:{src:"img/Quit.svg"}}),n("span",{staticClass:"mt-1"},[t._v("退出")])],1)],1),n("b-modal",{attrs:{id:"clear-modal",title:"一键清空","hide-footer":"",size:"sm"}},[n("div",{staticClass:"d-block text-center mt-3 mb-4"},[t._v("您确定要清空当前楼层的户型图")]),n("div",{staticClass:"d-flex justify-content-center align-items-center"},[n("b-button",{staticClass:"mt-0 mr-3",attrs:{block:""},on:{click:function(e){return t.$bvModal.hide("clear-modal")}}},[t._v("取消")]),n("b-button",{staticClass:"mt-0",attrs:{block:"",variant:"danger"},on:{click:t.clear}},[t._v("确定")])],1)]),n("b-modal",{attrs:{id:"exit-modal",title:"退出","hide-footer":"",size:"sm"}},[n("div",{staticClass:"d-block text-center mt-3 mb-4"},[t._v("您是否要退出户型图绘制工具")]),n("div",{staticClass:"d-flex justify-content-center align-items-center"},[n("b-button",{staticClass:"mt-0 mr-3",attrs:{block:""},on:{click:function(e){return t.$bvModal.hide("exit-modal")}}},[t._v("取消")]),n("b-button",{staticClass:"mt-0",attrs:{block:"",variant:"danger"},on:{click:t.exit}},[t._v("确定")])],1)]),n("b-toast",{attrs:{visible:t.opened&&t.readonly,"no-auto-hide":"","no-hover-pause":"",variant:"danger","toast-class":"custom-toast"}},[t._v("已有用户正在绘制中，暂不支持同时绘制，请稍等")])],1)},D=[],R=n("2fe6"),W=n("b192"),E=(n("d3b7"),n("159b"),n("4de4"),n("7db0"),6e5),N={data:function(){return{name:"",active:this.$spec.menu.symbol.selector,locked:!1,hasWall:!1,opened:!1,readonly:!0}},computed:{toolMap:function(){return this.$spec.menu.map},toolGroupList:function(){var t=this.$spec.menu.symbol;return[[t.selector,t.transformer],[t.save,t.clear,t.lock,t.unlock]]},disabledMap:function(){var t=this.$spec.menu.symbol,e={};return Object.keys(t).forEach((function(t){return e[t]=!1})),Object(W["a"])(Object(W["a"])({},e),{},Object(R["a"])({},t.unlock,this.hasWall))},shownMap:function(){var t,e=this.$spec.menu.symbol,n={};return Object.keys(e).forEach((function(t){return n[t]=!0})),Object(W["a"])(Object(W["a"])({},n),{},(t={},Object(R["a"])(t,e.lock,!this.locked),Object(R["a"])(t,e.unlock,this.locked),t))},buttonMethods:function(){var t,e=this,n=this.$spec.menu.symbol;return t={},Object(R["a"])(t,n.selector,(function(){return e.select()})),Object(R["a"])(t,n.transformer,(function(){return e.move()})),Object(R["a"])(t,n.save,(function(){return e.save()})),Object(R["a"])(t,n.clear,(function(){return e.requestClear()})),Object(R["a"])(t,n.lock,(function(){return e.lock()})),Object(R["a"])(t,n.unlock,(function(){return e.unlock()})),t}},mounted:function(){this.init()},destroyed:function(){var t=this.$editor;t.off("opened",this._openedListener),t.off("tool-open",this._toolOpenListener),t.off("wall-create",this._wallCreateListener),t.off("wall-destroy",this._wallDestroyListener),this.closeAutoSave()},methods:{init:function(){var t=this,e=this.$editor;this.$root.$on("readonly",(function(e){t.readonly!==e&&(t.readonly=e,e?t.closeAutoSave():t.autoSave())})),e.on("opened",this._openedListener=function(n){t.name=e.feature.document.name,t.opened=!0,n?t.readonly=!0:t.autoSave()}),e.on("tool-open",this._toolOpenListener=function(e){t.active!==e&&(t.active=e)}),e.on("wall-create",this._wallCreateListener=function(){t.hasWall=!0,t.locked||t.lock(!0)}),e.on("wall-destroy",this._wallDestroyListener=function(){t.hasWallAllFloor()||(t.hasWall=!1,t.unlock())})},select:function(){this.$editor.feature.tool.openSelector()},move:function(){this.$editor.feature.tool.openTransformer()},save:function(t){var e=this;this.$editor.feature.document.save().then((function(){e.$root.$emit("save"),document.hidden||e.$bvToast.toast(t?"自动保存成功...":"保存成功",{autoHideDelay:2e3,noHoverPause:!0,toastClass:"custom-toast",variant:"default"})}))},autoSave:function(){var t=this;this._timeout=setTimeout((function(){t.save(),t.autoSave()}),E)},closeAutoSave:function(){this._timeout&&clearTimeout(this._timeout)},retreat:function(){console.log("retreat")},advance:function(){console.log("advance")},hasWallAllFloor:function(){var t=this.$editor,e=t.feature.floor,n=t.solution.drawing.structure.getAllWallList(),o=e.getData().list.filter((function(t){return t.level!==e.current}));return n.length>0||o.find((function(t){return t.drawing.wallList.length>0}))},requestClear:function(){this.$bvModal.show("clear-modal")},clear:function(){this.$editor.feature.floor.clear(),this.$bvModal.hide("clear-modal"),this.hasWallAllFloor()||(this.hasWall=!1,this.unlock())},lock:function(t){var e=t?"底图已锁定，清空户型图后可解锁":"底图已锁定";this.locked=!0,this.$root.$emit("lock"),this.readonly||this.$bvToast.toast(e,{autoHideDelay:2e3,noHoverPause:!0,toastClass:"custom-toast",variant:"default"})},unlock:function(){this.locked=!1,this.$root.$emit("unlock")},showExitModal:function(){this.$bvModal.show("exit-modal")},exit:function(){var t=this;this.$editor.feature.document.save().then((function(){t.$bvModal.hide("exit-modal"),window.close()}))}}},P=N,A=(n("bb78"),n("0c7c")),F=Object(A["a"])(P,$,D,!1,null,null,null),M=F.exports,B=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"h-100 border-right d-flex",attrs:{id:"tool-bar-container"}},[n("b-button-toolbar",{staticClass:"flex-column border-right app-custom",staticStyle:{width:"68px","font-size":"12px"},attrs:{id:"app-toolgroup"}},t._l(t.toolList,(function(e,o){return n("b-button-group",{key:o,staticClass:"p-1"},[n("b-button",{staticClass:"d-flex flex-column align-items-center p-1 border-0",attrs:{pressed:e.id===t.active,variant:"outline-secondary",disabled:t.readonly},on:{click:function(n){return t.changeTool(e.id)}}},[n("b-img",{staticStyle:{width:"30px"},attrs:{src:e.id===t.active?e.active:e.img}}),n("span",{staticClass:"app-text-tiny mt-1"},[t._v(t._s(e.title))])],1)],1)})),1),n("div",{staticClass:"tool-bar-content"},[n("span",{staticClass:"content-button",on:{click:t.toggleConetnt}},[n("b-icon",{attrs:{icon:t.contentVisible?"chevron-left":"chevron-right"}})],1),n(t.activeTool,{tag:"component",staticClass:"content-component",class:{hidden:!t.contentVisible}})],1)],1)},I=[],z=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"d-flex flex-column",attrs:{id:"tool"}},[t._l(t.toolGroup,(function(e,o){return n("div",{key:e.title+o,staticClass:"px-2"},[n("div",{staticClass:"border-bottom px-2",staticStyle:{height:"30px","line-height":"30px"}},[t._v(t._s(e.title))]),n("div",{staticClass:"d-flex flex-wrap pt-2"},t._l(e.toolList,(function(e,o){return n("b-button",{key:e+o,staticClass:"tool-item",class:{"no-margin-right":(o+1)%3===0,"btn-active":t.toolGroupMap[e].id===t.activeToolGroup},attrs:{disabled:t.readonly},on:{click:function(n){return t.activeTool(e)}}},[n("span",{staticStyle:{width:"40px",height:"40px","line-height":"40px"}},[n("b-img",{staticClass:"w-100 h-100",attrs:{src:t.toolGroupMap[e].id===t.activeToolGroup&&t.toolGroupMap[e].active?t.toolGroupMap[e].active:t.toolGroupMap[e].img}})],1),n("span",{staticClass:"mt-2 app-text-tiny text-center"},[t._v(t._s(t.toolGroupMap[e].title))])])})),1)])})),t._l(t.windoorGroup,(function(e,o){return n("div",{key:e.title+o,staticClass:"px-2"},[n("div",{staticClass:"border-bottom px-2",staticStyle:{height:"30px","line-height":"30px"}},[t._v(t._s(e.title))]),n("div",{staticClass:"d-flex flex-wrap pt-3"},t._l(e.toolList,(function(e,o){return n("b-button",{key:e+o,staticClass:"tool-item",class:{"no-margin-right":(o+1)%3===0},attrs:{disabled:t.readonly},on:{click:function(n){return t.activeWindoor(e)}}},[n("span",{staticStyle:{width:"40px",height:"40px","line-height":"40px"}},[n("b-img",{staticClass:"w-100 h-100",attrs:{src:t.windoorMap[e].img}})],1),n("span",{staticClass:"mt-1 app-text-tiny text-center"},[t._v(t._s(t.windoorMap[e].title))])])})),1)])}))],2)},V=[],U="selector",G="transformer",H="builder",J="chamber",Y="spliter",K="labeler",X="viewport",q=(k={},Object(R["a"])(k,U,{id:U,title:"选择器",icon:"cursor",click:function(t){t.feature.tool.openSelector()}}),Object(R["a"])(k,G,{id:G,title:"变形器",icon:"arrows-move",click:function(t){t.feature.tool.openTransformer()}}),Object(R["a"])(k,H,{id:H,title:"画墙",img:"img/Wall.svg",active:"img/Wall_Active.svg",click:function(t){t.feature.tool.openBuilder()}}),Object(R["a"])(k,J,{id:J,title:"画房间",img:"img/Room.svg",active:"img/Room_Active.svg",click:function(t){t.feature.tool.openChamber()}}),Object(R["a"])(k,Y,{id:Y,title:"截断器",icon:"input-cursor",click:function(t){t.feature.tool.openSpliter()}}),Object(R["a"])(k,K,{id:K,title:"标注",icon:"tags",click:function(t){t.feature.tool.openLabeler()}}),Object(R["a"])(k,X,{id:X,title:"视口",icon:"search",click:function(t){t.feature.tool.openViewport()}}),k),Q={singleDoor:{id:"singleDoor",title:"单开门",img:"img/SingleDoor.svg"},doubleDoor:{id:"doubleDoor",title:"双开门",img:"img/DoubleDoor.svg"},slidingDoor:{id:"slidingDoor",title:"推拉门",img:"img/SlidingDoor.svg"},basicWindow:{id:"basicWindow",title:"普通窗",img:"img/BasicWindow.svg"},boilerWindow:{id:"boilerWindow",title:"一字飘窗",img:"img/BoilerWindow.svg"},bealock:{id:"bealock",title:"垭口",img:"img/Bealock.svg"}},Z=[{title:"画墙",toolList:[H,J]}],tt=[{title:"门窗",toolList:["singleDoor","doubleDoor","slidingDoor","basicWindow","boilerWindow"]},{title:"其他构件",toolList:["bealock"]}],et={name:"Tool",data:function(){return{activeToolGroup:null,toolGroup:Z,windoorGroup:tt,toolGroupMap:q,windoorMap:Q,readonly:!0}},mounted:function(){var t=this;this.activeTool(U),this.$root.$on("readonly",(function(e){return t.readonly=e})),this.$editor.on("tool-open",this._toolOpenListener=function(e){t.activeToolGroup!==e&&(t.activeToolGroup=e,t.$root.$emit("toolGroupChange",e))})},destroyed:function(){this.$editor.off("open",this._toolOpenListener)},methods:{activeTool:function(t){q[t].click(this.$editor),this.activeToolGroup=t,this.$root.$emit("toolGroupChange",t)},activeWindoor:function(t){var e=this.$editor;e.feature.tool.openDefault();var n=e.solution.drawing.windoor.createMovingHollow();e.map.get(n).setResource(this.$spec.hollow.map[t].resource)}}},nt=et,ot=(n("6db6"),Object(A["a"])(nt,z,V,!1,null,null,null)),it=ot.exports,rt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"tool-bar-material"}},[n("b-tabs",{staticClass:"p-2",attrs:{pills:"","no-fade":"","nav-class":"material-tab-nav"}},t._l(t.materialGroup,(function(e,o){return n("b-tab",{key:o,attrs:{title:e.title,active:e.active}},t._l(e.dataList,(function(e,o){return n("div",{key:o},[n("div",{staticClass:"border-bottom px-2",staticStyle:{height:"30px","line-height":"30px"}},[t._v(t._s(e.title))]),n("div",{staticClass:"d-flex flex-wrap pt-3"},t._l(e.materialList,(function(e,o){return n("div",{key:o,staticClass:"d-flex flex-column align-items-center mb-2",staticStyle:{width:"50px"},on:{click:function(n){return t.create(t.materialMap[e].id)}}},[n("span",{staticStyle:{width:"40px",height:"40px",cursor:"pointer"}},[n("b-img",{staticClass:"h-100 w-100",attrs:{src:t.materialMap[e].img}})],1),n("span",{staticClass:"mt-1 app-text-tiny text-center"},[t._v(t._s(t.materialMap[e].title))])])})),0)])})),0)})),1)],1)},at=[],st={0:{id:0,title:"单人床",img:"img/SingleDoor.png"},1:{id:1,title:"双人床",img:"img/SingleDoor.png"},2:{id:2,title:"组合床",img:"img/SingleDoor.png"},3:{id:3,title:"榻榻米",img:"img/SingleDoor.png"},4:{id:4,title:"单人沙发",img:"img/SingleDoor.png"},5:{id:5,title:"双人沙发",img:"img/SingleDoor.png"},6:{id:6,title:"多人沙发",img:"img/SingleDoor.png"},7:{id:7,title:"组合沙发",img:"img/SingleDoor.png"},8:{id:8,title:"转角沙发",img:"img/SingleDoor.png"},9:{id:9,title:"弧形沙发",img:"img/SingleDoor.png"},10:{id:10,title:"圆形餐桌",img:"img/SingleDoor.png"},11:{id:11,title:"方形餐桌",img:"img/SingleDoor.png"},12:{id:12,title:"长条形餐桌",img:"img/SingleDoor.png"},13:{id:13,title:"书桌",img:"img/SingleDoor.png"},14:{id:14,title:"梳妆台",img:"img/SingleDoor.png"},15:{id:15,title:"一字型橱柜",img:"img/SingleDoor.png"},16:{id:16,title:"L形橱柜",img:"img/SingleDoor.png"},17:{id:17,title:"U形橱柜",img:"img/SingleDoor.png"},18:{id:18,title:"浴缸",img:"img/SingleDoor.png"},19:{id:19,title:"淋浴房",img:"img/SingleDoor.png"},20:{id:20,title:"洗手台",img:"img/SingleDoor.png"},21:{id:21,title:"马桶",img:"img/SingleDoor.png"},22:{id:22,title:"洗衣机",img:"img/SingleDoor.png"},23:{id:23,title:"绿植",img:"img/SingleDoor.png"},24:{id:24,title:"地毯",img:"img/SingleDoor.png"},25:{id:25,title:"长方形楼梯",img:"img/SingleDoor.png"},26:{id:26,title:"L形楼梯",img:"img/SingleDoor.png"},27:{id:27,title:"U形楼梯",img:"img/SingleDoor.png"},28:{id:28,title:"圆形楼梯",img:"img/SingleDoor.png"},29:{id:29,title:"地板",img:"img/SingleDoor.png"},30:{id:30,title:"瓷砖",img:"img/SingleDoor.png"},31:{id:31,title:"地毯",img:"img/SingleDoor.png"}},lt=[{title:"家具",dataList:[{title:"床",materialList:[0,1,2,3]},{title:"沙发",materialList:[4,5,6,7,8,9]},{title:"桌几",materialList:[10,11,12,13,14]}]},{title:"厨卫",dataList:[{title:"厨房",materialList:[15,16,17]},{title:"卫浴",materialList:[18,19,20,21,22]}]},{title:"家饰",dataList:[{title:"家饰",materialList:[23,24]}]},{title:"建筑",dataList:[{title:"楼梯",materialList:[25,26,27,28]},{title:"地板设计",materialList:[29,30,31]}]}],ct={name:"Material",data:function(){return{materialMap:st,materialGroup:lt}},mounted:function(){console.log("material")},methods:{create:function(t){console.log(t)}}},ut=ct,pt=(n("9342"),Object(A["a"])(ut,rt,at,!1,null,null,null)),dt=pt.exports,ft={tool:it,material:dt},ht={name:"ToolBarContainer",data:function(){return{toolList:[{id:"tool",title:"绘制工具",img:"img/DrawTool.svg",active:"img/DrawTool_Active.svg"}],active:"tool",activeTool:it,contentVisible:!0,readonly:!0}},mounted:function(){var t=this;this.$root.$on("readonly",(function(e){return t.readonly=e}))},methods:{changeTool:function(t){this.active=t,this.activeTool=ft[t],this.contentVisible||this.toggleConetnt()},toggleConetnt:function(){var t=this.$editor.solution.drawing;this.contentVisible=!this.contentVisible,t.setOrigin(t.origin[0]+(this.contentVisible?-200:200),t.origin[1]),this.$root.$emit("drawing-resize")}}},mt=ht,vt=(n("0085"),Object(A["a"])(mt,B,I,!1,null,null,null)),bt=vt.exports,gt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"position-absolute d-flex justify-content-center w-100",staticStyle:{top:"0",height:"0"}},[n(t.current,{tag:"component",staticClass:"border mt-1 position-absolute",staticStyle:{"background-color":"#FFF"}})],1)},yt=[],wt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"d-flex",attrs:{id:"builder-setting"}},[n("b-form-radio-group",{staticClass:"d-flex align-items-center pr-1 pl-3",attrs:{options:t.alignOptions},on:{change:t.setWallAlignment},model:{value:t.align,callback:function(e){t.align=e},expression:"align"}}),n("div",{staticClass:"position-relative"},[n("b-form-group",{staticClass:"my-1 px-2 border-left border-right",staticStyle:{width:"12em"},attrs:{"label-cols-sm":"3","content-cols-sm":"9",label:"墙厚","label-for":"wall-thinkness"}},[n("b-input-group",{attrs:{append:"mm"}},[n("b-form-input",{attrs:{id:"wall-thinkness",type:"number",autocomplete:"off"},on:{change:t.setWallThinkness,focus:function(){return t.thinknessDropdownShow=!0},blur:function(){return t.thinknessDropdownShow=!1}},model:{value:t.thinkness,callback:function(e){t.thinkness=t._n(e)},expression:"thinkness"}})],1)],1),n("b-list-group",{directives:[{name:"show",rawName:"v-show",value:t.thinknessDropdownShow,expression:"thinknessDropdownShow"}],staticClass:"input-dropdown"},t._l(t.thinknessList,(function(e,o){return n("b-list-group-item",{key:o,attrs:{button:""},on:{mousedown:function(n){return t.setWallThinkness(e)}}},[t._v(t._s(e))])})),1)],1),n("b-form-checkbox",{staticClass:"d-flex align-items-center mx-3",on:{change:t.setSnapState},model:{value:t.snapState,callback:function(e){t.snapState=e},expression:"snapState"}},[t._v("吸附")])],1)},xt=[],kt=(n("a9e3"),10),Ot=1e3,Tt={name:"BuilderSetting",data:function(){return{thinkness:240,thinknessList:[100,120,180,200,240],thinknessDropdownShow:!1,align:"center",alignOptions:[{value:"center",text:"墙中线绘制"},{value:"right",text:"墙内线绘制"}],snapState:!0}},mounted:function(){this.setWallThinkness(this.thinkness),this.setWallAlignment(this.align),this.snapState=this.$editor.getState().snap},methods:{setWallThinkness:function(t){var e=Number(t);this.thinkness=e<kt?kt:e>Ot?Ot:e,this.$editor.solution.drawing.bricklayer.Builder.setThickness(this.thinkness)},setWallAlignment:function(t){this.$editor.solution.drawing.bricklayer.Builder.setAlignment(t)},setSnapState:function(t){this.$editor.setSnap(t)}}},St=Tt,jt=(n("7b33"),Object(A["a"])(St,wt,xt,!1,null,null,null)),_t=jt.exports,Ct=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"d-flex",attrs:{id:"chamber-setting"}},[n("div",[n("b-form-group",{staticClass:"my-1 pr-2 pl-3 border-right",staticStyle:{width:"12em"},attrs:{"label-cols-sm":"3","content-cols-sm":"9",label:"墙厚","label-for":"wall-thinkness"}},[n("b-input-group",{attrs:{append:"mm"}},[n("b-form-input",{attrs:{id:"wall-thinkness",type:"number",autocomplete:"off"},on:{change:t.setWallThinkness,focus:function(){return t.thinknessDropdownShow=!0},blur:function(){return t.thinknessDropdownShow=!1}},model:{value:t.thinkness,callback:function(e){t.thinkness=t._n(e)},expression:"thinkness"}})],1)],1),n("b-list-group",{directives:[{name:"show",rawName:"v-show",value:t.thinknessDropdownShow,expression:"thinknessDropdownShow"}],staticClass:"input-dropdown"},t._l(t.thinknessList,(function(e,o){return n("b-list-group-item",{key:o,attrs:{button:""},on:{mousedown:function(n){return t.setWallThinkness(e)}}},[t._v(t._s(e))])})),1)],1),n("b-form-checkbox",{staticClass:"d-flex align-items-center mx-3",on:{change:t.setSnapState},model:{value:t.snapState,callback:function(e){t.snapState=e},expression:"snapState"}},[t._v("吸附")])],1)},Lt=[],$t=10,Dt=1e3,Rt={name:"ChamberSetting",data:function(){return{thinkness:240,thinknessList:[100,120,180,200,240],thinknessDropdownShow:!1,snapState:!0}},mounted:function(){this.setWallThinkness(this.thinkness),this.snapState=this.$editor.getState().snap},methods:{setWallThinkness:function(t){var e=Number(t);this.thinkness=e<$t?$t:e>Dt?Dt:e,this.$editor.solution.drawing.bricklayer.Chamber.setThickness(this.thinkness)},setSnapState:function(t){this.$editor.setSnap(t)}}},Wt=Rt,Et=(n("698f"),Object(A["a"])(Wt,Ct,Lt,!1,null,null,null)),Nt=Et.exports,Pt={builder:_t,chamber:Nt},At={name:"ToolSetting",data:function(){return{current:null}},mounted:function(){var t=this;this.$root.$on("toolGroupChange",(function(e){t.current=Pt[e]}))}},Ft=At,Mt=Object(A["a"])(Ft,gt,yt,!1,null,null,null),Bt=Mt.exports,It=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"border-left",attrs:{id:"property-container"}},[n("span",{staticClass:"property-button",on:{click:t.toggleConetnt}},[n("b-icon",{attrs:{icon:t.contentVisible?"chevron-right":"chevron-left"}})],1),n("div",{staticClass:"property-content",class:{hidden:!t.contentVisible}},[n("floor",{staticClass:"mb-3"}),n(t.activeTool,{tag:"component"})],1)])},zt=[],Vt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"property-floor"}},[n("div",{staticClass:"border-bottom px-3",staticStyle:{height:"45px","line-height":"45px"}},[t._v("户型属性")]),n("div",{staticClass:"d-flex flex-column app-text-tiny px-3"},[n("div",{staticClass:"property-item"},[n("span",[t._v("底图旋转：")]),n("div",{staticClass:"position-relative"},[n("b-form-input",{staticClass:"spin-input spin-button-hidden",staticStyle:{width:"39px",left:"36px"},attrs:{type:"number",readonly:t.negativeLocked||t.readonly},on:{change:t.bitmapRotate},model:{value:t.property.bitmapRotation,callback:function(e){t.$set(t.property,"bitmapRotation",e)},expression:"property.bitmapRotation"}}),n("b-form-spinbutton",{staticClass:"mr-2",attrs:{inline:"",wrap:"",min:"0",max:"359",readonly:t.negativeLocked||t.readonly},on:{change:function(e){return t.rotationUpdate("bitmap",e)}},model:{value:t.spinNumber.bitmapRotation,callback:function(e){t.$set(t.spinNumber,"bitmapRotation",e)},expression:"spinNumber.bitmapRotation"}}),n("b-icon",{staticStyle:{cursor:"pointer"},attrs:{icon:"arrow-repeat","font-scale":"1.5"},on:{click:function(e){return t.bitmapRotate(0)}}})],1)]),n("div",{staticClass:"property-item"},[n("span",[t._v("指北针：")]),n("div",{staticClass:"position-relative"},[n("b-form-input",{staticClass:"position-absolute rounded-0 border-left-0 border-right-0 text-center spin-button-hidden",staticStyle:{width:"39px",left:"36px"},attrs:{type:"number",readonly:t.readonly},on:{change:t.compassRotate},model:{value:t.property.compassRotation,callback:function(e){t.$set(t.property,"compassRotation",e)},expression:"property.compassRotation"}}),n("b-form-spinbutton",{staticClass:"mr-2",attrs:{inline:"",wrap:"",min:"0",max:"359",readonly:t.readonly},on:{change:function(e){return t.rotationUpdate("compass",e)}},model:{value:t.spinNumber.compassRotation,callback:function(e){t.$set(t.spinNumber,"compassRotation",e)},expression:"spinNumber.compassRotation"}}),n("b-icon",{staticStyle:{cursor:"pointer"},attrs:{icon:"arrow-repeat","font-scale":"1.5"},on:{click:function(e){return t.compassRotate(0)}}})],1)]),n("div",{staticClass:"property-item"},[n("span",[t._v("楼层数量：")]),n("b-form-input",{staticStyle:{width:"137px"},attrs:{readonly:""},model:{value:t.property.length,callback:function(e){t.$set(t.property,"length",e)},expression:"property.length"}})],1),n("div",{staticClass:"property-item"},[n("span",[t._v("楼层选择：")]),n("b-form-select",{staticStyle:{width:"137px"},attrs:{options:t.floorOptions,disabled:t.readonly},on:{change:t.changeFloor},model:{value:t.selectedFloor,callback:function(e){t.selectedFloor=e},expression:"selectedFloor"}})],1),n("div",{staticClass:"property-item"},[n("span",[t._v("名称修改：")]),n("b-form-input",{staticStyle:{width:"137px"},attrs:{state:t.floorNameChangeState,readonly:t.readonly},on:{change:t.changeFloorName},model:{value:t.property.floorName,callback:function(e){t.$set(t.property,"floorName",e)},expression:"property.floorName"}})],1),n("div",{staticClass:"property-item"},[n("span",[t._v("户型面积（单层）：")]),n("div",{staticClass:"d-flex align-items-center"},[n("b-form-input",{staticClass:"mr-1",staticStyle:{width:"118px"},attrs:{readonly:""},model:{value:t.layerArea,callback:function(e){t.layerArea=e},expression:"layerArea"}}),n("span",[t._v("m²")])],1)])])])},Ut=[],Gt=(n("b680"),function(t){return(t/1e6).toFixed(2)}),Ht=function(t){return t/Math.PI/2*360},Jt=function(t){return t/360*2*Math.PI},Yt=function(t){return t<0?0:t>359?359:Number(t)},Kt={name:"FloorProperty",data:function(){return{floorOptions:[],property:{length:0,floorName:"",bitmapRotation:0,compassRotation:0},spinNumber:{bitmapRotation:0,compassRotation:0},selectedFloor:1,layerArea:0,floorNameChangeState:null,negativeLocked:!1,readonly:!0}},mounted:function(){var t=this,e=this.$editor;e.on("floor-set",this._floorSetListener=function(){t.updateFloorOptions(),t.updateProperty()}),e.on("area-change",this._areaListener=function(e){return t.layerArea=Gt(e)}),e.on("compass-change",this._compassListener=function(e){t.spinNumber.compassRotation=t.property.compassRotation=Number(Ht(e.rotation).toFixed())}),e.on("bitmap-create",this._bitmapListener=function(){return t.updateProperty()}),this.$root.$on("lock",(function(){return t.negativeLocked=!0})),this.$root.$on("unlock",(function(){return t.negativeLocked=!1})),this.$root.$on("readonly",(function(e){return t.readonly=e}))},destroyed:function(){var t=this.$editor;t.off("floor-set",this._floorSetListener),t.off("area-change",this._areaListener),t.off("compass-change",this._compassListener),t.off("bitmap-create",this._bitmapListener)},methods:{compassRotate:function(t){this.readonly||(this.property.compassRotation=Yt(t),this.$editor.solution.drawing.compass.setRotation(Jt(this.property.compassRotation)))},bitmapRotate:function(t){this.negativeLocked||this.readonly||this.$editor.negativeRotate(Jt(Yt(t)))},rotationUpdate:function(t,e){this.property["".concat(t,"Rotation")]=e,this["".concat(t,"Rotate")](e)},changeFloor:function(t){this.$editor.feature.floor.select(t),this.updateProperty(),this.selectedFloor=t},changeFloorName:function(){var t=this,e=this.property.floorName;e?(this.$editor.feature.floor.setFloorName(e),this.floorOptions.find((function(e){return e.level===t.selectedFloor})).text=e):(this.$editor.feature.floor.setFloorName(""),this.property.floorName="",this.updateFloorOptions()),this.floorNameChangeState=!0,this.property.floorName=""},updateProperty:function(){var t=this.$editor.solution.drawing,e=this.$editor.feature.floor,n=t.negative.getAllBitmapList();this.property.length=e.length,this.property.compassRotation=Ht(t.compass.rotation),this.property.bitmapRotation=n[0]?Ht(n[0].rotation):0,this.selectedFloor=e.current,this.floorNameChangeState=null},updateFloorOptions:function(){var t=this.$editor.feature.floor.getData();this.floorOptions=t.list.map((function(t){return{level:t.level,text:t.name||"".concat(t.level+1,"层"),value:t.level}}))}}},Xt=Kt,qt=(n("4c00"),Object(A["a"])(Xt,Vt,Ut,!1,null,null,null)),Qt=qt.exports,Zt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"property-room"}},[n("div",{staticClass:"border-bottom px-3",staticStyle:{height:"45px","line-height":"45px"}},[t._v("功能间信息")]),n("div",{staticClass:"app-text-tiny px-3"},[n("div",{staticClass:"property-item"},[n("span",[t._v("房间类型：")]),n("b-form-select",{staticStyle:{width:"137px"},attrs:{options:t.options},on:{change:t.changeRoomType},model:{value:t.property.type,callback:function(e){t.$set(t.property,"type",e)},expression:"property.type"}})],1),n("div",{staticClass:"property-item"},[n("span",[t._v("房间名称：")]),n("b-form-input",{staticStyle:{width:"137px"},on:{change:t.changeRoomName},model:{value:t.property.name,callback:function(e){t.$set(t.property,"name",e)},expression:"property.name"}})],1)])])},te=[],ee=null,ne={name:"PropertyRoom",data:function(){return{property:{type:"",name:""}}},computed:{options:function(){var t=this.$spec.room.typeList.map((function(t){return{value:t,text:t}}));return t.unshift({value:"自定义",text:"自定义"}),t}},mounted:function(){this.init()},destroyed:function(){this.$editor.off("select",this._selectListener),this.$root.$off("room-property-change",this._changeListener)},methods:{init:function(){var t=this,e=this.$editor;ee=e.getSelected()[0],this.updateProperty(ee),e.on("select",this._selectListener=function(e){var n=e[0];n!==ee&&n.constructor===ee.constructor&&(ee=n,t.updateProperty(n))}),this.$root.$on("room-property-change",this._changeListener=function(){return t.updateProperty(ee)})},updateProperty:function(t){var e=t.type,n=t.name;Object.assign(this.property,{type:e||"自定义",name:n||""})},changeRoomType:function(){this.property.name=this.property.type,ee.setType(this.property.type),ee.setName(this.property.name),this.$root.$emit("room-property-change")},changeRoomName:function(){ee.setName(this.property.name||"未命名"),this.$root.$emit("room-property-change")}}},oe=ne,ie=(n("783f"),Object(A["a"])(oe,Zt,te,!1,null,null,null)),re=ie.exports,ae=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"property-wall"}},[n("div",{staticClass:"border-bottom px-3",staticStyle:{height:"45px","line-height":"45px"}},[t._v("基础参数（墙体）")]),n("div",{staticClass:"app-text-small px-3"},[n("div",[n("div",{staticStyle:{height:"40px","line-height":"40px"}},[t._v("墙体类型：")]),n("b-form-radio-group",{staticClass:"wall-type-radio",attrs:{options:t.typeOptions,buttons:"","button-variant":"outline-secondary"},on:{change:t.setType},model:{value:t.property.type,callback:function(e){t.$set(t.property,"type",e)},expression:"property.type"}})],1),n("div",[n("div",{staticStyle:{height:"40px","line-height":"40px"}},[t._v("墙体参数：")]),n("div",{staticClass:"d-flex align-items-center"},[n("div",{staticClass:"app-text-tiny",staticStyle:{width:"50px"}},[t._v("厚度")]),n("b-form-input",{staticClass:"mx-2",attrs:{min:"10",max:"1000",type:"range"},on:{update:t.setThickness},model:{value:t.property.thickness,callback:function(e){t.$set(t.property,"thickness",e)},expression:"property.thickness"}}),n("b-form-input",{staticClass:"mr-1",staticStyle:{width:"60px"},attrs:{min:"10",max:"1000"},on:{change:t.setThickness},model:{value:t.property.thickness,callback:function(e){t.$set(t.property,"thickness",e)},expression:"property.thickness"}}),n("span",[t._v("mm")])],1)])])])},se=[],le=null,ce={name:"PropertyWall",data:function(){return{property:{thickness:0,type:""}}},computed:{typeOptions:function(){var t=this.$spec.wall,e=t.typeSymbol,n=t.typeMap;return Object.keys(e).map((function(t){return{value:e[t],text:n[e[t]].label}}))}},mounted:function(){this.init()},destroyed:function(){this.$editor.off("select",this._selectListener)},methods:{init:function(){var t=this,e=this.$editor;le=e.getSelected()[0],this.updateProperty(le),e.on("select",this._selectListener=function(e){var n=e[0];n!==le&&n.constructor===le.constructor&&(le=n,t.updateProperty(n))})},updateProperty:function(t){var e=t.thickness,n=t.type;Object.assign(this.property,{thickness:e.toFixed(),type:n||"common"})},setType:function(t){le.setResource(this.$spec.wall.typeMap[t].resource)},setThickness:function(t){isNaN(Number(t))?this.property.thickness=100:le.thickness=Number(t)}}},ue=ce,pe=(n("687c"),Object(A["a"])(ue,ae,se,!1,null,null,null)),de=pe.exports,fe=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"property-hollow"}},[n("div",{staticClass:"border-bottom px-3",staticStyle:{height:"45px","line-height":"45px"}},[t._v(t._s("基础参数（"+t.typeName+"）"))]),n("div",{staticClass:"app-text-small px-3"},[n("div",{directives:[{name:"show",rawName:"v-show",value:t.hollowTypeOptions.length,expression:"hollowTypeOptions.length"}]},[n("div",{staticStyle:{height:"40px","line-height":"40px"}},[t._v(t._s(t.typeName+"类型："))]),n("b-form-radio-group",{staticClass:"type-radio",attrs:{options:t.hollowTypeOptions,buttons:"","button-variant":"outline-secondary"},on:{change:t.setType},model:{value:t.property.material,callback:function(e){t.$set(t.property,"material",e)},expression:"property.material"}})],1),n("div",[n("div",{staticStyle:{height:"40px","line-height":"40px"}},[t._v(t._s(t.typeName+"参数："))]),n("div",{staticClass:"d-flex align-items-center"},[n("div",{staticClass:"app-text-tiny",staticStyle:{width:"50px"}},[t._v("长度")]),n("b-form-input",{staticClass:"mx-2",attrs:{min:"100",max:t.maxWidth,type:"range"},on:{update:t.setWidth},model:{value:t.property.width,callback:function(e){t.$set(t.property,"width",e)},expression:"property.width"}}),n("b-form-input",{staticClass:"mr-1",staticStyle:{width:"60px"},attrs:{min:"100",max:"3000"},on:{change:t.setWidth},model:{value:t.property.width,callback:function(e){t.$set(t.property,"width",e)},expression:"property.width"}}),n("span",[t._v("mm")])],1)]),n("div",{staticClass:"py-3 d-flex flex-row-reverse"},[n("b-button",{attrs:{variant:"primary"},on:{click:t.setDefault}},[t._v("恢复默认")])],1)])])},he=[],me=n("0bd7"),ve=(n("99af"),n("caad"),n("2532"),Math),be=(ve.PI,[0,0,1,0]),ge=function(t,e,n,o){return be[0]=t,be[1]=e,be[2]=n,be[3]=o,be},ye=[0,0],we=function(t,e){return ye[0]=t,ye[1]=e,ye},xe=[0,0,0,0],ke=function(t,e,n,o){return xe[0]=t,xe[1]=e,xe[2]=n,xe[3]=o,xe},Oe=[0,0],Te=function(t,e){return Oe[0]=t,Oe[1]=e,Oe},Se=function(t,e,n,o){return Te(t+n,e+o)},je=function(t,e,n,o){return we(n-t,o-e)},_e=je,Ce=je,Le=function(t,e,n,o){return t*n+e*o},$e=function(t,e,n){return we(t*n,e*n)},De=function(t,e,n,o){return t*o-e*n},Re=n("a326"),We=function(t,e){return Re["b"].sqrt(Le(t,e,t,e))},Ee=function(t,e){return we(-e,t)},Ne=function(t,e){var n=We(t,e);return 0===n&&Re["a"].throwError("Zero Vector CAN NOT be normalized."),we(t/n,e/n)},Pe=function(t,e){return we(-t,-e)},Ae=function(t,e,n){var o=Re["b"].cos(n),i=Re["b"].sin(n);return we(t*o-e*i,t*i+e*o)},Fe=function(t,e,n,o){var i=Ne(n,o);return $e.apply(void 0,Object(me["a"])(i).concat([Le.apply(void 0,[t,e].concat(Object(me["a"])(i)))]))},Me=1e-6,Be=function(t){return t<Me&&t>-Me},Ie=function(t,e){var n=t-e;return n<Me&&n>-Me},ze=function(t,e){return t-e>Me},Ve=function(t,e){return t-e<-Me},Ue=function(t,e,n,o){return Ie(t,n)&&Ie(e,o)},Ge=function(t,e,n,o,r,a){return ze(De.apply(i,Object(me["a"])(je(n,o,r,a)).concat(Object(me["a"])(je(r,a,t,e)))),0)},He=function(t,e,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=je(o,r,t,e);return Se.apply(void 0,Object(me["a"])(Ae.apply(i,Object(me["a"])(a).concat([n]))).concat([o,r]))},Je=function(t,e,n,o,r,a){if(an(t,e,n,o))return Te(t,e);var s=je(t,e,n,o);return Be(De.apply(i,Object(me["a"])(s).concat([r,a])))?Te(n,o):Se.apply(void 0,[t,e].concat(Object(me["a"])(Fe.apply(i,Object(me["a"])(s).concat([r,a])))))},Ye=function(t,e,n,o){return We.apply(i,Object(me["a"])(je(t,e,n,o)))},Ke=function(t,e){for(var n=arguments.length,o=new Array(n>2?n-2:0),i=2;i<n;i++)o[i-2]=arguments[i];return Ye.apply(void 0,[t,e].concat(Object(me["a"])(Je.apply(void 0,[t,e].concat(o)))))},Xe=function(t,e,n,r){var a=_e(t,e,n,r),s=Ee.apply(i,Object(me["a"])(Ne.apply(i,Object(me["a"])(a)))),l=Le.apply(i,Object(me["a"])(s).concat([t,e])),c=Ve(l,0)?s:Pe.apply(i,Object(me["a"])(s));return ge.apply(o,[t,e].concat(Object(me["a"])(c)))},qe=[0,0,0],Qe=0,Ze=1,tn=2,en=function(t,e,n,o){return qe[Qe]=n,qe[Ze]=o,qe[tn]=Le(n,o,t,e),qe},nn=n("26a3"),on=function(t,e,n,o,i,r,a,s){var l=en(t,e,n,o),c=Object(nn["a"])(l,3),u=c[0],p=c[1],d=c[2],f=en(i,r,a,s),h=Object(nn["a"])(f,3),m=h[0],v=h[1],b=h[2],g=u*v-p*m,y=d*v-p*b,w=u*b-d*m;return Be(g)?null:Be(p)?Te(d/u,w/g):Be(v)?Te(b/m,w/g):Be(u)?Te(y/g,d/p):Be(m)?Te(y/g,b/v):Te(y/g,w/g)},rn=function(t,e,n,o,i,r){return Ke.apply(void 0,[t,e].concat(Object(me["a"])(Xe(n,o,i,r))))},an=function(t,e,n,o){return Ie(t,n)&&Ie(e,o)},sn=function(t,e){for(var n=!1,o=t.length,i=0,r=o-1;i<o;r=i++){var a=t[i],s=t[r],l=a.y>e.y!==s.y>e.y&&e.x<(e.y-a.y)/(s.y-a.y)*(s.x-a.x)+a.x;l&&(n=!n)}return n},ln=function(){for(var t=arguments.length/2,e=0,n=0;n<t;n++){var o=(n+1)%t;e+=De(2*n<0||arguments.length<=2*n?void 0:arguments[2*n],2*n+1<0||arguments.length<=2*n+1?void 0:arguments[2*n+1],2*o<0||arguments.length<=2*o?void 0:arguments[2*o],2*o+1<0||arguments.length<=2*o+1?void 0:arguments[2*o+1])}return e/2},cn=n("2d58"),un=n("ac84");var pn=n("0402"),dn=(n("aff5"),n("a434"),function(t,e,n,o){return i.length.apply(i,Object(me["a"])(i.fromBothPoint(t,e,n,o)))}),fn=function(t,e,n){var o=t.corner,i=t.back.corner,s=a.project.apply(a,[e,n].concat(Object(me["a"])(r.fromSegment(o.x,o.y,i.x,i.y))));return dn.apply(void 0,[o.x,o.y].concat(Object(me["a"])(s)))},hn=null,mn={name:"PropertyHollow",data:function(){return{property:{material:"",width:0},hollowTypeOptions:[],typeName:"",maxWidth:0,aheadTrap:null,behindTrap:null}},mounted:function(){this.init()},destroyed:function(){this.$editor.off("select",this._selectListener)},methods:{init:function(){var t=this,e=this.$editor;hn=e.getSelected()[0],this.updateProperty(hn),e.on("select",this._selectListener=function(e){var n=e[0];n!==hn&&n.constructor===hn.constructor&&(hn=n,t.updateProperty(n))})},updateProperty:function(t){var e=this.$spec.hollow,n=e.map,o=e.typeMap,i=t.width,r=t.resource,a=Object.keys(n).find((function(t){return n[t].resource===r})),s=Object.keys(o).find((function(t){return o[t].list.includes(a)}));Object.assign(this.property,{width:i.toFixed(),material:a}),this.hollowTypeOptions=o[s].list.map((function(t){return{value:t,text:n[t].label}})),this.typeName=o[s].label,this.updateTrap(t)},updateTrap:function(t){var e=t.surface,n=t.offset;if("virtual"!==e.name){var o=this.$editor.solution.drawing,i=e.back,r=o.windoor.getAllHollowList(),a=r.filter((function(n){return n!==t&&n!==t.$proxy&&n.surface===e})),s=r.filter((function(e){return e!==t&&e!==t.$proxy&&e.surface===i})),l=[],c=dn(e.corner.x,e.corner.y,i.corner.x,i.corner.y);a.forEach((function(t){var e=t.width,n=t.offset;l.push([n-e/2,n+e/2])})),s.forEach((function(t){var e=t.width,n=t.offset;l.push([c-(n+e/2),c-(n-e/2)])})),l.push([0,i.wall===i.next.wall?0:fn.apply(void 0,[e].concat(Object(me["a"])(e.origin)))]),l.push([e.wall===e.next.wall?c:c-fn.apply(void 0,[i].concat(Object(me["a"])(i.origin))),c]);var u=null,p=null;l.forEach((function(t){t[0]>n&&(null===p||t[1]<p[0])&&(p=t),t[1]<n&&(null===u||t[0]>u[1])&&(u=t)})),this.maxWidth=(p[0]-u[1]).toFixed(),this.aheadTrap=u,this.behindTrap=p}else this.maxWidth=1e4},setType:function(t){hn.setResource(this.$spec.hollow.map[t].resource)},setWidth:function(t){var e=hn,n=e.offset,o=e.surface;if(isNaN(Number(t)))return this.property.width=100,void(hn.width=100);if("virtual"!==o.name){if(Number(t)>this.maxWidth)return this.property.width=this.maxWidth,void(hn.width=Number(this.maxWidth));var i=n-Number(t)/2,r=n+Number(t)/2;hn.width=Number(t),i<this.aheadTrap[1]&&(hn.offset=n+(this.aheadTrap[1]-i)),r>this.behindTrap[0]&&(hn.offset=n-(r-this.behindTrap[0]))}else hn.width=Number(t)},setDefault:function(){hn.setDefaultWidth()}}},vn=mn,bn=(n("14ac"),Object(A["a"])(vn,fe,he,!1,null,null,null)),gn=bn.exports,yn={name:"Property",components:{Floor:Qt},data:function(){return{activeTool:null,contentVisible:!0}},mounted:function(){this.init()},destroyed:function(){var t=this.$editor;t.off("select",this._selectListener),t.off("select",this._unselectListener)},methods:{init:function(){var t=this,e=this.$editor,n={EditorWall:de,EditorRoom:re,EditorHollow:gn};e.on("select",this._selectListener=function(e){t.activeTool=n[e[0].className],t.contentVisible||t.toggleConetnt()}),e.on("unselect",this._unselectListener=function(){t.activeTool=null})},toggleConetnt:function(){this.contentVisible=!this.contentVisible,this.$root.$emit("drawing-resize")}}},wn=yn,xn=(n("f709"),Object(A["a"])(wn,It,zt,!1,null,null,null)),kn=xn.exports,On=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"property-card"}},[n(t.activeCard,{tag:"component",staticClass:"card-component app-text-tiny"})],1)},Tn=[],Sn=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("span",{staticClass:"mr-2",staticStyle:{width:"25px"}},[t._v("类型")]),n("b-form-select",{staticClass:"mr-2",staticStyle:{width:"100px"},attrs:{options:t.options},on:{change:t.changeRoomType},model:{value:t.property.type,callback:function(e){t.$set(t.property,"type",e)},expression:"property.type"}}),n("b-form-input",{staticStyle:{width:"100px"},attrs:{placeholder:"房间名称"},on:{change:t.changeRoomName},model:{value:t.property.name,callback:function(e){t.$set(t.property,"name",e)},expression:"property.name"}})],1)},jn=[],_n=null,Cn={name:"PropertyCardRoom",data:function(){return{property:{type:"",name:""}}},computed:{options:function(){var t=this.$spec.room.typeList.map((function(t){return{value:t,text:t}}));return t.unshift({value:"自定义",text:"自定义"}),t}},mounted:function(){this.init()},destroyed:function(){this.$editor.off("select",this._selectListener),this.$root.$off("room-property-change",this._changeListener)},methods:{init:function(){var t=this,e=this.$editor;_n=e.getSelected()[0],this.updateProperty(_n),e.on("select",this._selectListener=function(e){var n=e[0];n!==_n&&n.constructor===_n.constructor&&(_n=n,t.updateProperty(n))}),this.$root.$on("room-property-change",this._changeListener=function(){return t.updateProperty(_n)})},updateProperty:function(t){var e=t.type,n=t.name;Object.assign(this.property,{type:e||"自定义",name:n||""})},changeRoomType:function(){this.property.name=this.property.type,_n.setType(this.property.type),_n.setName(this.property.name),this.$root.$emit("room-property-change")},changeRoomName:function(){_n.setName(this.property.name||"未命名"),this.$root.$emit("room-property-change")}}},Ln=Cn,$n=Object(A["a"])(Ln,Sn,jn,!1,null,null,null),Dn=$n.exports,Rn=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",t._l(t.toolList,(function(e){return n("b-button",{key:e,attrs:{variant:"outline-secondary",title:t.toolMap[e].label},on:{click:t.buttonMethods[e]}},[n("span",{staticStyle:{height:"25px","line-height":"25px"}},[n("b-img",{staticClass:"w-100",attrs:{src:t.toolMap[e].image.base}})],1)])})),1)},Wn=[],En=(n("ac1f"),n("1276"),null),Nn={name:"PropertyCardWall",computed:{toolMap:function(){return this.$spec.wall.toolMap},toolList:function(){var t=this.$spec.wall.toolSymbol;return[t.split,t.delete]},buttonMethods:function(){var t,e=this,n=this.$spec.wall.toolSymbol;return t={},Object(R["a"])(t,n.split,(function(){return e.split()})),Object(R["a"])(t,n.delete,(function(){return e.delete()})),t}},mounted:function(){this.init()},destroyed:function(){this.$editor.off("select",this._selectListener)},methods:{init:function(){var t=this.$editor;En=t.getSelected()[0],t.on("select",this._selectListener=function(t){var e=t[0];e!==En&&e.constructor===En.constructor&&(En=e)})},split:function(){En.split()},delete:function(){this.$editor.delete()}}},Pn=Nn,An=Object(A["a"])(Pn,Rn,Wn,!1,null,null,null),Fn=An.exports,Mn=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",t._l(t.toolList,(function(e){return n("b-button",{directives:[{name:"show",rawName:"v-show",value:t.shownMap[e],expression:"shownMap[symbol]"}],key:e,attrs:{variant:"outline-secondary",title:t.toolMap[e].label},on:{click:t.buttonMethods[e]}},[n("span",{staticStyle:{height:"25px","line-height":"25px"}},[n("b-img",{staticClass:"w-100",attrs:{src:t.toolMap[e].image.base}})],1)])})),1)},Bn=[],In=null,zn={name:"PropertyCardWall",data:function(){return{entranceShow:!0}},computed:{toolMap:function(){return this.$spec.hollow.toolMap},toolList:function(){var t=this.$spec.hollow.toolSymbol;return[t.entrance,t.flipWall,t.flip,t.delete]},shownMap:function(){var t=this.$spec.hollow.toolSymbol,e={};return Object.keys(t).forEach((function(t){return e[t]=!0})),Object(W["a"])(Object(W["a"])({},e),{},Object(R["a"])({},t.entrance,this.entranceShow))},buttonMethods:function(){var t,e=this,n=this.$spec.hollow.toolSymbol;return t={},Object(R["a"])(t,n.entrance,(function(){return e.setEntrance()})),Object(R["a"])(t,n.flipWall,(function(){return e.changeSurface()})),Object(R["a"])(t,n.flip,(function(){return e.flip()})),Object(R["a"])(t,n.delete,(function(){return e.delete()})),t}},mounted:function(){this.init()},destroyed:function(){this.$editor.off("select",this._selectListener)},methods:{init:function(){var t=this,e=this.$editor;In=e.getSelected()[0],this.updateToolList(In),e.on("select",this._selectListener=function(e){var n=e[0];n!==In&&n.constructor===In.constructor&&(In=n,t.updateToolList(n))})},getEntranceShow:function(){return this.entranceShow},updateToolList:function(t){var e=t.resource,n=this.$spec.hollow,o=n.typeSymbol,i=n.typeMap,r=n.map,a=Object.keys(r).find((function(t){return r[t].resource===e}));this.entranceShow=i[o.door].list.includes(a)},setEntrance:function(){In.setEntrance()},changeSurface:function(){In.changeSurface()},flip:function(){In.flip()},delete:function(){In.arrow&&In.arrow.remove(),this.$editor.delete()}}},Vn=zn,Un=Object(A["a"])(Vn,Mn,Bn,!1,null,null,null),Gn=Un.exports,Hn={name:"PropertyCard",data:function(){return{activeCard:null,position:[0,0]}},mounted:function(){this.init()},destroyed:function(){var t=this.$editor;t.off("select",this._selectListener),t.off("unselect",this._unselectListener),document.removeEventListener("mousemove",this._moveListener)},methods:{init:function(){var t=this,e=this.$editor,n=document.getElementById("property-card"),o={EditorWall:Fn,EditorRoom:Dn,EditorHollow:Gn};e.on("select",this._selectListener=function(e){t.activeCard=o[e[0].className],n.style.left="".concat(t.position[0]+30,"px"),n.style.top="".concat(t.position[1]-70,"px")}),e.on("unselect",this._unselectListener=function(){t.activeCard=null}),document.addEventListener("mousemove",this._moveListener=function(e){t.position[0]=e.layerX,t.position[1]=e.layerY})}}},Jn=Hn,Yn=(n("507d"),Object(A["a"])(Jn,On,Tn,!1,null,null,null)),Kn=Yn.exports,Xn=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"px-4",attrs:{id:"viewport"}},[n("div",{staticClass:"mr-4",staticStyle:{width:"40px",cursor:"pointer"},on:{click:t.negativeBackToCenter}},[n("b-img",{staticClass:"h-100 w-100",attrs:{src:"img/ViewReset.svg"}})],1),n("span",{staticStyle:{width:"25px",height:"30px","line-height":"25px",cursor:"pointer"},on:{click:t.zoomOut}},[n("b-img",{staticClass:"w-100 h-100",attrs:{src:"img/Dash.svg"}})],1),n("b-form-input",{staticClass:"mx-2",attrs:{type:"range",min:"1",max:"100",disabled:t.readonly},on:{update:t.changeScale},model:{value:t.inputScale,callback:function(e){t.inputScale=e},expression:"inputScale"}}),n("span",{staticStyle:{width:"25px",height:"30px","line-height":"25px",cursor:"pointer"},on:{click:t.zoomIn}},[n("b-img",{staticClass:"w-100 h-100",attrs:{src:"img/Plus.svg"}})],1)],1)},qn=[],Qn=1,Zn=200,to={name:"Viewport",data:function(){return{inputScale:0,inputScaleClone:0,readonly:!0}},computed:{scale:function(){return 100-this.inputScale}},mounted:function(){var t=this,e=this.$editor.solution.drawing;this.inputScale=100-e.scale,this._interval=setInterval((function(){t.inputScaleClone=100-e.scale,t.inputScaleClone!==t.inputScale&&(t.inputScale=t.inputScaleClone)}),Zn),this.$root.$on("readonly",(function(e){return t.readonly=e}))},destroyed:function(){clearInterval(this._interval)},methods:{negativeBackToCenter:function(){this.readonly||this.$editor.feature.drawing.negativeBackToCenter()},changeScale:function(){this.$editor.solution.drawing.setScale(this.scale)},zoomOut:function(){1==this.inputScale||this.readonly||(this.inputScale=Number(this.inputScale)-Qn,this.$editor.solution.drawing.setScale(this.scale))},zoomIn:function(){100==this.inputScale||this.readonly||(this.inputScale=Number(this.inputScale)+Qn,this.$editor.solution.drawing.setScale(this.scale))}}},eo=to,no=(n("95f6"),Object(A["a"])(eo,Xn,qn,!1,null,null,null)),oo=no.exports,io=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"visible"}},[n("b-dropdown",{attrs:{"no-caret":"",dropup:"",size:"sm",variant:"link",disabled:t.readonly},scopedSlots:t._u([{key:"button-content",fn:function(){return[n("b-img",{attrs:{src:"img/Eye.svg"}})]},proxy:!0}])},[n("b-dropdown-group",{attrs:{header:"勾选隐藏项","header-classes":"visible-dropdown-header"}},[n("b-dropdown-form",{staticClass:"visible-dropdown-form"},[n("b-form-checkbox",{on:{change:t.changeRoomNameVisible},model:{value:t.visible.roomName,callback:function(e){t.$set(t.visible,"roomName",e)},expression:"visible.roomName"}},[t._v("房间名")]),n("b-form-checkbox",{on:{change:t.changeRoomAreaVisible},model:{value:t.visible.roomArea,callback:function(e){t.$set(t.visible,"roomArea",e)},expression:"visible.roomArea"}},[t._v("面积")]),n("b-form-checkbox",{on:{change:t.changeSizeVisible},model:{value:t.visible.size,callback:function(e){t.$set(t.visible,"size",e)},expression:"visible.size"}},[t._v("尺寸标注")])],1)],1)],1)],1)},ro=[],ao={name:"Visible",data:function(){return{visible:{roomName:!1,roomArea:!1,size:!1},readonly:!0}},mounted:function(){var t=this;this.$editor.setRoomAreaShow(!0),this.$root.$on("readonly",(function(e){return t.readonly=e}))},methods:{changeRoomNameVisible:function(t){this.$editor.setRoomNameShow(!t)},changeRoomAreaVisible:function(t){this.$editor.setRoomAreaShow(!t)},changeSizeVisible:function(t){this.$editor.setDimensionShow(!t)}}},so=ao,lo=(n("40e4"),Object(A["a"])(so,io,ro,!1,null,null,null)),co=lo.exports,uo=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{directives:[{name:"show",rawName:"v-show",value:t.visiable,expression:"visiable"}],attrs:{id:"check"}},[n("b-card",{directives:[{name:"show",rawName:"v-show",value:t.modalVisiable,expression:"modalVisiable"}],staticStyle:{width:"330px"},attrs:{"no-body":"","header-class":"p-2"},scopedSlots:t._u([{key:"header",fn:function(){return[n("div",{staticClass:"d-flex justify-content-between"},[n("div",[t._v("智能检测结果")]),n("b-button",{staticClass:"p-0 border-0",attrs:{variant:"outline-secondary"},on:{click:t.toggleVisiable}},[n("b-icon",{attrs:{icon:"chevron-down"}})],1)],1)]},proxy:!0}])},[n("div",{staticClass:"d-flex align-items-center py-3 mb-3",staticStyle:{"border-bottom":"1px dotted #CCCCCC"}},[n("div",{staticClass:"sign-warning app-text-tiny"},[t._v("警告")]),n("div",{staticStyle:{width:"210px"}},[n("div",{staticClass:"app-text-small font-weight-bold"},[t._v("未设置入户门")]),n("div",{staticClass:"app-text-tiny"},[t._v("请设置一个入户门，设置为入户门，多楼层注意选择正确的入户门")])]),n("b-button",{staticClass:"app-text-tiny ml-1",attrs:{variant:"outline-secondary"},on:{click:t.save}},[t._v("忽略")])],1)]),n("b-button",{directives:[{name:"show",rawName:"v-show",value:!t.modalVisiable&&!t.hasEntrance,expression:"!modalVisiable && !hasEntrance"}],staticClass:"p-0 border-0",attrs:{variant:"outline-secondary"},on:{click:t.toggleVisiable}},[n("b-img",{attrs:{src:"img/Duty.svg"}})],1),n("b-img",{directives:[{name:"show",rawName:"v-show",value:t.hasEntrance,expression:"hasEntrance"}],attrs:{src:"img/Signs.svg"}})],1)},po=[],fo={data:function(){return{visiable:!1,hasEntrance:!1,modalVisiable:!1}},mounted:function(){this.init()},destroyed:function(){this.$editor.off("entrance",this._listener)},methods:{init:function(){var t=this;this.$editor.on("entrance",this._listener=function(e){t.hasEntrance=e,e&&(t.modalVisiable=!1)}),this.$root.$on("save",(function(){t.hasEntrance||(t.visiable=!0,t.modalVisiable=!0)}))},toggleVisiable:function(){this.modalVisiable=!this.modalVisiable},save:function(){this.$editor.feature.document.save()}}},ho=fo,mo=(n("78a9"),Object(A["a"])(ho,uo,po,!1,null,null,null)),vo=mo.exports,bo=3e4,go={name:"",components:{AppMenu:M,AppToolBar:bt,AppToolSetting:Bt,AppProperty:kn,AppPropertyCard:Kn,appViewport:oo,appVisible:co,appCheck:vo},mounted:function(){var t=this,e=this.$editor,n=e.solution.drawing;n.mount(this.$refs.drawing),e.feature.drawing.originBackToCenter(),n.options.style.backgroundColor=16711422,n.structure.options.corner.style.hover.color=4235007,n.structure.options.wall.style.color=8355711,n.structure.options.wall.midline.show=!1,n.grid.options.rectangular.style.lineWidth=.25,n.compass.element.setNorthPointColor(4235007),n.compass.element.setSouthPointColor(14540253),this.$root.$on("drawing-resize",(function(){n.resize()})),e.on("opened",(function(n){n?(e.solution.drawing.compass.lock(),t.$root.$emit("readonly",!0)):t.$root.$emit("readonly",!1)}))},methods:{useTransformerFromSelector:function(){var t=this.$editor.solution,e=t.tool,n=t.drawing;e.activated===e.symbol.SELECTOR&&(e.openTransformer(),n.focusing instanceof this.$editor.Element.Hollow&&n.hammer.adjuster.pick())},autoCheck:function(){var t=this;setTimeout((function(){t.checkState(),t.autoCheck()}),bo)},checkState:function(){var t=this,e=this.$editor;this.$e100.updateStatus().then((function(n){null===n?(e.feature.tool.closeAll(),e.solution.drawing.compass.lock()):e.solution.drawing.compass.unlock(),t.$root.$emit("readonly",!n)}))}}},yo=go,wo=Object(A["a"])(yo,C,L,!1,null,null,null),xo=wo.exports,ko=n("c20e"),Oo=n("a007"),To=n("e3fc"),So=(n("dca8"),n("3ca3"),n("10d1"),n("ddb0"),n("7d94")),jo=function(t){Object(Oo["a"])(n,t);var e=Object(To["a"])(n);function n(){return Object(un["a"])(this,n),e.apply(this,arguments)}return Object(cn["a"])(n)}(So["a"].Emitter),_o=function(t){return t/1e3},Co=function(){function t(){Object(un["a"])(this,t),this.width=0,this.height=0,this.center=[0,0],this.worldOrigin=[0,0],this.referenceY=0,this.rotation=0}return Object(cn["a"])(t,[{key:"bitmapUvOrigin",get:function(){var t=this.width,e=this.height,n=this.center,o=Object(nn["a"])(n,2),i=o[0],r=o[1];return[i-t/2,r-e/2]}},{key:"worldOriginGeometry",get:function(){return this.bitmapUvToGeometry.apply(this,Object(me["a"])(this.worldOrigin))}},{key:"setWidth",value:function(t){this.width=t}},{key:"setHeight",value:function(t){this.height=t}},{key:"setRotation",value:function(t){this.rotation=t}},{key:"setReferenceY",value:function(t){this.referenceY=t}},{key:"setCenter",value:function(t,e){this.center=[t,e]}},{key:"setWorldOrigin",value:function(t,e){this.worldOrigin=[t,e]}},{key:"bitmapUvToGeometry",value:function(t,e){var n=this.width,o=this.height,i=this.rotation,r=this.center,s=this.bitmapUvOrigin,l=Object(nn["a"])(r,2),c=l[0],u=l[1],p=Object(nn["a"])(s,2),d=p[0],f=p[1];return Object(me["a"])(a.rotate(d+n*t,f+o*e,-i,c,u))}},{key:"bitmapUvTo3D",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.referenceY,o=Object(nn["a"])(this.worldOriginGeometry,2),i=o[0],r=o[1],a=this.bitmapUvToGeometry(t,e),s=Object(nn["a"])(a,2),l=s[0],c=s[1];return[_o(l-i),n,_o(r-c)]}},{key:"geometryTo3D",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.referenceY,o=Object(nn["a"])(this.worldOriginGeometry,2),i=o[0],r=o[1];return[_o(t-i),n,_o(r-e)]}},{key:"geometryToCaptureUv",value:function(t,e,n,o,i,r){return[(i-n)/t,(r-o)/e]}},{key:"bitmapUvToCaptureUv",value:function(t,e,n,o,i,r){var a=this.bitmapUvToGeometry(i,r),s=Object(nn["a"])(a,2),l=s[0],c=s[1];return[(l-n)/t,(c-o)/e]}}]),t}(),Lo=(n("c740"),n("9224")),$o=new Co,Do=function(t){return(t/1e6).toFixed(2)},Ro=function(t,e,n,o,i,r){return((n-t)*(r-e)-(i-t)*(o-e))/2},Wo=function(t){if(!(t.length<3)){for(var e=t[0],n=0,o=0,i=0,r=t[1],a=2;a<t.length;a++){var s=t[a],l=Ro.apply(void 0,Object(me["a"])(e).concat(Object(me["a"])(r),Object(me["a"])(s)));i+=l,n+=(e[0]+r[0]+s[0])*l,o+=(e[1]+r[1]+s[1])*l,r=s}return[n/i/3,o/i/3]}},Eo=function(t,e,n){var o=Po(t),i=Ao(t,e,n),r=Fo(t,e,n);return{info:o,entrance:i,floors:r}},No=function(t,e){var n=t.find((function(t){return t.info.flooridx===e.level})),o=n.info,i=o.width,r=o.height,a=o.ratio,s=o.floor_height,l=o.center_point_coordinates;$o.setWidth(i/a),$o.setHeight(r/a),$o.setRotation(e.bitmap.rotation),$o.setCenter.apply($o,Object(me["a"])(e.bitmap.position)),$o.setReferenceY(s),$o.setWorldOrigin(l.u,l.v)},Po=function(t){var e=t.floor.list[0].bitmap.rotation;return{version:Lo["a"],name:t.name,room:"1室",hall:"1厅",bathroom:"1卫",rotation:e,totalfloor:t.floor.list.length}},Ao=function(t,e,n){var o=-1,r=t.floor.list.findIndex((function(t){return!!t.hollowList&&(o=t.hollowList.findIndex((function(t){return t.entrance})),-1!==o)}));if(-1===r)return{exist_entrance:!1,position:null,uv:null,normal_vector:null};var a=t.floor.list[r],s=n[r],l=a.drawing,c=l.cornerList,u=l.hollowList,p=u[o],d=p.surface,f=p.offset,h=c[d[0]],m=c[d[1]],v=Object(me["a"])(i.normalize.apply(i,Object(me["a"])(i.from.apply(i,Object(me["a"])(h).concat(Object(me["a"])(m)))))),b=Object(me["a"])(i.multiply.apply(i,Object(me["a"])(v).concat([f]))),g=Object(me["a"])(i.rotate90.apply(i,Object(me["a"])(b))),y=[b[0]+h[0],b[1]+h[1]];return No(e,a),{exist_entrance:!0,position:$o.geometryTo3D.apply($o,y),uv:$o.geometryToCaptureUv.apply($o,[s.width,s.height,s.x,s.y-s.height].concat(y)),normal_vector:$o.geometryTo3D.apply($o,Object(me["a"])(g).concat([0]))}},Fo=function(t,e,n){var o=t.floor.list;return o.map((function(t,o){var i=e.find((function(e){return e.info.flooridx===t.level})),r=i.info,a=i.locations,l=n[o],c=l||{},u=c.width,p=c.height,d=c.x,f=c.y,h=c.compute,m="floor".concat(o>8?o+1:"0"+(o+1));No(e,t);var v={size:l?{width:u/1e3,height:p/1e3}:null,name:t.name,flooridx:r.flooridx,area:0};h&&(v.area=Do(h.rooms.map((function(t){return t.area})).reduce((function(t,e){return t+e}))));var b={exist_plan:null!==l,plan_position:l?[{position:$o.geometryTo3D(d,f),uv:[0,1]},{position:$o.geometryTo3D(d+u,f),uv:[1,1]},{position:$o.geometryTo3D(d+u,f-p),uv:[1,0]},{position:$o.geometryTo3D(d,f-p),uv:[0,0]}]:[]},g=t.drawing.roomList.map((function(e,n){var o=t.roomList[n],i=e.cornerList.map((function(e){var n=t.drawing.cornerList[e];return{x:n[0],y:n[1]}})),l="".concat(m,"_room").concat(n>8?n+1:"0"+(n+1)),c=h.rooms[n];a.forEach((function(t){var e=t.uv,n=e.u,o=e.v;t.position=$o.bitmapUvToGeometry(n,o)}));var v={position:$o.geometryTo3D.apply($o,Object(me["a"])(o.labelPosition)),uv:$o.geometryToCaptureUv.apply($o,[u,p,d,f-p].concat(Object(me["a"])(o.labelPosition)))},b=a.filter((function(t){var e=Object(nn["a"])(t.position,2),n=e[0],o=e[1];return s.containsPoint(i,{x:n,y:o})})).map((function(t){return t.locationid})),g=c.originList.map((function(t){return{position:$o.geometryTo3D.apply($o,Object(me["a"])(t)),uv:$o.geometryToCaptureUv.apply($o,[u,p,d,f-p].concat(Object(me["a"])(t)))}})),y=c.connectedRooms.map((function(t){return"".concat(m,"_room").concat(t>8?t+1:"0"+(t+1))}));return{id:l,info:{roomidx:n,name:o.name,area:Do(c.area),roomHeight:r.floor_height,default_position:"",room_center_point:v,rotation:"",direction:"",connected_rooms:y,vertex_position:g,locations:b}}}));return{id:m,info:v,plan:b,rooms:g}}))},Mo=new Co;function Bo(){return{name:"untitled",floor:{base:0,list:[]}}}var Io,zo,Vo,Uo,Go,Ho,Jo=function(t){var e=t.editor,n=t.accessor,o={name:""};function i(){var t=Bo();return t.floor=e.feature.floor.getData(),t.name=o.name,t}function r(t){o.name=t.name,e.feature.floor.setData(t.floor)}return{get name(){return o.name},open:function(){return Object(T["a"])(Object(O["a"])().mark((function t(){var o,i,a,s;return Object(O["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,n.open();case 2:o=t.sent,i=o.drawing,a=o.model,s=o.status,r(i),e.data.model=a,e.emit("opened",!s);case 9:case"end":return t.stop()}}),t)})))()},save:function(){var t=arguments;return Object(T["a"])(Object(O["a"])().mark((function o(){var r,a,s,l,c,u;return Object(O["a"])().wrap((function(o){while(1)switch(o.prev=o.next){case 0:return r=!(t.length>0&&void 0!==t[0])||t[0],r&&e.feature.floor.updateFloorData(),a=i(),s=new FormData,l=e.data.model,o.next=7,e.feature.screenshoter.screenshot();case 7:return c=o.sent,u=Eo(a,l,c),a.floor.list.forEach((function(t,e){var n=t.level,o=l.find((function(t){return t.info.flooridx===n})),i=o.info,r=i.width,a=i.height,u=i.ratio,p=i.floor_height,d=i.center_point_coordinates,f=c[e];if(Mo.setWidth(r/u),Mo.setHeight(a/u),Mo.setRotation(t.bitmap.rotation),Mo.setCenter.apply(Mo,Object(me["a"])(t.bitmap.position)),Mo.setReferenceY(p),Mo.setWorldOrigin(d.u,d.v),f){var h=new Blob([f.base64.split(",")[1]],{type:"image/png"});s.append("screenshot",h,"screenshot_".concat(n,".png"))}})),s.append("drawing",JSON.stringify(a)),s.append("map",JSON.stringify(u)),o.next=14,n.save(s);case 14:case"end":return o.stop()}}),o)})))()}}},Yo=(n("8ba4"),n("4e82"),n("fb6a"),function(t){if(!Number.isInteger(t))throw new TypeError("Invalid base, an integer expected.")}),Ko=function(t){if(Yo(t.base),!Array.isArray(t.list))throw new TypeError("Invalid lsit, an Array expected.")},Xo=function(t){var e=t.editor,n=null,o={base:null,list:[]},i=function(t){if(!o.list.some((function(e){return e.level===t})))throw new Error("Can NOT found a floor level=".concat(t))},r=function(){o.base=null,o.list=[]},a=function(t){return o.list.find((function(e){return e.level===t}))},s={get length(){return o.list.length},get base(){return o.base},get current(){return n},set current(t){n=t},get currentFloor(){return a(n)},select:function(t){if(Yo(t),i(t),null!==n){var o=a(n);Object.assign(o,e.serialize())}n=t,this.clear(!0),e.deserialize(a(t))},getData:function(){return o},setData:function(t){Ko(t),r(),t.list.slice(0).sort((function(t,e){return t.level-e.level})).forEach((function(t){return o.list.push(t)})),o.base=t.base,s.select(t.base),e.emit("floor-set")},setFloorName:function(t){a(n).name=t},clear:function(t){var n=e.solution.drawing,o=n.structure.getAllCornerList(),i=n.windoor.getAllHollowList(),r=n.entrance.getAllArrowList(),a=n.negative.getAllBitmapList();e.feature.tool.openDefault();try{i.forEach((function(t){return t.remove()})),o.forEach((function(t){return t.remove()})),r.forEach((function(t){return t.remove()})),t&&a.forEach((function(t){return t.remove()}))}catch(s){console.log(s),this.save()}},updateFloorData:function(){null!==n&&Object.assign(a(n),e.serialize())}};return s},qo=function(t){var e=t.editor,n=e.solution.tool,o={get activated(){return n.activated},get symbol(){return n.symbol},openDefault:function(){n.openDefault(),e.solution.drawing.common.selector.drop()},openSelector:function(){n.openSelector()},openTransformer:function(){n.openTransformer()},openBuilder:function(){n.openWallBuilder()},openChamber:function(){n.openChamber()},closeAll:function(){n.closeAllTool()}};return o},Qo=function(){function t(e,n){Object(un["a"])(this,t),this.wall=e,this.editor=n,this.className="EditorWall",this.resource=1}return Object(cn["a"])(t,[{key:"thisSurface",get:function(){return this.wall.thisSurface}},{key:"thatSurface",get:function(){return this.wall.thatSurface}},{key:"thickness",get:function(){return this.wall.thickness},set:function(t){this.wall.thickness=t}},{key:"color",set:function(t){this.wall.color=t}},{key:"setResource",value:function(t){this.resource=t,this.editor.feature.resource.get(t).apply(this.wall)}},{key:"split",value:function(){var t=this.editor.solution.drawing,e=this.wall,n=e.thisCorner,o=e.thatCorner,i=e.thickness,r=t.structure.createCorner((n.x+o.x)/2,(n.y+o.y)/2);t.common.selector.drop(),this.wall.removeSimple();var a=this.editor.map.get(t.structure.createWall(n,r)),s=this.editor.map.get(t.structure.createWall(r,o));a.thickness=i,s.thickness=i,a.setResource(this.resource),s.setResource(this.resource)}}]),t}(),Zo=function(){function t(e,n){Object(un["a"])(this,t),this.room=e,this.editor=n,this.className="EditorRoom",this.type="",this.name="",this.labelPosition=null}return Object(cn["a"])(t,[{key:"area",get:function(){return this.room.area}},{key:"label",get:function(){var t=this;return this.editor.solution.drawing.label.getAllLabelTextList().find((function(e){return e.room===t.room}))||null}},{key:"setType",value:function(t){this.type=t}},{key:"setName",value:function(t){if(this.name=t,this.label){var e="";this.editor.state.roomNameShow&&(e+=t),this.editor.state.roomAreaShow&&(e+="".concat(e.length>0?"\n":"","约").concat(Do(this.area),"m²")),this.label.setText(e)}}},{key:"getLabelPosition",value:function(){return Object(me["a"])(this.labelPosition)}},{key:"setLabelPosition",value:function(t,e){this.labelPosition=[t,e],this.label&&this.label.setPosition(t,e)}},{key:"updateLabelPosition",value:function(){var t=this.room.getOuterSurfaceList().map((function(t){return[t.corner.x,t.corner.y]}));this.setLabelPosition.apply(this,Object(me["a"])(Wo(t)))}},{key:"updateLabelText",value:function(){this.setName(this.name)}}]),t}(),ti=function(t,e){var n=t.x-e.x,o=t.y-e.y;return Math.pow(n*n+o*o,.5)},ei=function(){function t(e,n){Object(un["a"])(this,t),this.hollow=e,this.editor=n,this.className="EditorHollow",this.resource=100}return Object(cn["a"])(t,[{key:"width",get:function(){return this.hollow.width},set:function(t){this.hollow.setWidth(t)}},{key:"materialName",get:function(){return this.hollow.materialName}},{key:"surface",get:function(){return this.hollow.surface}},{key:"offset",get:function(){return this.hollow.offset},set:function(t){this.hollow.setOffset(t)}},{key:"arrow",get:function(){var t=this,e=this.editor.solution.drawing.entrance.getAllArrowList().find((function(e){return e.hollow===t.hollow}));return e||null}},{key:"setResource",value:function(t){this.resource=t,this.editor.feature.resource.get(t).apply(this.hollow)}},{key:"setDefaultWidth",value:function(){this.hollow.setWidth(this.hollow.defaultWidth)}},{key:"flip",value:function(){this.hollow.flip()}},{key:"setEntrance",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=this.editor.solution.drawing,n=e.entrance.getAllArrowList();if(this.arrow)return this.arrow.remove(),void this.editor.emit("entrance",!1);n.forEach((function(t){return t.remove()})),this.editor.feature.floor.getData().list.forEach((function(t){var e=t.hollowList;e&&e.length&&e.forEach((function(t){return t.entrance=null}))}));var o=e.entrance.createArrow(this.hollow);t&&o.flip(),this.editor.emit("entrance",!0)}},{key:"changeSurface",value:function(){var t=ti(this.surface.corner,this.surface.back.corner)-this.offset;this.hollow.setSurface(this.surface.back),this.hollow.setOffset(t)}}]),t}(),ni=function(t){var e,n,o,i,r=t.editor,a=t.Element,s=t.Tool,l=r.solution.drawing,c=l.bricklayer.Builder,u=l.bricklayer.Chamber,p=!1,d=(e={},Object(R["a"])(e,s.Bricklayer.Builder.PICKUP_FROM,(function(t){0===t&&c.pick()})),Object(R["a"])(e,s.Bricklayer.Builder.PICKUP_TO,(function(t){0===t&&c.build().pick().pick()})),e),f=(n={},Object(R["a"])(n,s.Bricklayer.Builder.PICKUP_FROM,(function(t){2!==t||p||r.feature.tool.openDefault()})),Object(R["a"])(n,s.Bricklayer.Builder.PICKUP_TO,(function(t){2!==t||p||c.drop()})),n),h=(o={},Object(R["a"])(o,s.Bricklayer.Chamber.PICKUP_FROM,(function(t){0===t&&u.pick()})),Object(R["a"])(o,s.Bricklayer.Chamber.PICKUP_TO,(function(t){0===t&&u.build().pick()})),o),m=(i={},Object(R["a"])(i,s.Bricklayer.Chamber.PICKUP_FROM,(function(t){2!==t||p||r.feature.tool.openDefault()})),Object(R["a"])(i,s.Bricklayer.Chamber.PICKUP_TO,(function(t){2!==t||p||u.drop()})),i),v=function(t){0===t&&l.common.selectorAction(l.focusing)},b=function(t){if(2!==t||p||r.feature.tool.openDefault(),0===t){var e=l.focusing;l.common.transformerAction(e),e instanceof a.Hollow?l.hammer.adjuster.pick():l.hammer.adjuster.drop(),e instanceof a.LabelText?l.label.LabelTransformer.pick():l.label.LabelTransformer.drop()}};l.on("pointerdown",(function(t){if(2===t.button){var e=function(){return p=!0},n=function t(){l.off("pointermove",e),window.removeEventListener("mouseup",t)};p=!1,l.on("pointermove",e),window.addEventListener("mouseup",n)}c.$state!==s.Ready&&d[c.$state](t.button),u.$state!==s.Ready&&h[u.$state](t.button)})),l.on("pointerup",(function(t){r.feature.tool.activated===r.feature.tool.symbol.SELECTOR&&v(t.button),r.feature.tool.activated===r.feature.tool.symbol.TRANSFORMER&&b(t.button),u.$state!==s.Ready&&m[u.$state](t.button),c.$state!==s.Ready&&f[c.$state](t.button)}));var g=function(){var t=l.structure.getAllRoomList();return t.length?t.map((function(t){return t.area})).reduce((function(t,e){return t+e})):0},y=function(t){r.map.set(t,new Qo(t,r)),t.on("destroy",(function(){r.map.delete(t),setTimeout((function(){var t,e=Object(pn["a"])(l.structure.rooms());try{for(e.s();!(t=e.n()).done;){var n=t.value;r.map.get(n).updateLabelPosition(),r.map.get(n).updateLabelText()}}catch(o){e.e(o)}finally{e.f()}r.emit("area-change",g())}))}))},w=function(t){var e=new Zo(t,r);r.map.set(t,e),setTimeout((function(){var n="未命名",o=l.label.createLabelText();o.setRoom(t),e.setName(n),e.updateLabelPosition(),r.emit("area-change",g()),t.on("destroy",(function(){o.remove(),r.map.delete(t)})),c.$state===s.Bricklayer.Builder.PICKUP_TO&&1!==c.from.size&&c.drop()}))},x=function(t){r.map.has(t)||r.map.set(t,new ei(t,r)),t.on("destory",(function(){return r.map.delete(t)}))},k=function(t){t.on("change",(function(){t.room&&r.map.get(t.room).setLabelPosition(t.x,t.y)}))},O=function(t){t.on("pointerdown",(function(){t.flip()}))},T=function(t){r.state.dimensionShow||t.hide()};l.on("element-create",(function(t){t instanceof a.Wall&&y(t),t instanceof a.Room&&w(t),t instanceof a.Hollow&&x(t),t instanceof a.LabelText&&k(t),t instanceof a.Arrow&&O(t),t instanceof a.Dimension&&T(t)})),l.structure.on("change",(function(){var t,e=Object(pn["a"])(l.structure.rooms());try{for(e.s();!(t=e.n()).done;){var n=t.value;r.map.get(n).updateLabelPosition(),r.map.get(n).updateLabelText()}}catch(o){e.e(o)}finally{e.f()}r.emit("area-change",g())})),window.addEventListener("keydown",(function(t){if("Escape"===t.key){if(r.feature.tool.activated===r.feature.tool.symbol.WALL_BUILDER&&c.$state===s.Bricklayer.Builder.PICKUP_TO)return void c.drop();r.feature.tool.openDefault()}"Delete"===t.key&&l.common.remove()}));var S={originBackToCenter:function(){var t=l.width,e=l.height;l.setOrigin(t/2,e/2),l.setScale(25)},negativeBackToCenter:function(){var t=l.width,e=l.height,n=l.negative.getAllBitmapList();if(n[0]){var o=n[0],i=o.width,r=o.height;l.viewport.ViewAdjuster.backToCenter(-i/2,r/2,i/2,-r/2)}else l.setOrigin(t/2,e/2),l.setScale(25)}};return S},oi=n("493b"),ii=Object(cn["a"])((function t(e){Object(un["a"])(this,t),this.id=e})),ri=function(){function t(){Object(un["a"])(this,t),this.map=new WeakMap,this.resources={},this.classes={}}return Object(cn["a"])(t,[{key:"CustomResource",value:function(t){return this.classes[t]}},{key:"get",value:function(t){return this.resources[t]}},{key:"define",value:function(t,e){var n=e,o=this,i="".concat(t,"Resource"),r=Object(R["a"])({},i,function(t){Object(Oo["a"])(i,t);var e=Object(To["a"])(i);function i(t){var r;Object(un["a"])(this,i),r=e.call(this,t),o.resources[t]=Object(ko["a"])(r);for(var a=arguments.length,s=new Array(a>1?a-1:0),l=1;l<a;l++)s[l-1]=arguments[l];return r.data=n.Data.apply(n,s),r}return Object(cn["a"])(i,[{key:"apply",value:function(t,e){return n.apply(t,this.data,e,this.id),o.map.set(t,this),this}}],[{key:"create",value:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),o=1;o<e;o++)n[o-1]=arguments[o];return Object(oi["a"])(this,[t].concat(n))}}]),i}(ii))[i];return this.classes[t]=r,r}}]),t}(),ai=(n("cb29"),Math.PI),si=60,li=15,ci=10,ui={stateless:{line:0,arcLine:14145753,fill:16777215,windowFill:13421772},hover:{line:8053503,arcLine:15464441,fill:16777215,windowFill:13421772},select:{line:4096759,arcLine:15068665,fill:16777215,windowFill:13421772},virtual:{line:16711680,arcLine:16711680,fill:16777215,windowFill:16777215}},pi=function(t){var e=t.hover,n=t.focus,o=t.select,i=t.virtual;return o||n?ui.select:e?ui.hover:i?ui.virtual:ui.stateless},di={width:800,render:function(t,e){var n=e.width,o=e.height,i=e.fliped,r=e.scale,a=i?1:0,s=li/r,l=si/r,c=pi(e);return t.lineStyle(s,c.arcLine).beginFill(c.fill,.1).arc(n*a,o/2,n,-ai/2*a-ai/2,-ai*a/2).lineTo(n*a,o/2).lineTo(0,o/2-n+a*n).endFill().beginFill(c.fill).lineStyle(s,c.fill).drawRect(0,0,n,o).lineStyle(s,c.line).moveTo(0,0).lineTo(0,o).moveTo(n,0).lineTo(n,o).lineStyle(s,c.line).drawRect((n-l)*a,o/2,l,-n),t.pivot.x=n/2,t.pivot.y=o/2,t}},fi={width:800,render:function(t,e){var n=e.width,o=e.height,i=e.scale,r=li/i,a=si/i,s=pi(e);return t.lineStyle(r,s.arcLine).beginFill(s.fill,.1).arc(0,o/2,n/2,-ai/2,0).lineTo(0,o/2).lineTo(0,(o-n)/2).endFill().beginFill(s.fill,.1).lineStyle(r,s.arcLine).arc(n,o/2,n/2,ai,-ai/2).lineTo(n,o/2).lineTo(n/2,o/2).endFill().beginFill(s.fill).lineStyle(r,s.fill).drawRect(0,0,n,o).lineStyle(r,s.line).moveTo(0,0).lineTo(0,o).moveTo(n,0).lineTo(n,o).drawRect(0,o/2,a,-n/2).drawRect(n,o/2,-a,-n/2),t.pivot.x=n/2,t.pivot.y=o/2,t}},hi={width:800,render:function(t,e){var n=e.width,o=e.height,i=e.scale,r=e.fliped,a=r?-1:1,s=li/i,l=ci/i,c=pi(e);return t.lineStyle(s,c.line).beginFill(c.fill).drawRect(0,0,n,o).drawRect(0+s+l,o/2,2*n/3,o/4*a).drawRect(n-s-l,o/2,-2*n/3,-o/4*a),t.pivot.x=n/2,t.pivot.y=o/2,t}},mi={width:1450,render:function(t,e){var n=e.width,o=e.height,i=e.fliped,r=e.scale,a=i?1:0,s=li/r,l=pi(e);return t.lineStyle(s,l.line).beginFill(l.fill).drawRect(0,0,n,o).moveTo(0,o/3).lineTo(n,o/3).moveTo(0,2*o/3).lineTo(n,2*o/3).moveTo(n/4+a*n/2,o/3).lineTo(n/4+a*n/2,2*o/3).endFill(),t.pivot.x=n/2,t.pivot.y=o/2,t}},vi={width:2e3,render:function(t,e){var n=e.width,o=e.height,i=e.scale,r=li/i,a=pi(e);return t.lineStyle(r,a.fill).beginFill(a.fill).drawRect(0,0,n,o).endFill().lineStyle(r,a.line).drawRect(0,0,n,o/3).drawRect(0,2*o/3,n,o/3),t.pivot.x=n/2,t.pivot.y=o/2,t}},bi={width:800,render:function(t,e){var n=e.width,o=e.height,i=e.scale,r=li/i,a=pi(e);return t.lineStyle(r,a.line).beginFill(a.fill).drawRect(0,0,n,o).moveTo(0,o/2).lineTo(n,o/2).endFill(),t.pivot.x=n/2,t.pivot.y=o/2,t}},gi={width:1500,render:function(t,e){var n=e.width,o=e.scale,i=e.sillThickness,r=void 0===i?500/o:i,a=e.height,s=li/o,l=a,c=pi(e);return t.lineStyle(s,c.line).beginFill(c.windowFill).drawRect(0,-r,n,r).endFill().beginFill(c.fill).moveTo(0,-a).lineTo(0,-r).lineTo(n,-r).lineTo(n,-a).lineTo(n+l,-a).lineTo(n+l,-(r+l)).lineTo(-l,-(r+l)).lineTo(-l,-a).lineTo(0,-a).endFill().moveTo(-l/2,-a).lineTo(-l/2,-(r+l/2)).lineTo(n+l/2,-(r+l/2)).lineTo(n+l/2,-a),t.pivot.x=n/2,t.pivot.y=-a/2,t}},yi={width:1500,render:function(t,e){var n=e.width,o=e.height,i=e.scale,r=li/i,a=pi(e);return t.lineStyle(r,a.line).beginFill(a.fill).drawRect(0,0,n,o).endFill().moveTo(0,o/2).lineTo(n,o/2).moveTo(0,o/3).lineTo(n,o/3).moveTo(0,2*o/3).lineTo(n,2*o/3).moveTo(n/2,o/3).lineTo(n/2,2*o/3),t.pivot.x=n/2,t.pivot.y=o/2,t}},wi={render:function(t,e){var n=e.leftWidth,o=e.rightWidth,i=e.leftWallThickness,r=e.rightWallThickness,a=e.scale,s=li/a,l=pi(e);return t.lineStyle(s,l.line).beginFill(l.fill).moveTo(0,0).lineTo(o,0).lineTo(o,r).lineTo(i,r).lineTo(i,n).lineTo(0,n).lineTo(0,0).endFill().moveTo(i/2,n).lineTo(i/2,r/2).lineTo(o,r/2),t.pivot.x=o/2,t.pivot.y=r/2,t}},xi={render:function(t,e){var n=e.leftWidth,o=e.centerWidtn,i=e.rightWidth,r=e.leftWallThickness,a=e.centerWallThickness,s=e.rightWallThickness,l=e.scale,c=li/l,u=pi(e);return t.lineStyle(c,u.line).beginFill(u.fill).moveTo(0,0).lineTo(o,0).lineTo(o,i).lineTo(o-s,i).lineTo(o-s,a).lineTo(r,a).lineTo(r,n).lineTo(0,n).lineTo(0,0).endFill().moveTo(r/2,n).lineTo(r/2,a/2).lineTo(o-s/2,a/2).lineTo(o-s/2,i),t.pivot.x=o/2,t.pivot.y=a/2,t}},ki={render:function(t,e){var n=e.leftWidth,o=e.rightWidth,i=e.leftWindowThickness,r=e.rightWindowThickness,a=e.leftWallThickness,s=e.rightWallThickness,l=e.scale,c=li/l,u=pi(e);return t.lineStyle(c,u.line).beginFill(u.windowFill).moveTo(a,s).lineTo(o,s).lineTo(o,s-r).lineTo(a-i,s-r).lineTo(a-i,n).lineTo(a,n).lineTo(a,s).endFill().beginFill(u.fill).moveTo(a-i,s-r).lineTo(o,s-r).lineTo(o,0).lineTo(o+s,0).lineTo(o+s,-r).lineTo(-i,-r).lineTo(-i,n+a).lineTo(0,n+a).lineTo(0,n).lineTo(a-i,n).lineTo(a-i,s-r).endFill().moveTo(0,n+a/2).lineTo(a/2-i,n+a/2).lineTo(a/2-i,s/2-r).lineTo(o+s/2,s/2-r).lineTo(o+s/2,0),t.pivot.x=o/2,t.pivot.y=s/2,t}},Oi={render:function(t,e){var n=e.leftWidth,o=e.centerWidtn,i=e.rightWidth,r=e.leftWindowThinkness,a=e.centerWindowThinkness,s=e.rightWindowThinkness,l=e.leftWallThickness,c=e.centerWallThickness,u=e.rightWallThickness,p=e.scale,d=li/p,f=pi(e);return t.lineStyle(d,f.line).beginFill(f.windowFill).moveTo(l,c).lineTo(o-u,c).lineTo(o-u,i).lineTo(o-u+s,i).lineTo(o-u+s,c-a).lineTo(l-r,c-a).lineTo(l-r,n).lineTo(l,n).lineTo(l,c).endFill().beginFill(f.fill).moveTo(l-r,c-a).lineTo(o+s-u,c-a).lineTo(o+s-u,i).lineTo(o,i).lineTo(o,i+u).lineTo(o+s,i+u).lineTo(o+s,-a).lineTo(-r,-a).lineTo(-r,n+l).lineTo(0,n+l).lineTo(0,n).lineTo(l-r,n).lineTo(l-r,c-a).endFill().moveTo(0,n+l/2).lineTo(l/2-r,n+l/2).lineTo(l/2-r,c/2-a).lineTo(o+s-u/2,c/2-a).lineTo(o+s-u/2,i+u/2).lineTo(o,i+u/2),t.pivot.x=o/2,t.pivot.y=c/2,t}},Ti=[100,101,102],Si=[103,104],ji=function(){var t=new ri,e=d,n=f,o=t.define("Wall",{Data:function(t){return t},apply:function(t,e){t.color=e}}),i=t.define("Hollow",{Data:function(t){return t},apply:function(t,e){t.setMaterial(e)}});return o.create(1,null),o.create(2,3355443),o.create(3,16777215),i.create(100,e.SingleDoor),i.create(101,e.DoubleDoor),i.create(102,e.SlidingDoor),i.create(103,n.BasicWindow),i.create(104,n.BoilerWindow),i.create(105,e.Bealock),t},_i=null,Ci=function(t){var e=t.editor;_i=setInterval((function(){e.feature.floor.updateFloorData()}),5e3),window.addEventListener("error",(function(){clearInterval(_i),e.feature.document.save(!1)}))},Li=function(t){var e={begin:function(t,e){var n=e.negative.getAllBitmapList();n[0]&&(t.bitmap={position:[n[0].x,n[0].y],rotation:n[0].rotation})},walls:function(t){t.wallList=[]},wall:function(e,n){e.wallList.push({resource:t.map.get(n).resource})},rooms:function(t){t.roomList=[]},room:function(e,n){var o=t.map.get(n);e.roomList.push({type:o.type,name:o.name,labelPosition:Object(me["a"])(o.labelPosition)})},hollows:function(t){t.hollowList=[]},hollow:function(e,n,o){var i=o.entrance.getAllArrowList().find((function(t){return t.hollow===n}));e.hollowList.push({resource:t.map.get(n).resource,entrance:i?{fliped:i.fliped}:null})}},n={end:function(t,e){if(t.bitmap){var n=t.bitmap,o=n.position,i=n.rotation,r=e.negative.createBitmap("negative".concat(t.level));r.setPosition.apply(r,Object(me["a"])(o)),r.setRotation(i)}},wall:function(e,n,o){var i=e.wallList[o],r=t.map.get(n);r.setResource(i.resource)},room:function(e,n,o){var i=e.roomList[o],r=i.name,a=i.type,s=i.labelPosition,l=t.map.get(n);r&&l.setName(r),a&&l.setType(a),s&&l.setLabelPosition.apply(l,Object(me["a"])(s))},hollow:function(e,n,o){var i=e.hollowList[o],r=i.resource,a=i.entrance,s=t.map.get(n);s.setResource(r),a&&s.setEntrance(a.fliped)}};return{serializer:e,deserializer:n}},$i=10,Di=function(t,e){return new Promise((function(n){var o=e.drawing,i=e.hollowList,r=e.wallList,a=e.roomList,s=i?i.map((function(t){return{resource:t.resource}})):[];t.deserialize({drawing:o,hollowList:s,wallList:r,roomList:a}),setTimeout((function(){var e,o=t.solution.drawing,i=Object(pn["a"])(o.measure.dimensions());try{for(i.s();!(e=i.n()).done;){var r=e.value;r.hide()}}catch(D){i.e(D)}finally{i.f()}var a=o.getElementContainerBounds("Wall"),s=o.getElementContainerBounds("Hollow"),l=0!==a.width&&0!==a.height,c=0!==s.width&&0!==s.height;if(l||c){var u=o.scale,p=t.screenshot(),d=o.toGeometry(a.x,a.y),f=Object(nn["a"])(d,2),h=f[0],m=f[1],v=o.toGeometry(s.x,s.y),b=Object(nn["a"])(v,2),g=b[0],y=b[1],w=a.width*u,x=a.height*u,k=s.width*u,O=s.height*u,T=o.structure.getAllRoomList(),S=o.windoor.getAllHollowList(),j=[];if(T.forEach((function(e){var n=e.getOuterSurfaceList(),o=n.map((function(t){return t.origin})),i=[];n.forEach((function(e){var n=e.back,o=S.find((function(o){var i=t.map.get(o);return[e,n].includes(i.surface)&&Ti.includes(i.resource)}));null!==e.back.room&&o&&i.push(T.indexOf(n.room))})),j.push({area:e.area,originList:o,connectedRooms:i})})),l)if(c){var _=Math.min(h,g),C=Math.max(m,y),L=Math.max(h+w,g+k)-_,$=C-Math.min(m-x,y-O);n({base64:p,width:L,height:$,x:_,y:C,compute:{rooms:j}})}else n({base64:p,x:h,y:m,width:w,height:x,compute:{rooms:j}});else n({base64:p,x:g,y:y,width:k,height:O,compute:{rooms:j}})}else n(null)}))}))},Ri=function(t,e){return new Promise((function(n){var o=[];setTimeout(Object(T["a"])(Object(O["a"])().mark((function i(){var r,a,s,l;return Object(O["a"])().wrap((function(i){while(1)switch(i.prev=i.next){case 0:r=Object(pn["a"])(e.list),i.prev=1,r.s();case 3:if((a=r.n()).done){i.next=11;break}return s=a.value,i.next=7,Di(t,s);case 7:l=i.sent,o.push(l);case 9:i.next=3;break;case 11:i.next=16;break;case 13:i.prev=13,i.t0=i["catch"](1),r.e(i.t0);case 16:return i.prev=16,r.f(),i.finish(16);case 19:n(o);case 20:case"end":return i.stop()}}),i,null,[[1,13,16,19]])}))))}))},Wi=function(t){var e=t.Solution,n=t.editor,o={Wall:e.Element.Wall,Room:e.Element.Room,Hollow:e.Element.Hollow},i=function(t){Object(Oo["a"])(i,t);var n=Object(To["a"])(i);function i(){var t;Object(un["a"])(this,i),t=n.call(this),t.map=new WeakMap,t.solution=new e(Li(Object(ko["a"])(t)));var r=t.solution.drawing;return t.feature={resource:ji()},r.on("element-create",(function(e){e instanceof o.Wall&&t.map.set(e,new Qo(e,Object(ko["a"])(t))),e instanceof o.Room&&t.map.set(e,new Zo(e,Object(ko["a"])(t))),e instanceof o.Hollow&&t.map.set(e,new ei(e,Object(ko["a"])(t))),e.on("destory",(function(){return t.map.delete(e)}))})),r.mount(document.createElement("div")),r.compass.element.hide(),r.setScale($i),t}return Object(cn["a"])(i,[{key:"deserialize",value:function(t){var e=this.solution.drawing,n=e.structure.getAllCornerList(),o=e.windoor.getAllHollowList(),i=e.negative.getAllBitmapList();o.forEach((function(t){return t.remove()})),n.forEach((function(t){return t.remove()})),i.forEach((function(t){return t.remove()})),this.solution.deserializer.execute(t.drawing,t)}},{key:"screenshot",value:function(){return this.solution.drawing.screenshot()}}]),i}(jo);return{screenshot:function(){return Object(T["a"])(Object(O["a"])().mark((function t(){var e,o;return Object(O["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n.feature.floor.updateFloorData(),e=new i,o=n.feature.floor.getData(),t.next=5,Ri(e,o);case 5:return t.abrupt("return",t.sent);case 6:case"end":return t.stop()}}),t)})))()}}},Ei=function(t){var e=t.Solution,n=t.accessor,o={Corner:e.Element.Corner,Wall:e.Element.Wall,Room:e.Element.Room,Hollow:e.Element.Hollow,LabelText:e.Element.LabelText,Bitmap:e.Element.Bitmap,Arrow:e.Element.Arrow,Dimension:e.Element.Dimension},i={Ready:e.Tool.Ready,Common:e.Tool.Common,Hammer:e.Tool.Hammer,Bricklayer:e.Tool.Bricklayer},r=function(t){return Object.freeze({editor:t,Element:o,Tool:i,accessor:n,Solution:e})},a=function(t){Object(Oo["a"])(i,t);var n=Object(To["a"])(i);function i(){var t;Object(un["a"])(this,i),t=n.call(this),t.map=new WeakMap,t.data={},t.state={roomNameShow:!0,roomAreaShow:!0,dimensionShow:!0,snap:!0};var a=r(Object(ko["a"])(t)),s=new e(Li(Object(ko["a"])(t))),d=s.drawing;return t.solution=s,t.feature={document:l.install(a),floor:c.install(a),tool:u.install(a),drawing:p.install(a),resource:h.install(a),screenshoter:v.install(a)},m.install(a),t.feature.document.open(),d.common.on("selector-add",(function(e){var n=e.map((function(e){return t.map.get(e)||null}));t.emit("select",n)})),d.common.on("selector-clear",(function(){t.emit("unselect")})),d.on("element-create",(function(e){e instanceof o.Wall?t.emit("wall-create",e):e instanceof o.Room?t.emit("room-create",e):e instanceof o.Hollow?t.emit("hollow-create",e):e instanceof o.Bitmap&&t.emit("bitmap-create",e)})),d.on("element-destroy",(function(e){e instanceof o.Wall?t.emit("wall-destroy",e):e instanceof o.Room?t.emit("room-destroy",e):e instanceof o.Hollow&&t.emit("hollow-destroy",e)})),s.tool.on("open",(function(e){t.emit("tool-open",e)})),d.compass.element.on("change",(function(e){t.emit("compass-change",e)})),Object.freeze(Object(ko["a"])(t)),t}return Object(cn["a"])(i,[{key:"Element",get:function(){return o}},{key:"getSelected",value:function(){var t=this;return this.solution.drawing.common.getSelectedList().map((function(e){return t.map.get(e)||null}))}},{key:"getState",value:function(){return this.state}},{key:"serialize",value:function(){var t=this.feature.floor,e=t.currentFloor,n=this.solution.serializer.execute(e);return e.drawing=n,t.getData().list.forEach((function(t){t.drawing.compass?t.drawing.compass.rotation=n.compass.rotation:t.drawing.compass={rotation:n.compass.rotation}})),e}},{key:"deserialize",value:function(t){this.solution.deserializer.execute(t.drawing,t)}},{key:"updateAllRoomLabel",value:function(){var t,e=Object(pn["a"])(this.solution.drawing.structure.rooms());try{for(e.s();!(t=e.n()).done;){var n=t.value;this.map.get(n).updateLabelText()}}catch(o){e.e(o)}finally{e.f()}}},{key:"setRoomNameShow",value:function(t){this.state.roomNameShow=t,this.updateAllRoomLabel()}},{key:"setRoomAreaShow",value:function(t){this.state.roomAreaShow=t,this.updateAllRoomLabel()}},{key:"setDimensionShow",value:function(t){this.state.dimensionShow=t;var e,n=Object(pn["a"])(this.solution.drawing.measure.dimensions());try{for(n.s();!(e=n.n()).done;){var o=e.value;t?o.show():o.hide()}}catch(i){n.e(i)}finally{n.f()}}},{key:"setSnap",value:function(t){var e=this.solution.drawing;e.grid.options.rectangular.snap.enabled=t,e.structure.options.snap.corner.active=t,this.state.snap=t}},{key:"negativeRotate",value:function(t){var e=this.solution.drawing.negative.getAllBitmapList(),n=this.feature.floor.getData();e[0].setRotation(t);var o,i=Object(pn["a"])(n.list);try{for(i.s();!(o=i.n()).done;){var r=o.value;r.bitmap.rotation=t}}catch(a){i.e(a)}finally{i.f()}}},{key:"delete",value:function(){this.solution.drawing.common.remove()}}]),i}(jo);return a},Ni=function(t){return!!t&&("string"===typeof t.name&&(!!Number.isInteger(t.base)&&!!Array.isArray(t.list)))},Pi=function(t){return!(!t||!t.floor)&&("string"===typeof t.name&&(!!Number.isInteger(t.floor.base)&&!!Array.isArray(t.floor.list)))},Ai=function(t){return{name:t.name,floor:{base:0,list:t.list.map((function(t){return{name:"",level:t.level,bitmap:{position:[0,0],rotation:0},drawing:{compass:{rotation:0},cornerList:[],wallList:[],roomList:[],hollowList:[],stuffList:[],labelTextList:[],labelLineList:[]}}}))}}},Fi={install:function(t,e){var n=Ei(e);t.prototype.$editor=new n}},Mi="",Bi=location.origin,Ii=location.origin,zi="c07782ca_on4j_b6f9_cs_1",Vi="2022-08-16-13-48-02",Ui="17STfo8rNMM",Gi="eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjoxLCJ1c2VybmFtZSI6ImFkbWluX2FjY291bnQiLCJleHAiOjE2NjE5NDc2MTUsImVtYWlsIjoiNTUzOTA0NjVAcXEuY29tIiwib3JpZ19pYXQiOjE2NjA3MzgwMTUsImlkZW50aXR5X2NvZGUiOiIiLCJjb21wYW55X2lkIjoxfQ.v6HAlTn7X4I81Jo_avY_2flbzT_JtGnVL7WhWjhLnJU",Hi=function(){var t=Object(T["a"])(Object(O["a"])().mark((function t(e){var n;return Object(O["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.json();case 2:if(n=t.sent,1!==n.code){t.next=7;break}return t.abrupt("return",n.data);case 7:return t.abrupt("return",null);case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),Ji=function(){function t(){Object(un["a"])(this,t)}return Object(cn["a"])(t,[{key:"getTicket",value:function(){return fetch(Bi+"/ticket/").then((function(){return""}))}},{key:"getModel",value:function(){return fetch("".concat(Bi,"/model_data/"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:Gi},body:JSON.stringify({model_id:zi,model_version:Vi,scene_id:Ui})}).then((function(t){return Hi(t)})).then((function(t){return Mi=t.id,t}))}},{key:"getDrawing",value:function(){return fetch("".concat(Bi,"/manager/?model=").concat(zi,"&model_version=").concat(Vi,"&work=").concat(Ui),{method:"GET",headers:{Authorization:Gi}}).then((function(t){return Hi(t)})).then((function(t){return Mi=t.id,JSON.parse(t.drawing)}))}},{key:"saveDrawing",value:function(t){return t.append("model",zi),t.append("model_version",Vi),t.append("work",Ui),fetch("".concat(Bi,"/manager/"),{method:"POST",headers:{Authorization:Gi},body:t}).then((function(t){return Hi(t)}))}},{key:"getStatus",value:function(){return fetch("".concat(Ii,"/status_manager?type=houseplan&object_id=").concat(Mi))}},{key:"updateStatus",value:function(){return fetch("".concat(Ii,"/status_manager"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({type:"houseplan",session:Gi,object_id:Mi})}).then((function(t){return 200!==t.status?null:Hi(t)}))}},{key:"deleteStatus",value:function(){return fetch("".concat(Ii,"/status_manager"),{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({type:"houseplan",object_id:Mi}),keepalive:!0})}}]),t}(),Yi=new Ji,Ki={install:function(t,e){Bi=e.baseURL,Ii=e.statusBaseURL,t.prototype.$e100=Yi}},Xi={selector:"selector",transformer:"transformer",save:"save",clear:"clear",lock:"lock",unlock:"unlock"},qi=(Io={},Object(R["a"])(Io,Xi.selector,{label:"选择",image:{base:"img/Pointer.svg",active:"img/Pointer_Active.svg"}}),Object(R["a"])(Io,Xi.transformer,{label:"移动",image:{base:"img/Move.svg",active:"img/Move_Active.svg"}}),Object(R["a"])(Io,Xi.save,{label:"保存",image:{base:"img/Save.svg"}}),Object(R["a"])(Io,Xi.clear,{label:"清空",image:{base:"img/Clear.svg"}}),Object(R["a"])(Io,Xi.lock,{label:"锁定",image:{base:"img/Lock.svg"}}),Object(R["a"])(Io,Xi.unlock,{label:"解锁",image:{base:"img/Lock.svg"}}),Io),Qi={singleDoor:"singleDoor",doubleDoor:"doubleDoor",slidingDoor:"slidingDoor",basicWindow:"basicWindow",boilerWindow:"boilerWindow",bealock:"bealock"},Zi={door:"door",window:"window",bealock:"bealock"},tr={entrance:"entrance",flipWall:"flipWall",flip:"flip",delete:"delete"},er=(zo={},Object(R["a"])(zo,Qi.singleDoor,{label:"单开门",resource:100}),Object(R["a"])(zo,Qi.doubleDoor,{label:"双开门",resource:101}),Object(R["a"])(zo,Qi.slidingDoor,{label:"推拉门",resource:102}),Object(R["a"])(zo,Qi.basicWindow,{label:"普通窗",resource:103}),Object(R["a"])(zo,Qi.boilerWindow,{label:"一字飘窗",resource:104}),Object(R["a"])(zo,Qi.bealock,{label:"垭口",resource:105}),zo),nr=(Vo={},Object(R["a"])(Vo,Zi.door,{label:"门",list:[Qi.singleDoor,Qi.doubleDoor,Qi.slidingDoor]}),Object(R["a"])(Vo,Zi.window,{label:"窗",list:[Qi.basicWindow,Qi.boilerWindow]}),Object(R["a"])(Vo,Zi.bealock,{label:"垭口",list:[Qi.bealock]}),Vo),or=(Uo={},Object(R["a"])(Uo,tr.entrance,{label:"入户门",image:{base:"img/Entrance.svg"}}),Object(R["a"])(Uo,tr.flipWall,{label:"墙侧翻转",image:{base:"img/FlipWall.svg"}}),Object(R["a"])(Uo,tr.flip,{label:"翻转",image:{base:"img/Flip.svg"}}),Object(R["a"])(Uo,tr.delete,{label:"删除",image:{base:"img/Delete.svg"}}),Uo),ir={common:"common",bearing:"bearing",short:"short"},rr={split:"split",delete:"delete"},ar=(Go={},Object(R["a"])(Go,ir.common,{label:"普通墙",resource:1}),Object(R["a"])(Go,ir.bearing,{label:"承重墙",resource:2}),Object(R["a"])(Go,ir.short,{label:"矮墙",resource:3}),Go),sr=(Ho={},Object(R["a"])(Ho,rr.split,{label:"截断",image:{base:"img/Split.svg"}}),Object(R["a"])(Ho,rr.delete,{label:"删除",image:{base:"img/Delete.svg"}}),Ho),lr=["客厅","餐厅","客餐厅","厨房","主卧","次卧","卧室","老人房","儿童房","过道","阳台","卫生间","玄关","地下室"],cr={install:function(t){t.prototype.$spec={menu:g,hollow:y,wall:w,room:x}}},ur=(n("2b3d"),n("9861"),n("c6c5")),pr=function(){var t=Object(T["a"])(Object(O["a"])().mark((function t(){var e,n,o,i,r,a=arguments;return Object(O["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e=a.length>0&&void 0!==a[0]?a[0]:function(){},t.next=3,Yi.getTicket();case 3:n=t.sent,o=new URL(location.href),i=o.searchParams.get("host")||"127.0.0.1",r=o.searchParams.get("port")||"3001",ur["a"]({origin:"http://".concat(i,":").concat(r),ticket:n},(function(t,n){window.PIXI=n.PIXI,e(t)}));case 8:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),dr=n("8f9c");pr((function(t){var e="https://future.3dnest.cn/api/v1/e100/business/house_plan",n="http://39.106.137.121/api/v1/status_record";S["default"].use(j["a"],dr),S["default"].use(_["a"]),S["default"].use(Ki,{baseURL:e,statusBaseURL:n}),S["default"].use(cr),S["default"].use(Fi,{Solution:t,accessor:{save:function(t){return Object(T["a"])(Object(O["a"])().mark((function e(){return Object(O["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:console.log(t);case 1:case"end":return e.stop()}}),e)})))()},open:function(){return Object(T["a"])(Object(O["a"])().mark((function e(){var n,o,i,r,a,s;return Object(O["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=[{name:"测试1",info:{center_point_coordinates:{u:.4268035292625427,v:.4820511341094971},direction:0,floor_height:6.162445068359375,flooridx:0,height:1477,planformUrl:"https://bucket-model.oss-cn-beijing.aliyuncs.com/c07782ca_on4j_b6f9_cs_1/2022-08-16-13-48-02/map_fit_00.png",ratio:.1,width:1147},locations:[]},{name:"测试2",info:{center_point_coordinates:{u:.5011234283447266,v:.5610423684120178},direction:0,floor_height:3.563536167144775,flooridx:1,height:1477,planformUrl:"https://bucket-model.oss-cn-beijing.aliyuncs.com/c07782ca_on4j_b6f9_cs_1/2022-08-16-13-48-02/map_fit_01.png",ratio:.1,width:1147},locations:[]}],o={name:n[0].name,base:0,list:n.map((function(t){return{level:t.info.flooridx,bitmap:t.info.planformUrl,scale:t.info.ratio}}))},b.isHouse(o)){e.next=4;break}throw new TypeError("Invalid house, a house object expected.");case 4:return e.next=6,t.Registry.negativeListRegister(o.list.map((function(t){return{id:"negative".concat(t.level),url:t.bitmap,scale:t.scale}})));case 6:if(i=b.fromHouse(o),null!==i&&0!==Object.keys(i).length){e.next=17;break}return r=b.fromHouse(o),a=new FormData,a.append("drawing",JSON.stringify(r)),a.append("map",JSON.stringify([])),e.next=14,Yi.saveDrawing(a);case 14:return e.next=16,Yi.getDrawing();case 16:i=e.sent;case 17:if(b.isDrawing(i)){e.next=19;break}throw new TypeError("Invalid drawing, a drawing object expected.");case 19:return i.name=n[0].name,s=!0,e.abrupt("return",{status:s,drawing:i,model:n.map((function(t){return{info:t.info,locations:t.locations}}))});case 22:case"end":return e.stop()}}),e)})))()}}});var o=new S["default"]({render:function(t){return t(xo)}});window.addEventListener("keydown",(function(t){t.altKey&&t.preventDefault()})),window.addEventListener("resize",(function(){o.$emit("drawing-resize")})),o.$mount("#app")}))},"687c":function(t,e,n){"use strict";n("2b1a")},"698f":function(t,e,n){"use strict";n("389a")},"6db6":function(t,e,n){"use strict";n("aeae")},"783f":function(t,e,n){"use strict";n("ddc3")},"78a9":function(t,e,n){"use strict";n("026c")},"7b33":function(t,e,n){"use strict";n("b2ed")},8899:function(t,e,n){},"88d6":function(t,e,n){},"8f9c":function(t){t.exports=JSON.parse('{"breakpoints":["xs","sm","md","lg","xl","xxl"],"formControls":{"size":"sm"},"BLink":{"activeClass":"active"},"BButton":{"variant":"primary","size":"sm"},"BToast":{"toaster":"b-toaster-top-center","autoHideDelay":3000,"variant":"primary","toastClass":null,"headerClass":null,"bodyClass":null},"BModal":{"cancelVariant":"secondary","okVariant":"primary"},"BFormGroup":{"labelSize":"sm"},"BInputGroup":{"size":"sm"},"BNavItem":{"linkClasses":["p-0","px-1"]}}')},9018:function(t,e,n){},9224:function(t){t.exports=JSON.parse('{"a":"0.0.0"}')},9342:function(t,e,n){"use strict";n("f083")},"95f6":function(t,e,n){"use strict";n("cdee")},aeae:function(t,e,n){},b2ed:function(t,e,n){},bb78:function(t,e,n){"use strict";n("5051")},cdee:function(t,e,n){},ddc3:function(t,e,n){},f083:function(t,e,n){},f709:function(t,e,n){"use strict";n("fabd")},fabd:function(t,e,n){}});